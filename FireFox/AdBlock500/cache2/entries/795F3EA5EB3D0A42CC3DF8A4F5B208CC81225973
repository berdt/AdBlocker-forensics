/*!
 * jQuery JavaScript Library v1.11.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2015-04-28T16:19Z
 */

/*!
 * Sizzle CSS Selector Engine v2.2.0-pre
 * http://sizzlejs.com/
 *
 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-12-16
 */

/*!
 * jQuery Migrate - v1.2.1 - 2013-05-08
 * https://github.com/jquery/jquery-migrate
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors; Licensed MIT
 */

// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

/**
 *
 * This code was ported from the dash.js project at:
 *   https://github.com/Dash-Industry-Forum/dash.js/blob/development/externals/cea608-parser.js
 *   https://github.com/Dash-Industry-Forum/dash.js/commit/8269b26a761e0853bb21d78780ed945144ecdd4d#diff-71bc295a2d6b6b7093a1d3290d53a4b2
 *
 * The original copyright appears below:
 *
 * The copyright in this software is being made available under the BSD License,
 * included below. This software may be subject to other third party and contributor
 * rights, including patent rights, and no such rights are granted under this license.
 *
 * Copyright (c) 2015-2016, DASH Industry Forum.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *  1. Redistributions of source code must retain the above copyright notice, this
 *  list of conditions and the following disclaimer.
 *  * Redistributions in binary form must reproduce the above copyright notice,
 *  this list of conditions and the following disclaimer in the documentation and/or
 *  other materials provided with the distribution.
 *  2. Neither the name of Dash Industry Forum nor the names of its
 *  contributors may be used to endorse or promote products derived from this software
 *  without specific prior written permission.
 *
 *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY
 *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 *  POSSIBILITY OF SUCH DAMAGE.
 */

// copyright sign

/*!
 * jQuery Cookie Plugin v1.2
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */

/*! jQuery UI - v1.9.2 - 2012-12-11
* http://jqueryui.com
* Includes: jquery.ui.widget.js
* Copyright (c) 2012 jQuery Foundation and other contributors Licensed MIT */

/*! iFrame Resizer (iframeSizer.min.js ) - v2.5.1 - 2014-06-06
 *  Desc: Force cross domain iframes to size to content.
 *  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
 *  Copyright: (c) 2014 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

/*
Copyright 2013 Michael Countis

MIT License: http://opensource.org/licenses/MIT

 This library taps into XFP's logger function to trigger events,
 and creates googletag.on() and googletag.off() functions for subcribing
 and unsubscribing to these events.

 There is a risk that XFP changes its logging signature and breaks this code,
 so know the risk and don't use it for anything mission critical

*/

/*! nanoScrollerJS - v0.7.2
* http://jamesflorentino.github.com/nanoScrollerJS/
* Copyright (c) 2013 James Florentino; Licensed MIT */

/*	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/

if(function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e){var t="length"in e&&e.length,i=re.type(e);return"function"!==i&&!re.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e))}function n(e,t,i){if(re.isFunction(t))return re.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return re.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(fe.test(t))return re.filter(t,e,i);t=re.filter(t,e)}return re.grep(e,function(e){return re.inArray(e,t)>=0!==i})}function r(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function o(e){var t=we[e]={};return re.each(e.match(be)||[],function(e,i){t[i]=!0}),t}function a(){pe.addEventListener?(pe.removeEventListener("DOMContentLoaded",s,!1),e.removeEventListener("load",s,!1)):(pe.detachEvent("onreadystatechange",s),e.detachEvent("onload",s))}function s(){(pe.addEventListener||"load"===event.type||"complete"===pe.readyState)&&(a(),re.ready())}function l(e,t,i){if(void 0===i&&1===e.nodeType){var n="data-"+t.replace(Te,"-$1").toLowerCase();if(i=e.getAttribute(n),"string"==typeof i){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:Se.test(i)?re.parseJSON(i):i)}catch(e){}re.data(e,t,i)}else i=void 0}return i}function d(e){var t;for(t in e)if(("data"!==t||!re.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function u(e,t,i,n){if(re.acceptData(e)){var r,o,a=re.expando,s=e.nodeType,l=s?re.cache:e,d=s?e[a]:e[a]&&a;if(d&&l[d]&&(n||l[d].data)||void 0!==i||"string"!=typeof t)return d||(d=s?e[a]=K.pop()||re.guid++:a),l[d]||(l[d]=s?{}:{toJSON:re.noop}),"object"!=typeof t&&"function"!=typeof t||(n?l[d]=re.extend(l[d],t):l[d].data=re.extend(l[d].data,t)),o=l[d],n||(o.data||(o.data={}),o=o.data),void 0!==i&&(o[re.camelCase(t)]=i),"string"==typeof t?(r=o[t],null==r&&(r=o[re.camelCase(t)])):r=o,r}}function c(e,t,i){if(re.acceptData(e)){var n,r,o=e.nodeType,a=o?re.cache:e,s=o?e[re.expando]:re.expando;if(a[s]){if(t&&(n=i?a[s]:a[s].data)){re.isArray(t)?t=t.concat(re.map(t,re.camelCase)):t in n?t=[t]:(t=re.camelCase(t),t=t in n?[t]:t.split(" ")),r=t.length;for(;r--;)delete n[t[r]];if(i?!d(n):!re.isEmptyObject(n))return}(i||(delete a[s].data,d(a[s])))&&(o?re.cleanData([e],!0):ie.deleteExpando||a!=a.window?delete a[s]:a[s]=null)}}}function f(){return!0}function h(){return!1}function p(){try{return pe.activeElement}catch(e){}}function g(e){var t=Me.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function v(e,t){var i,n,r=0,o=typeof e.getElementsByTagName!==ke?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==ke?e.querySelectorAll(t||"*"):void 0;if(!o)for(o=[],i=e.childNodes||e;null!=(n=i[r]);r++)!t||re.nodeName(n,t)?o.push(n):re.merge(o,v(n,t));return void 0===t||t&&re.nodeName(e,t)?re.merge([e],o):o}function m(e){Le.test(e.type)&&(e.defaultChecked=e.checked)}function y(e,t){return re.nodeName(e,"table")&&re.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function b(e){return e.type=(null!==re.find.attr(e,"type"))+"/"+e.type,e}function w(e){var t=ze.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function E(e,t){for(var i,n=0;null!=(i=e[n]);n++)re._data(i,"globalEval",!t||re._data(t[n],"globalEval"))}function _(e,t){if(1===t.nodeType&&re.hasData(e)){var i,n,r,o=re._data(e),a=re._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(i in s)for(n=0,r=s[i].length;n<r;n++)re.event.add(t,i,s[i][n])}a.data&&(a.data=re.extend({},a.data))}}function k(e,t){var i,n,r;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!ie.noCloneEvent&&t[re.expando]){r=re._data(t);for(n in r.events)re.removeEvent(t,n,r.handle);t.removeAttribute(re.expando)}"script"===i&&t.text!==e.text?(b(t).text=e.text,w(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),ie.html5Clone&&e.innerHTML&&!re.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&Le.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}}function S(t,i){var n,r=re(i.createElement(t)).appendTo(i.body),o=e.getDefaultComputedStyle&&(n=e.getDefaultComputedStyle(r[0]))?n.display:re.css(r[0],"display");return r.detach(),o}function T(e){var t=pe,i=Ze[e];return i||(i=S(e,t),"none"!==i&&i||(Qe=(Qe||re("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(Qe[0].contentWindow||Qe[0].contentDocument).document,t.write(),t.close(),i=S(e,t),Qe.detach()),Ze[e]=i),i}function R(e,t){return{get:function(){var i=e();if(null!=i)return i?void delete this.get:(this.get=t).apply(this,arguments)}}}function A(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,r=ft.length;r--;)if(t=ft[r]+i,t in e)return t;return n}function C(e,t){for(var i,n,r,o=[],a=0,s=e.length;a<s;a++)n=e[a],n.style&&(o[a]=re._data(n,"olddisplay"),i=n.style.display,t?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&Ce(n)&&(o[a]=re._data(n,"olddisplay",T(n.nodeName)))):(r=Ce(n),(i&&"none"!==i||!r)&&re._data(n,"olddisplay",r?i:re.css(n,"display"))));for(a=0;a<s;a++)n=e[a],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[a]||"":"none"));return e}function x(e,t,i){var n=lt.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function L(e,t,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===i&&(a+=re.css(e,i+Ae[o],!0,r)),n?("content"===i&&(a-=re.css(e,"padding"+Ae[o],!0,r)),"margin"!==i&&(a-=re.css(e,"border"+Ae[o]+"Width",!0,r))):(a+=re.css(e,"padding"+Ae[o],!0,r),"padding"!==i&&(a+=re.css(e,"border"+Ae[o]+"Width",!0,r)));return a}function D(e,t,i){var n=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=et(e),a=ie.boxSizing&&"border-box"===re.css(e,"boxSizing",!1,o);if(r<=0||null==r){if(r=tt(e,t,o),(r<0||null==r)&&(r=e.style[t]),nt.test(r))return r;n=a&&(ie.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+L(e,t,i||(a?"border":"content"),n,o)+"px"}function P(e,t,i,n,r){return new P.prototype.init(e,t,i,n,r)}function I(){return setTimeout(function(){ht=void 0}),ht=re.now()}function O(e,t){var i,n={height:e},r=0;for(t=t?1:0;r<4;r+=2-t)i=Ae[r],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function N(e,t,i){for(var n,r=(bt[t]||[]).concat(bt["*"]),o=0,a=r.length;o<a;o++)if(n=r[o].call(i,t,e))return n}function M(e,t,i){var n,r,o,a,s,l,d,u,c=this,f={},h=e.style,p=e.nodeType&&Ce(e),g=re._data(e,"fxshow");i.queue||(s=re._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,c.always(function(){c.always(function(){s.unqueued--,re.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[h.overflow,h.overflowX,h.overflowY],d=re.css(e,"display"),u="none"===d?re._data(e,"olddisplay")||T(e.nodeName):d,"inline"===u&&"none"===re.css(e,"float")&&(ie.inlineBlockNeedsLayout&&"inline"!==T(e.nodeName)?h.zoom=1:h.display="inline-block")),i.overflow&&(h.overflow="hidden",ie.shrinkWrapBlocks()||c.always(function(){h.overflow=i.overflow[0],h.overflowX=i.overflow[1],h.overflowY=i.overflow[2]}));for(n in t)if(r=t[n],gt.exec(r)){if(delete t[n],o=o||"toggle"===r,r===(p?"hide":"show")){if("show"!==r||!g||void 0===g[n])continue;p=!0}f[n]=g&&g[n]||re.style(e,n)}else d=void 0;if(re.isEmptyObject(f))"inline"===("none"===d?T(e.nodeName):d)&&(h.display=d);else{g?"hidden"in g&&(p=g.hidden):g=re._data(e,"fxshow",{}),o&&(g.hidden=!p),p?re(e).show():c.done(function(){re(e).hide()}),c.done(function(){var t;re._removeData(e,"fxshow");for(t in f)re.style(e,t,f[t])});for(n in f)a=N(p?g[n]:0,n,c),n in g||(g[n]=a.start,p&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}function F(e,t){var i,n,r,o,a;for(i in e)if(n=re.camelCase(i),r=t[n],o=e[i],re.isArray(o)&&(r=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),a=re.cssHooks[n],a&&"expand"in a){o=a.expand(o),delete e[n];for(i in o)i in e||(e[i]=o[i],t[i]=r)}else t[n]=r}function U(e,t,i){var n,r,o=0,a=yt.length,s=re.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=ht||I(),i=Math.max(0,d.startTime+d.duration-t),n=i/d.duration||0,o=1-n,a=0,l=d.tweens.length;a<l;a++)d.tweens[a].run(o);return s.notifyWith(e,[d,o,i]),o<1&&l?i:(s.resolveWith(e,[d]),!1)},d=s.promise({elem:e,props:re.extend({},t),opts:re.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:ht||I(),duration:i.duration,tweens:[],createTween:function(t,i){var n=re.Tween(e,d.opts,t,i,d.opts.specialEasing[t]||d.opts.easing);return d.tweens.push(n),n},stop:function(t){var i=0,n=t?d.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)d.tweens[i].run(1);return t?s.resolveWith(e,[d,t]):s.rejectWith(e,[d,t]),this}}),u=d.props;for(F(u,d.opts.specialEasing);o<a;o++)if(n=yt[o].call(d,e,u,d.opts))return n;return re.map(u,N,d),re.isFunction(d.opts.start)&&d.opts.start.call(e,d),re.fx.timer(re.extend(l,{elem:e,anim:d,queue:d.opts.queue})),d.progress(d.opts.progress).done(d.opts.done,d.opts.complete).fail(d.opts.fail).always(d.opts.always)}function B(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,r=0,o=t.toLowerCase().match(be)||[];if(re.isFunction(i))for(;n=o[r++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function j(e,t,i,n){function r(s){var l;return o[s]=!0,re.each(e[s]||[],function(e,s){var d=s(t,i,n);return"string"!=typeof d||a||o[d]?a?!(l=d):void 0:(t.dataTypes.unshift(d),r(d),!1)}),l}var o={},a=e===qt;return r(t.dataTypes[0])||!o["*"]&&r("*")}function H(e,t){var i,n,r=re.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&re.extend(!0,e,i),e}function G(e,t,i){for(var n,r,o,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){l.unshift(a);break}if(l[0]in i)o=l[0];else{for(a in i){if(!l[0]||e.converters[a+" "+l[0]]){o=a;break}n||(n=a)}o=o||n}if(o)return o!==l[0]&&l.unshift(o),i[o]}function q(e,t,i,n){var r,o,a,s,l,d={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)d[a.toLowerCase()]=e.converters[a];for(o=u.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=d[l+" "+o]||d["* "+o],!a)for(r in d)if(s=r.split(" "),s[1]===o&&(a=d[l+" "+s[0]]||d["* "+s[0]])){a===!0?a=d[r]:d[r]!==!0&&(o=s[0],u.unshift(s[1]));break}if(a!==!0)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function V(e,t,i,n){var r;if(re.isArray(t))re.each(t,function(t,r){i||$t.test(e)?n(e,r):V(e+"["+("object"==typeof r?t:"")+"]",r,i,n)});else if(i||"object"!==re.type(t))n(e,t);else for(r in t)V(e+"["+r+"]",t[r],i,n)}function W(){try{return new e.XMLHttpRequest}catch(e){}}function $(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function z(e){return re.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}var K=[],Y=K.slice,X=K.concat,J=K.push,Q=K.indexOf,Z={},ee=Z.toString,te=Z.hasOwnProperty,ie={},ne="1.11.3",re=function(e,t){return new re.fn.init(e,t)},oe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ae=/^-ms-/,se=/-([\da-z])/gi,le=function(e,t){return t.toUpperCase()};re.fn=re.prototype={jquery:ne,constructor:re,selector:"",length:0,toArray:function(){return Y.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:Y.call(this)},pushStack:function(e){var t=re.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return re.each(this,e,t)},map:function(e){return this.pushStack(re.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(Y.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:J,sort:K.sort,splice:K.splice},re.extend=re.fn.extend=function(){var e,t,i,n,r,o,a=arguments[0]||{},s=1,l=arguments.length,d=!1;for("boolean"==typeof a&&(d=a,a=arguments[s]||{},s++),"object"==typeof a||re.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(r=arguments[s]))for(n in r)e=a[n],i=r[n],a!==i&&(d&&i&&(re.isPlainObject(i)||(t=re.isArray(i)))?(t?(t=!1,o=e&&re.isArray(e)?e:[]):o=e&&re.isPlainObject(e)?e:{},a[n]=re.extend(d,o,i)):void 0!==i&&(a[n]=i));return a},re.extend({expando:"jQuery"+(ne+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===re.type(e)},isArray:Array.isArray||function(e){return"array"===re.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!re.isArray(e)&&e-parseFloat(e)+1>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==re.type(e)||e.nodeType||re.isWindow(e))return!1;try{if(e.constructor&&!te.call(e,"constructor")&&!te.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(ie.ownLast)for(t in e)return te.call(e,t);for(t in e);return void 0===t||te.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Z[ee.call(e)]||"object":typeof e},globalEval:function(t){t&&re.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ae,"ms-").replace(se,le)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,o=0,a=e.length,s=i(e);if(n){if(s)for(;o<a&&(r=t.apply(e[o],n),r!==!1);o++);else for(o in e)if(r=t.apply(e[o],n),r===!1)break}else if(s)for(;o<a&&(r=t.call(e[o],o,e[o]),r!==!1);o++);else for(o in e)if(r=t.call(e[o],o,e[o]),r===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(oe,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?re.merge(n,"string"==typeof e?[e]:e):J.call(n,e)),n},inArray:function(e,t,i){var n;if(t){if(Q)return Q.call(t,e,i);for(n=t.length,i=i?i<0?Math.max(0,n+i):i:0;i<n;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,t){for(var i=+t.length,n=0,r=e.length;n<i;)e[r++]=t[n++];if(i!==i)for(;void 0!==t[n];)e[r++]=t[n++];return e.length=r,e},grep:function(e,t,i){for(var n,r=[],o=0,a=e.length,s=!i;o<a;o++)n=!t(e[o],o),n!==s&&r.push(e[o]);return r},map:function(e,t,n){var r,o=0,a=e.length,s=i(e),l=[];if(s)for(;o<a;o++)r=t(e[o],o,n),null!=r&&l.push(r);else for(o in e)r=t(e[o],o,n),null!=r&&l.push(r);return X.apply([],l)},guid:1,proxy:function(e,t){var i,n,r;if("string"==typeof t&&(r=e[t],t=e,e=r),re.isFunction(e))return i=Y.call(arguments,2),n=function(){return e.apply(t||this,i.concat(Y.call(arguments)))},n.guid=e.guid=e.guid||re.guid++,n},now:function(){return+new Date},support:ie}),re.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Z["[object "+t+"]"]=t.toLowerCase()});var de=function(e){function t(e,t,i,n){var r,o,a,s,l,d,c,h,p,g;if((t?t.ownerDocument||t:j)!==P&&D(t),t=t||P,i=i||[],s=t.nodeType,"string"!=typeof e||!e||1!==s&&9!==s&&11!==s)return i;if(!n&&O){if(11!==s&&(r=ye.exec(e)))if(a=r[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&U(t,o)&&o.id===a)return i.push(o),i}else{if(r[2])return Q.apply(i,t.getElementsByTagName(e)),i;if((a=r[3])&&E.getElementsByClassName)return Q.apply(i,t.getElementsByClassName(a)),i}if(E.qsa&&(!N||!N.test(e))){if(h=c=B,p=t,g=1!==s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(d=T(e),(c=t.getAttribute("id"))?h=c.replace(we,"\\$&"):t.setAttribute("id",h),h="[id='"+h+"'] ",l=d.length;l--;)d[l]=h+f(d[l]);p=be.test(e)&&u(t.parentNode)||t,g=d.join(",")}if(g)try{return Q.apply(i,p.querySelectorAll(g)),i}catch(e){}finally{c||t.removeAttribute("id")}}}return A(e.replace(le,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>_.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[B]=!0,e}function r(e){var t=P.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var i=e.split("|"),n=e.length;n--;)_.attrHandle[i[n]]=t}function a(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||z)-(~e.sourceIndex||z);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function s(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function l(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function d(e){return n(function(t){return t=+t,n(function(i,n){for(var r,o=e([],i.length,t),a=o.length;a--;)i[r=o[a]]&&(i[r]=!(n[r]=i[r]))})})}function u(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function c(){}function f(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function h(e,t,i){var n=t.dir,r=i&&"parentNode"===n,o=G++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||r)return e(t,i,o)}:function(t,i,a){var s,l,d=[H,o];if(a){for(;t=t[n];)if((1===t.nodeType||r)&&e(t,i,a))return!0}else for(;t=t[n];)if(1===t.nodeType||r){if(l=t[B]||(t[B]={}),(s=l[n])&&s[0]===H&&s[1]===o)return d[2]=s[2];if(l[n]=d,d[2]=e(t,i,a))return!0}}}function p(e){return e.length>1?function(t,i,n){for(var r=e.length;r--;)if(!e[r](t,i,n))return!1;return!0}:e[0]}function g(e,i,n){for(var r=0,o=i.length;r<o;r++)t(e,i[r],n);return n}function v(e,t,i,n,r){for(var o,a=[],s=0,l=e.length,d=null!=t;s<l;s++)(o=e[s])&&(i&&!i(o,n,r)||(a.push(o),d&&t.push(s)));return a}function m(e,t,i,r,o,a){return r&&!r[B]&&(r=m(r)),o&&!o[B]&&(o=m(o,a)),n(function(n,a,s,l){var d,u,c,f=[],h=[],p=a.length,m=n||g(t||"*",s.nodeType?[s]:s,[]),y=!e||!n&&t?m:v(m,f,e,s,l),b=i?o||(n?e:p||r)?[]:a:y;if(i&&i(y,b,s,l),r)for(d=v(b,h),r(d,[],s,l),u=d.length;u--;)(c=d[u])&&(b[h[u]]=!(y[h[u]]=c));if(n){if(o||e){if(o){for(d=[],u=b.length;u--;)(c=b[u])&&d.push(y[u]=c);o(null,b=[],d,l)}for(u=b.length;u--;)(c=b[u])&&(d=o?ee(n,c):f[u])>-1&&(n[d]=!(a[d]=c))}}else b=v(b===a?b.splice(p,b.length):b),o?o(null,a,b,l):Q.apply(a,b)})}function y(e){for(var t,i,n,r=e.length,o=_.relative[e[0].type],a=o||_.relative[" "],s=o?1:0,l=h(function(e){return e===t},a,!0),d=h(function(e){return ee(t,e)>-1},a,!0),u=[function(e,i,n){var r=!o&&(n||i!==C)||((t=i).nodeType?l(e,i,n):d(e,i,n));return t=null,r}];s<r;s++)if(i=_.relative[e[s].type])u=[h(p(u),i)];else{if(i=_.filter[e[s].type].apply(null,e[s].matches),i[B]){for(n=++s;n<r&&!_.relative[e[n].type];n++);return m(s>1&&p(u),s>1&&f(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(le,"$1"),i,s<n&&y(e.slice(s,n)),n<r&&y(e=e.slice(n)),n<r&&f(e))}u.push(i)}return p(u)}function b(e,i){var r=i.length>0,o=e.length>0,a=function(n,a,s,l,d){var u,c,f,h=0,p="0",g=n&&[],m=[],y=C,b=n||o&&_.find.TAG("*",d),w=H+=null==y?1:Math.random()||.1,E=b.length;for(d&&(C=a!==P&&a);p!==E&&null!=(u=b[p]);p++){if(o&&u){for(c=0;f=e[c++];)if(f(u,a,s)){l.push(u);break}d&&(H=w)}r&&((u=!f&&u)&&h--,n&&g.push(u))}if(h+=p,r&&p!==h){for(c=0;f=i[c++];)f(g,m,a,s);if(n){if(h>0)for(;p--;)g[p]||m[p]||(m[p]=X.call(l));m=v(m)}Q.apply(l,m),d&&!n&&m.length>0&&h+i.length>1&&t.uniqueSort(l)}return d&&(H=w,C=y),g};return r?n(a):a}var w,E,_,k,S,T,R,A,C,x,L,D,P,I,O,N,M,F,U,B="sizzle"+1*new Date,j=e.document,H=0,G=0,q=i(),V=i(),W=i(),$=function(e,t){return e===t&&(L=!0),0},z=1<<31,K={}.hasOwnProperty,Y=[],X=Y.pop,J=Y.push,Q=Y.push,Z=Y.slice,ee=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",ne="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",re=ne.replace("w","w#"),oe="\\["+ie+"*("+ne+")(?:"+ie+"*([*^$|!~]?=)"+ie+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+re+"))|)"+ie+"*\\]",ae=":("+ne+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+oe+")*)|.*)\\)|)",se=new RegExp(ie+"+","g"),le=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),de=new RegExp("^"+ie+"*,"+ie+"*"),ue=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),ce=new RegExp("="+ie+"*([^\\]'\"]*?)"+ie+"*\\]","g"),fe=new RegExp(ae),he=new RegExp("^"+re+"$"),pe={ID:new RegExp("^#("+ne+")"),CLASS:new RegExp("^\\.("+ne+")"),TAG:new RegExp("^("+ne.replace("w","w*")+")"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},ge=/^(?:input|select|textarea|button)$/i,ve=/^h\d$/i,me=/^[^{]+\{\s*\[native \w/,ye=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/[+~]/,we=/'|\\/g,Ee=new RegExp("\\\\([\\da-f]{1,6}"+ie+"?|("+ie+")|.)","ig"),_e=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ke=function(){D()};try{Q.apply(Y=Z.call(j.childNodes),j.childNodes),Y[j.childNodes.length].nodeType}catch(e){Q={apply:Y.length?function(e,t){J.apply(e,Z.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}E=t.support={},S=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},D=t.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:j;return n!==P&&9===n.nodeType&&n.documentElement?(P=n,I=n.documentElement,i=n.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",ke,!1):i.attachEvent&&i.attachEvent("onunload",ke)),O=!S(n),E.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),E.getElementsByTagName=r(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),E.getElementsByClassName=me.test(n.getElementsByClassName),E.getById=r(function(e){return I.appendChild(e).id=B,!n.getElementsByName||!n.getElementsByName(B).length}),E.getById?(_.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&O){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},_.filter.ID=function(e){var t=e.replace(Ee,_e);return function(e){return e.getAttribute("id")===t}}):(delete _.find.ID,_.filter.ID=function(e){var t=e.replace(Ee,_e);return function(e){var i="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),_.find.TAG=E.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):E.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},_.find.CLASS=E.getElementsByClassName&&function(e,t){if(O)return t.getElementsByClassName(e)},M=[],N=[],(E.qsa=me.test(n.querySelectorAll))&&(r(function(e){I.appendChild(e).innerHTML="<a id='"+B+"'></a><select id='"+B+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&N.push("[*^$]="+ie+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||N.push("\\["+ie+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+B+"-]").length||N.push("~="),e.querySelectorAll(":checked").length||N.push(":checked"),e.querySelectorAll("a#"+B+"+*").length||N.push(".#.+[+~]")}),r(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&N.push("name"+ie+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")})),(E.matchesSelector=me.test(F=I.matches||I.webkitMatchesSelector||I.mozMatchesSelector||I.oMatchesSelector||I.msMatchesSelector))&&r(function(e){E.disconnectedMatch=F.call(e,"div"),F.call(e,"[s!='']:x"),M.push("!=",ae)}),N=N.length&&new RegExp(N.join("|")),M=M.length&&new RegExp(M.join("|")),t=me.test(I.compareDocumentPosition),U=t||me.test(I.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},$=t?function(e,t){if(e===t)return L=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!E.sortDetached&&t.compareDocumentPosition(e)===i?e===n||e.ownerDocument===j&&U(j,e)?-1:t===n||t.ownerDocument===j&&U(j,t)?1:x?ee(x,e)-ee(x,t):0:4&i?-1:1)}:function(e,t){if(e===t)return L=!0,0;var i,r=0,o=e.parentNode,s=t.parentNode,l=[e],d=[t];if(!o||!s)return e===n?-1:t===n?1:o?-1:s?1:x?ee(x,e)-ee(x,t):0;if(o===s)return a(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)d.unshift(i);for(;l[r]===d[r];)r++;return r?a(l[r],d[r]):l[r]===j?-1:d[r]===j?1:0},n):P},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==P&&D(e),i=i.replace(ce,"='$1']"),E.matchesSelector&&O&&(!M||!M.test(i))&&(!N||!N.test(i)))try{var n=F.call(e,i);if(n||E.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return t(i,P,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==P&&D(e),U(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==P&&D(e);var i=_.attrHandle[t.toLowerCase()],n=i&&K.call(_.attrHandle,t.toLowerCase())?i(e,t,!O):void 0;return void 0!==n?n:E.attributes||!O?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,r=0;if(L=!E.detectDuplicates,x=!E.sortStable&&e.slice(0),e.sort($),L){for(;t=e[r++];)t===e[r]&&(n=i.push(r));for(;n--;)e.splice(i[n],1)}return x=null,e},k=t.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=k(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)i+=k(t);return i},_=t.selectors={cacheLength:50,createPseudo:n,match:pe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Ee,_e),e[3]=(e[3]||e[4]||e[5]||"").replace(Ee,_e),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return pe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&fe.test(i)&&(t=T(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Ee,_e).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=q[e+" "];return t||(t=new RegExp("(^|"+ie+")"+e+"("+ie+"|$)"))&&q(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(r){var o=t.attr(r,e);return null==o?"!="===i:!i||(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o.replace(se," ")+" ").indexOf(n)>-1:"|="===i&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,i,n,r){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,i,l){var d,u,c,f,h,p,g=o!==a?"nextSibling":"previousSibling",v=t.parentNode,m=s&&t.nodeName.toLowerCase(),y=!l&&!s;if(v){if(o){for(;g;){for(c=t;c=c[g];)if(s?c.nodeName.toLowerCase()===m:1===c.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?v.firstChild:v.lastChild],a&&y){for(u=v[B]||(v[B]={}),d=u[e]||[],h=d[0]===H&&d[1],f=d[0]===H&&d[2],c=h&&v.childNodes[h];c=++h&&c&&c[g]||(f=h=0)||p.pop();)if(1===c.nodeType&&++f&&c===t){u[e]=[H,h,f];break}}else if(y&&(d=(t[B]||(t[B]={}))[e])&&d[0]===H)f=d[1];else for(;(c=++h&&c&&c[g]||(f=h=0)||p.pop())&&((s?c.nodeName.toLowerCase()!==m:1!==c.nodeType)||!++f||(y&&((c[B]||(c[B]={}))[e]=[H,f]),c!==t)););return f-=r,f===n||f%n===0&&f/n>=0}}},PSEUDO:function(e,i){var r,o=_.pseudos[e]||_.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[B]?o(i):o.length>1?(r=[e,e,"",i],_.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,r=o(e,i),a=r.length;a--;)n=ee(e,r[a]),e[n]=!(t[n]=r[a])}):function(e){return o(e,0,r)}):o}},pseudos:{not:n(function(e){var t=[],i=[],r=R(e.replace(le,"$1"));return r[B]?n(function(e,t,i,n){for(var o,a=r(e,null,n,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,n,o){return t[0]=e,r(t,null,o,i),t[0]=null,!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return e=e.replace(Ee,_e),function(t){return(t.textContent||t.innerText||k(t)).indexOf(e)>-1}}),lang:n(function(e){return he.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(Ee,_e).toLowerCase(),function(t){var i;do if(i=O?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===I},focus:function(e){return e===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!_.pseudos.empty(e)},header:function(e){return ve.test(e.nodeName)},input:function(e){return ge.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:d(function(){return[0]}),last:d(function(e,t){return[t-1]}),eq:d(function(e,t,i){return[i<0?i+t:i]}),even:d(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:d(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:d(function(e,t,i){for(var n=i<0?i+t:i;--n>=0;)e.push(n);return e}),gt:d(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}},_.pseudos.nth=_.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[w]=s(w);for(w in{submit:!0,reset:!0})_.pseudos[w]=l(w);return c.prototype=_.filters=_.pseudos,_.setFilters=new c,T=t.tokenize=function(e,i){var n,r,o,a,s,l,d,u=V[e+" "];if(u)return i?0:u.slice(0);for(s=e,l=[],d=_.preFilter;s;){n&&!(r=de.exec(s))||(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),n=!1,(r=ue.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(le," ")}),s=s.slice(n.length));for(a in _.filter)!(r=pe[a].exec(s))||d[a]&&!(r=d[a](r))||(n=r.shift(),
o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return i?s.length:s?t.error(e):V(e,l).slice(0)},R=t.compile=function(e,t){var i,n=[],r=[],o=W[e+" "];if(!o){for(t||(t=T(e)),i=t.length;i--;)o=y(t[i]),o[B]?n.push(o):r.push(o);o=W(e,b(r,n)),o.selector=e}return o},A=t.select=function(e,t,i,n){var r,o,a,s,l,d="function"==typeof e&&e,c=!n&&T(e=d.selector||e);if(i=i||[],1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&E.getById&&9===t.nodeType&&O&&_.relative[o[1].type]){if(t=(_.find.ID(a.matches[0].replace(Ee,_e),t)||[])[0],!t)return i;d&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=pe.needsContext.test(e)?0:o.length;r--&&(a=o[r],!_.relative[s=a.type]);)if((l=_.find[s])&&(n=l(a.matches[0].replace(Ee,_e),be.test(o[0].type)&&u(t.parentNode)||t))){if(o.splice(r,1),e=n.length&&f(o),!e)return Q.apply(i,n),i;break}}return(d||R(e,c))(n,t,!O,i,be.test(e)&&u(t.parentNode)||t),i},E.sortStable=B.split("").sort($).join("")===B,E.detectDuplicates=!!L,D(),E.sortDetached=r(function(e){return 1&e.compareDocumentPosition(P.createElement("div"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),E.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||o(te,function(e,t,i){var n;if(!i)return e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);re.find=de,re.expr=de.selectors,re.expr[":"]=re.expr.pseudos,re.unique=de.uniqueSort,re.text=de.getText,re.isXMLDoc=de.isXML,re.contains=de.contains;var ue=re.expr.match.needsContext,ce=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,fe=/^.[^:#\[\.,]*$/;re.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?re.find.matchesSelector(n,e)?[n]:[]:re.find.matches(e,re.grep(t,function(e){return 1===e.nodeType}))},re.fn.extend({find:function(e){var t,i=[],n=this,r=n.length;if("string"!=typeof e)return this.pushStack(re(e).filter(function(){for(t=0;t<r;t++)if(re.contains(n[t],this))return!0}));for(t=0;t<r;t++)re.find(e,n[t],i);return i=this.pushStack(r>1?re.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(n(this,e||[],!1))},not:function(e){return this.pushStack(n(this,e||[],!0))},is:function(e){return!!n(this,"string"==typeof e&&ue.test(e)?re(e):e||[],!1).length}});var he,pe=e.document,ge=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ve=re.fn.init=function(e,t){var i,n;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ge.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||he).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof re?t[0]:t,re.merge(this,re.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:pe,!0)),ce.test(i[1])&&re.isPlainObject(t))for(i in t)re.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}if(n=pe.getElementById(i[2]),n&&n.parentNode){if(n.id!==i[2])return he.find(e);this.length=1,this[0]=n}return this.context=pe,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):re.isFunction(e)?"undefined"!=typeof he.ready?he.ready(e):e(re):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),re.makeArray(e,this))};ve.prototype=re.fn,he=re(pe);var me=/^(?:parents|prev(?:Until|All))/,ye={children:!0,contents:!0,next:!0,prev:!0};re.extend({dir:function(e,t,i){for(var n=[],r=e[t];r&&9!==r.nodeType&&(void 0===i||1!==r.nodeType||!re(r).is(i));)1===r.nodeType&&n.push(r),r=r[t];return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),re.fn.extend({has:function(e){var t,i=re(e,this),n=i.length;return this.filter(function(){for(t=0;t<n;t++)if(re.contains(this,i[t]))return!0})},closest:function(e,t){for(var i,n=0,r=this.length,o=[],a=ue.test(e)||"string"!=typeof e?re(e,t||this.context):0;n<r;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&re.find.matchesSelector(i,e))){o.push(i);break}return this.pushStack(o.length>1?re.unique(o):o)},index:function(e){return e?"string"==typeof e?re.inArray(this[0],re(e)):re.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(re.unique(re.merge(this.get(),re(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),re.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return re.dir(e,"parentNode")},parentsUntil:function(e,t,i){return re.dir(e,"parentNode",i)},next:function(e){return r(e,"nextSibling")},prev:function(e){return r(e,"previousSibling")},nextAll:function(e){return re.dir(e,"nextSibling")},prevAll:function(e){return re.dir(e,"previousSibling")},nextUntil:function(e,t,i){return re.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return re.dir(e,"previousSibling",i)},siblings:function(e){return re.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return re.sibling(e.firstChild)},contents:function(e){return re.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:re.merge([],e.childNodes)}},function(e,t){re.fn[e]=function(i,n){var r=re.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=re.filter(n,r)),this.length>1&&(ye[e]||(r=re.unique(r)),me.test(e)&&(r=r.reverse())),this.pushStack(r)}});var be=/\S+/g,we={};re.Callbacks=function(e){e="string"==typeof e?we[e]||o(e):re.extend({},e);var t,i,n,r,a,s,l=[],d=!e.once&&[],u=function(o){for(i=e.memory&&o,n=!0,a=s||0,s=0,r=l.length,t=!0;l&&a<r;a++)if(l[a].apply(o[0],o[1])===!1&&e.stopOnFalse){i=!1;break}t=!1,l&&(d?d.length&&u(d.shift()):i?l=[]:c.disable())},c={add:function(){if(l){var n=l.length;!function t(i){re.each(i,function(i,n){var r=re.type(n);"function"===r?e.unique&&c.has(n)||l.push(n):n&&n.length&&"string"!==r&&t(n)})}(arguments),t?r=l.length:i&&(s=n,u(i))}return this},remove:function(){return l&&re.each(arguments,function(e,i){for(var n;(n=re.inArray(i,l,n))>-1;)l.splice(n,1),t&&(n<=r&&r--,n<=a&&a--)}),this},has:function(e){return e?re.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],r=0,this},disable:function(){return l=d=i=void 0,this},disabled:function(){return!l},lock:function(){return d=void 0,i||c.disable(),this},locked:function(){return!d},fireWith:function(e,i){return!l||n&&!d||(i=i||[],i=[e,i.slice?i.slice():i],t?d.push(i):u(i)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},re.extend({Deferred:function(e){var t=[["resolve","done",re.Callbacks("once memory"),"resolved"],["reject","fail",re.Callbacks("once memory"),"rejected"],["notify","progress",re.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return re.Deferred(function(i){re.each(t,function(t,o){var a=re.isFunction(e[t])&&e[t];r[o[1]](function(){var e=a&&a.apply(this,arguments);e&&re.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o[0]+"With"](this===n?i.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?re.extend(e,n):n}},r={};return n.pipe=n.then,re.each(t,function(e,o){var a=o[2],s=o[3];n[o[1]]=a.add,s&&a.add(function(){i=s},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=a.fireWith}),n.promise(r),e&&e.call(r,r),r},when:function(e){var t,i,n,r=0,o=Y.call(arguments),a=o.length,s=1!==a||e&&re.isFunction(e.promise)?a:0,l=1===s?e:re.Deferred(),d=function(e,i,n){return function(r){i[e]=this,n[e]=arguments.length>1?Y.call(arguments):r,n===t?l.notifyWith(i,n):--s||l.resolveWith(i,n)}};if(a>1)for(t=new Array(a),i=new Array(a),n=new Array(a);r<a;r++)o[r]&&re.isFunction(o[r].promise)?o[r].promise().done(d(r,n,o)).fail(l.reject).progress(d(r,i,t)):--s;return s||l.resolveWith(n,o),l.promise()}});var Ee;re.fn.ready=function(e){return re.ready.promise().done(e),this},re.extend({isReady:!1,readyWait:1,holdReady:function(e){e?re.readyWait++:re.ready(!0)},ready:function(e){if(e===!0?!--re.readyWait:!re.isReady){if(!pe.body)return setTimeout(re.ready);re.isReady=!0,e!==!0&&--re.readyWait>0||(Ee.resolveWith(pe,[re]),re.fn.triggerHandler&&(re(pe).triggerHandler("ready"),re(pe).off("ready")))}}}),re.ready.promise=function(t){if(!Ee)if(Ee=re.Deferred(),"complete"===pe.readyState)setTimeout(re.ready);else if(pe.addEventListener)pe.addEventListener("DOMContentLoaded",s,!1),e.addEventListener("load",s,!1);else{pe.attachEvent("onreadystatechange",s),e.attachEvent("onload",s);var i=!1;try{i=null==e.frameElement&&pe.documentElement}catch(e){}i&&i.doScroll&&!function e(){if(!re.isReady){try{i.doScroll("left")}catch(t){return setTimeout(e,50)}a(),re.ready()}}()}return Ee.promise(t)};var _e,ke="undefined";for(_e in re(ie))break;ie.ownLast="0"!==_e,ie.inlineBlockNeedsLayout=!1,re(function(){var e,t,i,n;i=pe.getElementsByTagName("body")[0],i&&i.style&&(t=pe.createElement("div"),n=pe.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(t),typeof t.style.zoom!==ke&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",ie.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(i.style.zoom=1)),i.removeChild(n))}),function(){var e=pe.createElement("div");if(null==ie.deleteExpando){ie.deleteExpando=!0;try{delete e.test}catch(e){ie.deleteExpando=!1}}e=null}(),re.acceptData=function(e){var t=re.noData[(e.nodeName+" ").toLowerCase()],i=+e.nodeType||1;return(1===i||9===i)&&(!t||t!==!0&&e.getAttribute("classid")===t)};var Se=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Te=/([A-Z])/g;re.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?re.cache[e[re.expando]]:e[re.expando],!!e&&!d(e)},data:function(e,t,i){return u(e,t,i)},removeData:function(e,t){return c(e,t)},_data:function(e,t,i){return u(e,t,i,!0)},_removeData:function(e,t){return c(e,t,!0)}}),re.fn.extend({data:function(e,t){var i,n,r,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(r=re.data(o),1===o.nodeType&&!re._data(o,"parsedAttrs"))){for(i=a.length;i--;)a[i]&&(n=a[i].name,0===n.indexOf("data-")&&(n=re.camelCase(n.slice(5)),l(o,n,r[n])));re._data(o,"parsedAttrs",!0)}return r}return"object"==typeof e?this.each(function(){re.data(this,e)}):arguments.length>1?this.each(function(){re.data(this,e,t)}):o?l(o,e,re.data(o,e)):void 0},removeData:function(e){return this.each(function(){re.removeData(this,e)})}}),re.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=re._data(e,t),i&&(!n||re.isArray(i)?n=re._data(e,t,re.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=re.queue(e,t),n=i.length,r=i.shift(),o=re._queueHooks(e,t),a=function(){re.dequeue(e,t)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===t&&i.unshift("inprogress"),delete o.stop,r.call(e,a,o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return re._data(e,i)||re._data(e,i,{empty:re.Callbacks("once memory").add(function(){re._removeData(e,t+"queue"),re._removeData(e,i)})})}}),re.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?re.queue(this[0],e):void 0===t?this:this.each(function(){var i=re.queue(this,e,t);re._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&re.dequeue(this,e)})},dequeue:function(e){return this.each(function(){re.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,r=re.Deferred(),o=this,a=this.length,s=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)i=re._data(o[a],e+"queueHooks"),i&&i.empty&&(n++,i.empty.add(s));return s(),r.promise(t)}});var Re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ae=["Top","Right","Bottom","Left"],Ce=function(e,t){return e=t||e,"none"===re.css(e,"display")||!re.contains(e.ownerDocument,e)},xe=re.access=function(e,t,i,n,r,o,a){var s=0,l=e.length,d=null==i;if("object"===re.type(i)){r=!0;for(s in i)re.access(e,t,s,i[s],!0,o,a)}else if(void 0!==n&&(r=!0,re.isFunction(n)||(a=!0),d&&(a?(t.call(e,n),t=null):(d=t,t=function(e,t,i){return d.call(re(e),i)})),t))for(;s<l;s++)t(e[s],i,a?n:n.call(e[s],s,t(e[s],i)));return r?e:d?t.call(e):l?t(e[0],i):o},Le=/^(?:checkbox|radio)$/i;!function(){var e=pe.createElement("input"),t=pe.createElement("div"),i=pe.createDocumentFragment();if(t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",ie.leadingWhitespace=3===t.firstChild.nodeType,ie.tbody=!t.getElementsByTagName("tbody").length,ie.htmlSerialize=!!t.getElementsByTagName("link").length,ie.html5Clone="<:nav></:nav>"!==pe.createElement("nav").cloneNode(!0).outerHTML,e.type="checkbox",e.checked=!0,i.appendChild(e),ie.appendChecked=e.checked,t.innerHTML="<textarea>x</textarea>",ie.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,i.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",ie.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,ie.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){ie.noCloneEvent=!1}),t.cloneNode(!0).click()),null==ie.deleteExpando){ie.deleteExpando=!0;try{delete t.test}catch(e){ie.deleteExpando=!1}}}(),function(){var t,i,n=pe.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})i="on"+t,(ie[t+"Bubbles"]=i in e)||(n.setAttribute(i,"t"),ie[t+"Bubbles"]=n.attributes[i].expando===!1);n=null}();var De=/^(?:input|select|textarea)$/i,Pe=/^key/,Ie=/^(?:mouse|pointer|contextmenu)|click/,Oe=/^(?:focusinfocus|focusoutblur)$/,Ne=/^([^.]*)(?:\.(.+)|)$/;re.event={global:{},add:function(e,t,i,n,r){var o,a,s,l,d,u,c,f,h,p,g,v=re._data(e);if(v){for(i.handler&&(l=i,i=l.handler,r=l.selector),i.guid||(i.guid=re.guid++),(a=v.events)||(a=v.events={}),(u=v.handle)||(u=v.handle=function(e){return typeof re===ke||e&&re.event.triggered===e.type?void 0:re.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(be)||[""],s=t.length;s--;)o=Ne.exec(t[s])||[],h=g=o[1],p=(o[2]||"").split(".").sort(),h&&(d=re.event.special[h]||{},h=(r?d.delegateType:d.bindType)||h,d=re.event.special[h]||{},c=re.extend({type:h,origType:g,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&re.expr.match.needsContext.test(r),namespace:p.join(".")},l),(f=a[h])||(f=a[h]=[],f.delegateCount=0,d.setup&&d.setup.call(e,n,p,u)!==!1||(e.addEventListener?e.addEventListener(h,u,!1):e.attachEvent&&e.attachEvent("on"+h,u))),d.add&&(d.add.call(e,c),c.handler.guid||(c.handler.guid=i.guid)),r?f.splice(f.delegateCount++,0,c):f.push(c),re.event.global[h]=!0);e=null}},remove:function(e,t,i,n,r){var o,a,s,l,d,u,c,f,h,p,g,v=re.hasData(e)&&re._data(e);if(v&&(u=v.events)){for(t=(t||"").match(be)||[""],d=t.length;d--;)if(s=Ne.exec(t[d])||[],h=g=s[1],p=(s[2]||"").split(".").sort(),h){for(c=re.event.special[h]||{},h=(n?c.delegateType:c.bindType)||h,f=u[h]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;o--;)a=f[o],!r&&g!==a.origType||i&&i.guid!==a.guid||s&&!s.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,c.remove&&c.remove.call(e,a));l&&!f.length&&(c.teardown&&c.teardown.call(e,p,v.handle)!==!1||re.removeEvent(e,h,v.handle),delete u[h])}else for(h in u)re.event.remove(e,h+t[d],i,n,!0);re.isEmptyObject(u)&&(delete v.handle,re._removeData(e,"events"))}},trigger:function(t,i,n,r){var o,a,s,l,d,u,c,f=[n||pe],h=te.call(t,"type")?t.type:t,p=te.call(t,"namespace")?t.namespace.split("."):[];if(s=u=n=n||pe,3!==n.nodeType&&8!==n.nodeType&&!Oe.test(h+re.event.triggered)&&(h.indexOf(".")>=0&&(p=h.split("."),h=p.shift(),p.sort()),a=h.indexOf(":")<0&&"on"+h,t=t[re.expando]?t:new re.Event(h,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=p.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:re.makeArray(i,[t]),d=re.event.special[h]||{},r||!d.trigger||d.trigger.apply(n,i)!==!1)){if(!r&&!d.noBubble&&!re.isWindow(n)){for(l=d.delegateType||h,Oe.test(l+h)||(s=s.parentNode);s;s=s.parentNode)f.push(s),u=s;u===(n.ownerDocument||pe)&&f.push(u.defaultView||u.parentWindow||e)}for(c=0;(s=f[c++])&&!t.isPropagationStopped();)t.type=c>1?l:d.bindType||h,o=(re._data(s,"events")||{})[t.type]&&re._data(s,"handle"),o&&o.apply(s,i),o=a&&s[a],o&&o.apply&&re.acceptData(s)&&(t.result=o.apply(s,i),t.result===!1&&t.preventDefault());if(t.type=h,!r&&!t.isDefaultPrevented()&&(!d._default||d._default.apply(f.pop(),i)===!1)&&re.acceptData(n)&&a&&n[h]&&!re.isWindow(n)){u=n[a],u&&(n[a]=null),re.event.triggered=h;try{n[h]()}catch(e){}re.event.triggered=void 0,u&&(n[a]=u)}return t.result}},dispatch:function(e){e=re.event.fix(e);var t,i,n,r,o,a=[],s=Y.call(arguments),l=(re._data(this,"events")||{})[e.type]||[],d=re.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!d.preDispatch||d.preDispatch.call(this,e)!==!1){for(a=re.event.handlers.call(this,e,l),t=0;(r=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,o=0;(n=r.handlers[o++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(n.namespace)||(e.handleObj=n,e.data=n.data,i=((re.event.special[n.origType]||{}).handle||n.handler).apply(r.elem,s),void 0!==i&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,r,o,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(r=[],o=0;o<s;o++)n=t[o],i=n.selector+" ",void 0===r[i]&&(r[i]=n.needsContext?re(i,this).index(l)>=0:re.find(i,this,null,[l]).length),r[i]&&r.push(n);r.length&&a.push({elem:l,handlers:r})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[re.expando])return e;var t,i,n,r=e.type,o=e,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=Ie.test(r)?this.mouseHooks:Pe.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new re.Event(o),t=n.length;t--;)i=n[t],e[i]=o[i];return e.target||(e.target=o.srcElement||pe),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,r,o=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||pe,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==p()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===p()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(re.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return re.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var r=re.extend(new re.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?re.event.trigger(r,null,t):re.event.dispatch.call(t,r),r.isDefaultPrevented()&&i.preventDefault()}},re.removeEvent=pe.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===ke&&(e[n]=null),e.detachEvent(n,i))},re.Event=function(e,t){return this instanceof re.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?f:h):this.type=e,t&&re.extend(this,t),this.timeStamp=e&&e.timeStamp||re.now(),void(this[re.expando]=!0)):new re.Event(e,t)},re.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=f,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=f,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=f,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},re.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){re.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,r=e.relatedTarget,o=e.handleObj;return r&&(r===n||re.contains(n,r))||(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),ie.submitBubbles||(re.event.special.submit={setup:function(){return!re.nodeName(this,"form")&&void re.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,i=re.nodeName(t,"input")||re.nodeName(t,"button")?t.form:void 0;i&&!re._data(i,"submitBubbles")&&(re.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),re._data(i,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&re.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return!re.nodeName(this,"form")&&void re.event.remove(this,"._submit")}}),ie.changeBubbles||(re.event.special.change={setup:function(){return De.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(re.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),re.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),re.event.simulate("change",this,e,!0)})),!1):void re.event.add(this,"beforeactivate._change",function(e){var t=e.target;De.test(t.nodeName)&&!re._data(t,"changeBubbles")&&(re.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||re.event.simulate("change",this.parentNode,e,!0)}),re._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return re.event.remove(this,"._change"),!De.test(this.nodeName)}}),ie.focusinBubbles||re.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){re.event.simulate(t,e.target,re.event.fix(e),!0)};re.event.special[t]={setup:function(){var n=this.ownerDocument||this,r=re._data(n,t);r||n.addEventListener(e,i,!0),re._data(n,t,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=re._data(n,t)-1;r?re._data(n,t,r):(n.removeEventListener(e,i,!0),re._removeData(n,t))}}}),re.fn.extend({on:function(e,t,i,n,r){var o,a;if("object"==typeof e){"string"!=typeof t&&(i=i||t,t=void 0);for(o in e)this.on(o,t,i,e[o],r);return this}if(null==i&&null==n?(n=t,i=t=void 0):null==n&&("string"==typeof t?(n=i,i=void 0):(n=i,i=t,t=void 0)),n===!1)n=h;else if(!n)return this;return 1===r&&(a=n,n=function(e){return re().off(e),a.apply(this,arguments)},n.guid=a.guid||(a.guid=re.guid++)),this.each(function(){re.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,re(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return t!==!1&&"function"!=typeof t||(i=t,t=void 0),i===!1&&(i=h),this.each(function(){re.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){re.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return re.event.trigger(e,t,i,!0)}});var Me="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Fe=/ jQuery\d+="(?:null|\d+)"/g,Ue=new RegExp("<(?:"+Me+")[\\s/>]","i"),Be=/^\s+/,je=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,He=/<([\w:]+)/,Ge=/<tbody/i,qe=/<|&#?\w+;/,Ve=/<(?:script|style|link)/i,We=/checked\s*(?:[^=]|=\s*.checked.)/i,$e=/^$|\/(?:java|ecma)script/i,ze=/^true\/(.*)/,Ke=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ye={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ie.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Xe=g(pe),Je=Xe.appendChild(pe.createElement("div"));Ye.optgroup=Ye.option,Ye.tbody=Ye.tfoot=Ye.colgroup=Ye.caption=Ye.thead,Ye.th=Ye.td,re.extend({clone:function(e,t,i){var n,r,o,a,s,l=re.contains(e.ownerDocument,e);if(ie.html5Clone||re.isXMLDoc(e)||!Ue.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Je.innerHTML=e.outerHTML,Je.removeChild(o=Je.firstChild)),!(ie.noCloneEvent&&ie.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||re.isXMLDoc(e)))for(n=v(o),s=v(e),a=0;null!=(r=s[a]);++a)n[a]&&k(r,n[a]);if(t)if(i)for(s=s||v(e),n=n||v(o),a=0;null!=(r=s[a]);a++)_(r,n[a]);else _(e,o);return n=v(o,"script"),n.length>0&&E(n,!l&&v(e,"script")),n=s=r=null,o},buildFragment:function(e,t,i,n){for(var r,o,a,s,l,d,u,c=e.length,f=g(t),h=[],p=0;p<c;p++)if(o=e[p],o||0===o)if("object"===re.type(o))re.merge(h,o.nodeType?[o]:o);else if(qe.test(o)){for(s=s||f.appendChild(t.createElement("div")),l=(He.exec(o)||["",""])[1].toLowerCase(),u=Ye[l]||Ye._default,s.innerHTML=u[1]+o.replace(je,"<$1></$2>")+u[2],r=u[0];r--;)s=s.lastChild;if(!ie.leadingWhitespace&&Be.test(o)&&h.push(t.createTextNode(Be.exec(o)[0])),!ie.tbody)for(o="table"!==l||Ge.test(o)?"<table>"!==u[1]||Ge.test(o)?0:s:s.firstChild,r=o&&o.childNodes.length;r--;)re.nodeName(d=o.childNodes[r],"tbody")&&!d.childNodes.length&&o.removeChild(d);for(re.merge(h,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=f.lastChild}else h.push(t.createTextNode(o));for(s&&f.removeChild(s),ie.appendChecked||re.grep(v(h,"input"),m),p=0;o=h[p++];)if((!n||re.inArray(o,n)===-1)&&(a=re.contains(o.ownerDocument,o),s=v(f.appendChild(o),"script"),a&&E(s),i))for(r=0;o=s[r++];)$e.test(o.type||"")&&i.push(o);return s=null,f},cleanData:function(e,t){for(var i,n,r,o,a=0,s=re.expando,l=re.cache,d=ie.deleteExpando,u=re.event.special;null!=(i=e[a]);a++)if((t||re.acceptData(i))&&(r=i[s],o=r&&l[r])){if(o.events)for(n in o.events)u[n]?re.event.remove(i,n):re.removeEvent(i,n,o.handle);l[r]&&(delete l[r],d?delete i[s]:typeof i.removeAttribute!==ke?i.removeAttribute(s):i[s]=null,K.push(r))}}}),re.fn.extend({text:function(e){return xe(this,function(e){return void 0===e?re.text(this):this.empty().append((this[0]&&this[0].ownerDocument||pe).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=y(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=y(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?re.filter(e,this):this,r=0;null!=(i=n[r]);r++)t||1!==i.nodeType||re.cleanData(v(i)),i.parentNode&&(t&&re.contains(i.ownerDocument,i)&&E(v(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&re.cleanData(v(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&re.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return re.clone(this,e,t)})},html:function(e){return xe(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(Fe,""):void 0;if("string"==typeof e&&!Ve.test(e)&&(ie.htmlSerialize||!Ue.test(e))&&(ie.leadingWhitespace||!Be.test(e))&&!Ye[(He.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(je,"<$1></$2>");try{for(;i<n;i++)t=this[i]||{},1===t.nodeType&&(re.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,re.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=X.apply([],e);var i,n,r,o,a,s,l=0,d=this.length,u=this,c=d-1,f=e[0],h=re.isFunction(f);if(h||d>1&&"string"==typeof f&&!ie.checkClone&&We.test(f))return this.each(function(i){var n=u.eq(i);h&&(e[0]=f.call(this,i,n.html())),n.domManip(e,t)});if(d&&(s=re.buildFragment(e,this[0].ownerDocument,!1,this),i=s.firstChild,1===s.childNodes.length&&(s=i),i)){for(o=re.map(v(s,"script"),b),r=o.length;l<d;l++)n=s,l!==c&&(n=re.clone(n,!0,!0),r&&re.merge(o,v(n,"script"))),t.call(this[l],n,l);if(r)for(a=o[o.length-1].ownerDocument,re.map(o,w),l=0;l<r;l++)n=o[l],$e.test(n.type||"")&&!re._data(n,"globalEval")&&re.contains(a,n)&&(n.src?re._evalUrl&&re._evalUrl(n.src):re.globalEval((n.text||n.textContent||n.innerHTML||"").replace(Ke,"")));s=i=null}return this}}),re.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){re.fn[e]=function(e){for(var i,n=0,r=[],o=re(e),a=o.length-1;n<=a;n++)i=n===a?this:this.clone(!0),re(o[n])[t](i),J.apply(r,i.get());return this.pushStack(r)}});var Qe,Ze={};!function(){var e;ie.shrinkWrapBlocks=function(){if(null!=e)return e;e=!1;var t,i,n;return i=pe.getElementsByTagName("body")[0],i&&i.style?(t=pe.createElement("div"),n=pe.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(t),typeof t.style.zoom!==ke&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(pe.createElement("div")).style.width="5px",e=3!==t.offsetWidth),i.removeChild(n),e):void 0}}();var et,tt,it=/^margin/,nt=new RegExp("^("+Re+")(?!px)[a-z%]+$","i"),rt=/^(top|right|bottom|left)$/;e.getComputedStyle?(et=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)},tt=function(e,t,i){var n,r,o,a,s=e.style;return i=i||et(e),a=i?i.getPropertyValue(t)||i[t]:void 0,i&&(""!==a||re.contains(e.ownerDocument,e)||(a=re.style(e,t)),nt.test(a)&&it.test(t)&&(n=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,
a=i.width,s.width=n,s.minWidth=r,s.maxWidth=o)),void 0===a?a:a+""}):pe.documentElement.currentStyle&&(et=function(e){return e.currentStyle},tt=function(e,t,i){var n,r,o,a,s=e.style;return i=i||et(e),a=i?i[t]:void 0,null==a&&s&&s[t]&&(a=s[t]),nt.test(a)&&!rt.test(t)&&(n=s.left,r=e.runtimeStyle,o=r&&r.left,o&&(r.left=e.currentStyle.left),s.left="fontSize"===t?"1em":a,a=s.pixelLeft+"px",s.left=n,o&&(r.left=o)),void 0===a?a:a+""||"auto"}),function(){function t(){var t,i,n,r;i=pe.getElementsByTagName("body")[0],i&&i.style&&(t=pe.createElement("div"),n=pe.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(t),t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",o=a=!1,l=!0,e.getComputedStyle&&(o="1%"!==(e.getComputedStyle(t,null)||{}).top,a="4px"===(e.getComputedStyle(t,null)||{width:"4px"}).width,r=t.appendChild(pe.createElement("div")),r.style.cssText=t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",r.style.marginRight=r.style.width="0",t.style.width="1px",l=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight),t.removeChild(r)),t.innerHTML="<table><tr><td></td><td>t</td></tr></table>",r=t.getElementsByTagName("td"),r[0].style.cssText="margin:0;border:0;padding:0;display:none",s=0===r[0].offsetHeight,s&&(r[0].style.display="",r[1].style.display="none",s=0===r[0].offsetHeight),i.removeChild(n))}var i,n,r,o,a,s,l;i=pe.createElement("div"),i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=i.getElementsByTagName("a")[0],n=r&&r.style,n&&(n.cssText="float:left;opacity:.5",ie.opacity="0.5"===n.opacity,ie.cssFloat=!!n.cssFloat,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",ie.clearCloneStyle="content-box"===i.style.backgroundClip,ie.boxSizing=""===n.boxSizing||""===n.MozBoxSizing||""===n.WebkitBoxSizing,re.extend(ie,{reliableHiddenOffsets:function(){return null==s&&t(),s},boxSizingReliable:function(){return null==a&&t(),a},pixelPosition:function(){return null==o&&t(),o},reliableMarginRight:function(){return null==l&&t(),l}}))}(),re.swap=function(e,t,i,n){var r,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];r=i.apply(e,n||[]);for(o in t)e.style[o]=a[o];return r};var ot=/alpha\([^)]*\)/i,at=/opacity\s*=\s*([^)]*)/,st=/^(none|table(?!-c[ea]).+)/,lt=new RegExp("^("+Re+")(.*)$","i"),dt=new RegExp("^([+-])=("+Re+")","i"),ut={position:"absolute",visibility:"hidden",display:"block"},ct={letterSpacing:"0",fontWeight:"400"},ft=["Webkit","O","Moz","ms"];re.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=tt(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:ie.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,s=re.camelCase(t),l=e.style;if(t=re.cssProps[s]||(re.cssProps[s]=A(l,s)),a=re.cssHooks[t]||re.cssHooks[s],void 0===i)return a&&"get"in a&&void 0!==(r=a.get(e,!1,n))?r:l[t];if(o=typeof i,"string"===o&&(r=dt.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(re.css(e,t)),o="number"),null!=i&&i===i&&("number"!==o||re.cssNumber[s]||(i+="px"),ie.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),!(a&&"set"in a&&void 0===(i=a.set(e,i,n)))))try{l[t]=i}catch(e){}}},css:function(e,t,i,n){var r,o,a,s=re.camelCase(t);return t=re.cssProps[s]||(re.cssProps[s]=A(e.style,s)),a=re.cssHooks[t]||re.cssHooks[s],a&&"get"in a&&(o=a.get(e,!0,i)),void 0===o&&(o=tt(e,t,n)),"normal"===o&&t in ct&&(o=ct[t]),""===i||i?(r=parseFloat(o),i===!0||re.isNumeric(r)?r||0:o):o}}),re.each(["height","width"],function(e,t){re.cssHooks[t]={get:function(e,i,n){if(i)return st.test(re.css(e,"display"))&&0===e.offsetWidth?re.swap(e,ut,function(){return D(e,t,n)}):D(e,t,n)},set:function(e,i,n){var r=n&&et(e);return x(e,i,n?L(e,t,n,ie.boxSizing&&"border-box"===re.css(e,"boxSizing",!1,r),r):0)}}}),ie.opacity||(re.cssHooks.opacity={get:function(e,t){return at.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,r=re.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=n&&n.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===re.trim(o.replace(ot,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=ot.test(o)?o.replace(ot,r):o+" "+r)}}),re.cssHooks.marginRight=R(ie.reliableMarginRight,function(e,t){if(t)return re.swap(e,{display:"inline-block"},tt,[e,"marginRight"])}),re.each({margin:"",padding:"",border:"Width"},function(e,t){re.cssHooks[e+t]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];n<4;n++)r[e+Ae[n]+t]=o[n]||o[n-2]||o[0];return r}},it.test(e)||(re.cssHooks[e+t].set=x)}),re.fn.extend({css:function(e,t){return xe(this,function(e,t,i){var n,r,o={},a=0;if(re.isArray(t)){for(n=et(e),r=t.length;a<r;a++)o[t[a]]=re.css(e,t[a],!1,n);return o}return void 0!==i?re.style(e,t,i):re.css(e,t)},e,t,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ce(this)?re(this).show():re(this).hide()})}}),re.Tween=P,P.prototype={constructor:P,init:function(e,t,i,n,r,o){this.elem=e,this.prop=i,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(re.cssNumber[i]?"":"px")},cur:function(){var e=P.propHooks[this.prop];return e&&e.get?e.get(this):P.propHooks._default.get(this)},run:function(e){var t,i=P.propHooks[this.prop];return this.options.duration?this.pos=t=re.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):P.propHooks._default.set(this),this}},P.prototype.init.prototype=P.prototype,P.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=re.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){re.fx.step[e.prop]?re.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[re.cssProps[e.prop]]||re.cssHooks[e.prop])?re.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},P.propHooks.scrollTop=P.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},re.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},re.fx=P.prototype.init,re.fx.step={};var ht,pt,gt=/^(?:toggle|show|hide)$/,vt=new RegExp("^(?:([+-])=|)("+Re+")([a-z%]*)$","i"),mt=/queueHooks$/,yt=[M],bt={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),r=vt.exec(t),o=r&&r[3]||(re.cssNumber[e]?"":"px"),a=(re.cssNumber[e]||"px"!==o&&+n)&&vt.exec(re.css(i.elem,e)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],r=r||[],a=+n||1;do s=s||".5",a/=s,re.style(i.elem,e,a+o);while(s!==(s=i.cur()/n)&&1!==s&&--l)}return r&&(a=i.start=+a||+n||0,i.unit=o,i.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),i}]};re.Animation=re.extend(U,{tweener:function(e,t){re.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,r=e.length;n<r;n++)i=e[n],bt[i]=bt[i]||[],bt[i].unshift(t)},prefilter:function(e,t){t?yt.unshift(e):yt.push(e)}}),re.speed=function(e,t,i){var n=e&&"object"==typeof e?re.extend({},e):{complete:i||!i&&t||re.isFunction(e)&&e,duration:e,easing:i&&t||t&&!re.isFunction(t)&&t};return n.duration=re.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in re.fx.speeds?re.fx.speeds[n.duration]:re.fx.speeds._default,null!=n.queue&&n.queue!==!0||(n.queue="fx"),n.old=n.complete,n.complete=function(){re.isFunction(n.old)&&n.old.call(this),n.queue&&re.dequeue(this,n.queue)},n},re.fn.extend({fadeTo:function(e,t,i,n){return this.filter(Ce).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var r=re.isEmptyObject(e),o=re.speed(t,i,n),a=function(){var t=U(this,re.extend({},e),o);(r||re._data(this,"finish"))&&t.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",o=re.timers,a=re._data(this);if(r)a[r]&&a[r].stop&&n(a[r]);else for(r in a)a[r]&&a[r].stop&&mt.test(r)&&n(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(i),t=!1,o.splice(r,1));!t&&i||re.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=re._data(this),n=i[e+"queue"],r=i[e+"queueHooks"],o=re.timers,a=n?n.length:0;for(i.finish=!0,re.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),re.each(["toggle","show","hide"],function(e,t){var i=re.fn[t];re.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(O(t,!0),e,n,r)}}),re.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){re.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),re.timers=[],re.fx.tick=function(){var e,t=re.timers,i=0;for(ht=re.now();i<t.length;i++)e=t[i],e()||t[i]!==e||t.splice(i--,1);t.length||re.fx.stop(),ht=void 0},re.fx.timer=function(e){re.timers.push(e),e()?re.fx.start():re.timers.pop()},re.fx.interval=13,re.fx.start=function(){pt||(pt=setInterval(re.fx.tick,re.fx.interval))},re.fx.stop=function(){clearInterval(pt),pt=null},re.fx.speeds={slow:600,fast:200,_default:400},re.fn.delay=function(e,t){return e=re.fx?re.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},function(){var e,t,i,n,r;t=pe.createElement("div"),t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=t.getElementsByTagName("a")[0],i=pe.createElement("select"),r=i.appendChild(pe.createElement("option")),e=t.getElementsByTagName("input")[0],n.style.cssText="top:1px",ie.getSetAttribute="t"!==t.className,ie.style=/top/.test(n.getAttribute("style")),ie.hrefNormalized="/a"===n.getAttribute("href"),ie.checkOn=!!e.value,ie.optSelected=r.selected,ie.enctype=!!pe.createElement("form").enctype,i.disabled=!0,ie.optDisabled=!r.disabled,e=pe.createElement("input"),e.setAttribute("value",""),ie.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),ie.radioValue="t"===e.value}();var wt=/\r/g;re.fn.extend({val:function(e){var t,i,n,r=this[0];{if(arguments.length)return n=re.isFunction(e),this.each(function(i){var r;1===this.nodeType&&(r=n?e.call(this,i,re(this).val()):e,null==r?r="":"number"==typeof r?r+="":re.isArray(r)&&(r=re.map(r,function(e){return null==e?"":e+""})),t=re.valHooks[this.type]||re.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))});if(r)return t=re.valHooks[r.type]||re.valHooks[r.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(wt,""):null==i?"":i)}}}),re.extend({valHooks:{option:{get:function(e){var t=re.find.attr(e,"value");return null!=t?t:re.trim(re.text(e))}},select:{get:function(e){for(var t,i,n=e.options,r=e.selectedIndex,o="select-one"===e.type||r<0,a=o?null:[],s=o?r+1:n.length,l=r<0?s:o?r:0;l<s;l++)if(i=n[l],(i.selected||l===r)&&(ie.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!re.nodeName(i.parentNode,"optgroup"))){if(t=re(i).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var i,n,r=e.options,o=re.makeArray(t),a=r.length;a--;)if(n=r[a],re.inArray(re.valHooks.option.get(n),o)>=0)try{n.selected=i=!0}catch(e){n.scrollHeight}else n.selected=!1;return i||(e.selectedIndex=-1),r}}}}),re.each(["radio","checkbox"],function(){re.valHooks[this]={set:function(e,t){if(re.isArray(t))return e.checked=re.inArray(re(e).val(),t)>=0}},ie.checkOn||(re.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Et,_t,kt=re.expr.attrHandle,St=/^(?:checked|selected)$/i,Tt=ie.getSetAttribute,Rt=ie.input;re.fn.extend({attr:function(e,t){return xe(this,re.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){re.removeAttr(this,e)})}}),re.extend({attr:function(e,t,i){var n,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===ke?re.prop(e,t,i):(1===o&&re.isXMLDoc(e)||(t=t.toLowerCase(),n=re.attrHooks[t]||(re.expr.match.bool.test(t)?_t:Et)),void 0===i?n&&"get"in n&&null!==(r=n.get(e,t))?r:(r=re.find.attr(e,t),null==r?void 0:r):null!==i?n&&"set"in n&&void 0!==(r=n.set(e,i,t))?r:(e.setAttribute(t,i+""),i):void re.removeAttr(e,t))},removeAttr:function(e,t){var i,n,r=0,o=t&&t.match(be);if(o&&1===e.nodeType)for(;i=o[r++];)n=re.propFix[i]||i,re.expr.match.bool.test(i)?Rt&&Tt||!St.test(i)?e[n]=!1:e[re.camelCase("default-"+i)]=e[n]=!1:re.attr(e,i,""),e.removeAttribute(Tt?i:n)},attrHooks:{type:{set:function(e,t){if(!ie.radioValue&&"radio"===t&&re.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),_t={set:function(e,t,i){return t===!1?re.removeAttr(e,i):Rt&&Tt||!St.test(i)?e.setAttribute(!Tt&&re.propFix[i]||i,i):e[re.camelCase("default-"+i)]=e[i]=!0,i}},re.each(re.expr.match.bool.source.match(/\w+/g),function(e,t){var i=kt[t]||re.find.attr;kt[t]=Rt&&Tt||!St.test(t)?function(e,t,n){var r,o;return n||(o=kt[t],kt[t]=r,r=null!=i(e,t,n)?t.toLowerCase():null,kt[t]=o),r}:function(e,t,i){if(!i)return e[re.camelCase("default-"+t)]?t.toLowerCase():null}}),Rt&&Tt||(re.attrHooks.value={set:function(e,t,i){return re.nodeName(e,"input")?void(e.defaultValue=t):Et&&Et.set(e,t,i)}}),Tt||(Et={set:function(e,t,i){var n=e.getAttributeNode(i);if(n||e.setAttributeNode(n=e.ownerDocument.createAttribute(i)),n.value=t+="","value"===i||t===e.getAttribute(i))return t}},kt.id=kt.name=kt.coords=function(e,t,i){var n;if(!i)return(n=e.getAttributeNode(t))&&""!==n.value?n.value:null},re.valHooks.button={get:function(e,t){var i=e.getAttributeNode(t);if(i&&i.specified)return i.value},set:Et.set},re.attrHooks.contenteditable={set:function(e,t,i){Et.set(e,""!==t&&t,i)}},re.each(["width","height"],function(e,t){re.attrHooks[t]={set:function(e,i){if(""===i)return e.setAttribute(t,"auto"),i}}})),ie.style||(re.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var At=/^(?:input|select|textarea|button|object)$/i,Ct=/^(?:a|area)$/i;re.fn.extend({prop:function(e,t){return xe(this,re.prop,e,t,arguments.length>1)},removeProp:function(e){return e=re.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(e){}})}}),re.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,i){var n,r,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return o=1!==a||!re.isXMLDoc(e),o&&(t=re.propFix[t]||t,r=re.propHooks[t]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:e[t]=i:r&&"get"in r&&null!==(n=r.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=re.find.attr(e,"tabindex");return t?parseInt(t,10):At.test(e.nodeName)||Ct.test(e.nodeName)&&e.href?0:-1}}}}),ie.hrefNormalized||re.each(["href","src"],function(e,t){re.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),ie.optSelected||(re.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),re.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){re.propFix[this.toLowerCase()]=this}),ie.enctype||(re.propFix.enctype="encoding");var xt=/[\t\r\n\f]/g;re.fn.extend({addClass:function(e){var t,i,n,r,o,a,s=0,l=this.length,d="string"==typeof e&&e;if(re.isFunction(e))return this.each(function(t){re(this).addClass(e.call(this,t,this.className))});if(d)for(t=(e||"").match(be)||[];s<l;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(xt," "):" ")){for(o=0;r=t[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");a=re.trim(n),i.className!==a&&(i.className=a)}return this},removeClass:function(e){var t,i,n,r,o,a,s=0,l=this.length,d=0===arguments.length||"string"==typeof e&&e;if(re.isFunction(e))return this.each(function(t){re(this).removeClass(e.call(this,t,this.className))});if(d)for(t=(e||"").match(be)||[];s<l;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(xt," "):"")){for(o=0;r=t[o++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");a=e?re.trim(n):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):re.isFunction(e)?this.each(function(i){re(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var t,n=0,r=re(this),o=e.match(be)||[];t=o[n++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else i!==ke&&"boolean"!==i||(this.className&&re._data(this,"__className__",this.className),this.className=this.className||e===!1?"":re._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(xt," ").indexOf(t)>=0)return!0;return!1}}),re.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){re.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),re.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var Lt=re.now(),Dt=/\?/,Pt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;re.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var i,n=null,r=re.trim(t+"");return r&&!re.trim(r.replace(Pt,function(e,t,r,o){return i&&t&&(n=0),0===n?e:(i=r||t,n+=!o-!r,"")}))?Function("return "+r)():re.error("Invalid JSON: "+t)},re.parseXML=function(t){var i,n;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(n=new DOMParser,i=n.parseFromString(t,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(t))}catch(e){i=void 0}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||re.error("Invalid XML: "+t),i};var It,Ot,Nt=/#.*$/,Mt=/([?&])_=[^&]*/,Ft=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ut=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Bt=/^(?:GET|HEAD)$/,jt=/^\/\//,Ht=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Gt={},qt={},Vt="*/".concat("*");try{Ot=location.href}catch(e){Ot=pe.createElement("a"),Ot.href="",Ot=Ot.href}It=Ht.exec(Ot.toLowerCase())||[],re.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ot,type:"GET",isLocal:Ut.test(It[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Vt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":re.parseJSON,"text xml":re.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?H(H(e,re.ajaxSettings),t):H(re.ajaxSettings,e)},ajaxPrefilter:B(Gt),ajaxTransport:B(qt),ajax:function(e,t){function i(e,t,i,n){var r,u,m,y,w,_=t;2!==b&&(b=2,s&&clearTimeout(s),d=void 0,a=n||"",E.readyState=e>0?4:0,r=e>=200&&e<300||304===e,i&&(y=G(c,E,i)),y=q(c,y,E,r),r?(c.ifModified&&(w=E.getResponseHeader("Last-Modified"),w&&(re.lastModified[o]=w),w=E.getResponseHeader("etag"),w&&(re.etag[o]=w)),204===e||"HEAD"===c.type?_="nocontent":304===e?_="notmodified":(_=y.state,u=y.data,m=y.error,r=!m)):(m=_,!e&&_||(_="error",e<0&&(e=0))),E.status=e,E.statusText=(t||_)+"",r?p.resolveWith(f,[u,_,E]):p.rejectWith(f,[E,_,m]),E.statusCode(v),v=void 0,l&&h.trigger(r?"ajaxSuccess":"ajaxError",[E,c,r?u:m]),g.fireWith(f,[E,_]),l&&(h.trigger("ajaxComplete",[E,c]),--re.active||re.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r,o,a,s,l,d,u,c=re.ajaxSetup({},t),f=c.context||c,h=c.context&&(f.nodeType||f.jquery)?re(f):re.event,p=re.Deferred(),g=re.Callbacks("once memory"),v=c.statusCode||{},m={},y={},b=0,w="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!u)for(u={};t=Ft.exec(a);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return b||(e=y[i]=y[i]||e,m[e]=t),this},overrideMimeType:function(e){return b||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(b<2)for(t in e)v[t]=[v[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||w;return d&&d.abort(t),i(0,t),this}};if(p.promise(E).complete=g.add,E.success=E.done,E.error=E.fail,c.url=((e||c.url||Ot)+"").replace(Nt,"").replace(jt,It[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=re.trim(c.dataType||"*").toLowerCase().match(be)||[""],null==c.crossDomain&&(n=Ht.exec(c.url.toLowerCase()),c.crossDomain=!(!n||n[1]===It[1]&&n[2]===It[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(It[3]||("http:"===It[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=re.param(c.data,c.traditional)),j(Gt,c,t,E),2===b)return E;l=re.event&&c.global,l&&0===re.active++&&re.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Bt.test(c.type),o=c.url,c.hasContent||(c.data&&(o=c.url+=(Dt.test(o)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=Mt.test(o)?o.replace(Mt,"$1_="+Lt++):o+(Dt.test(o)?"&":"?")+"_="+Lt++)),c.ifModified&&(re.lastModified[o]&&E.setRequestHeader("If-Modified-Since",re.lastModified[o]),re.etag[o]&&E.setRequestHeader("If-None-Match",re.etag[o])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",c.contentType),E.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+Vt+"; q=0.01":""):c.accepts["*"]);for(r in c.headers)E.setRequestHeader(r,c.headers[r]);if(c.beforeSend&&(c.beforeSend.call(f,E,c)===!1||2===b))return E.abort();w="abort";for(r in{success:1,error:1,complete:1})E[r](c[r]);if(d=j(qt,c,t,E)){E.readyState=1,l&&h.trigger("ajaxSend",[E,c]),c.async&&c.timeout>0&&(s=setTimeout(function(){E.abort("timeout")},c.timeout));try{b=1,d.send(m,i)}catch(e){if(!(b<2))throw e;i(-1,e)}}else i(-1,"No Transport");return E},getJSON:function(e,t,i){return re.get(e,t,i,"json")},getScript:function(e,t){return re.get(e,void 0,t,"script")}}),re.each(["get","post"],function(e,t){re[t]=function(e,i,n,r){return re.isFunction(i)&&(r=r||n,n=i,i=void 0),re.ajax({url:e,type:t,dataType:r,data:i,success:n})}}),re._evalUrl=function(e){return re.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},re.fn.extend({wrapAll:function(e){if(re.isFunction(e))return this.each(function(t){re(this).wrapAll(e.call(this,t))});if(this[0]){var t=re(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return re.isFunction(e)?this.each(function(t){re(this).wrapInner(e.call(this,t))}):this.each(function(){var t=re(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=re.isFunction(e);return this.each(function(i){re(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){re.nodeName(this,"body")||re(this).replaceWith(this.childNodes)}).end()}}),re.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!ie.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||re.css(e,"display"))},re.expr.filters.visible=function(e){return!re.expr.filters.hidden(e)};var Wt=/%20/g,$t=/\[\]$/,zt=/\r?\n/g,Kt=/^(?:submit|button|image|reset|file)$/i,Yt=/^(?:input|select|textarea|keygen)/i;re.param=function(e,t){var i,n=[],r=function(e,t){t=re.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=re.ajaxSettings&&re.ajaxSettings.traditional),re.isArray(e)||e.jquery&&!re.isPlainObject(e))re.each(e,function(){r(this.name,this.value)});else for(i in e)V(i,e[i],t,r);return n.join("&").replace(Wt,"+")},re.fn.extend({serialize:function(){return re.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=re.prop(this,"elements");return e?re.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!re(this).is(":disabled")&&Yt.test(this.nodeName)&&!Kt.test(e)&&(this.checked||!Le.test(e))}).map(function(e,t){var i=re(this).val();return null==i?null:re.isArray(i)?re.map(i,function(e){return{name:t.name,value:e.replace(zt,"\r\n")}}):{name:t.name,value:i.replace(zt,"\r\n")}}).get()}}),re.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&W()||$()}:W;var Xt=0,Jt={},Qt=re.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Jt)Jt[e](void 0,!0)}),ie.cors=!!Qt&&"withCredentials"in Qt,Qt=ie.ajax=!!Qt,Qt&&re.ajaxTransport(function(e){if(!e.crossDomain||ie.cors){var t;return{send:function(i,n){var r,o=e.xhr(),a=++Xt;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)o[r]=e.xhrFields[r];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(r in i)void 0!==i[r]&&o.setRequestHeader(r,i[r]+"");o.send(e.hasContent&&e.data||null),t=function(i,r){var s,l,d;if(t&&(r||4===o.readyState))if(delete Jt[a],t=void 0,o.onreadystatechange=re.noop,r)4!==o.readyState&&o.abort();else{d={},s=o.status,"string"==typeof o.responseText&&(d.text=o.responseText);try{l=o.statusText}catch(e){l=""}s||!e.isLocal||e.crossDomain?1223===s&&(s=204):s=d.text?200:404}d&&n(s,l,d,o.getAllResponseHeaders())},e.async?4===o.readyState?setTimeout(t):o.onreadystatechange=Jt[a]=t:t()},abort:function(){t&&t(void 0,!0)}}}}),re.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return re.globalEval(e),e}}}),re.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),re.ajaxTransport("script",function(e){if(e.crossDomain){var t,i=pe.head||re("head")[0]||pe.documentElement;return{send:function(n,r){t=pe.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,i){(i||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,i||r(200,"success"))},i.insertBefore(t,i.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var Zt=[],ei=/(=)\?(?=&|$)|\?\?/;re.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Zt.pop()||re.expando+"_"+Lt++;return this[e]=!0,e}}),re.ajaxPrefilter("json jsonp",function(t,i,n){var r,o,a,s=t.jsonp!==!1&&(ei.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ei.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=re.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(ei,"$1"+r):t.jsonp!==!1&&(t.url+=(Dt.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||re.error(r+" was not called"),a[0]},t.dataTypes[0]="json",o=e[r],e[r]=function(){a=arguments},n.always(function(){e[r]=o,t[r]&&(t.jsonpCallback=i.jsonpCallback,Zt.push(r)),a&&re.isFunction(o)&&o(a[0]),a=o=void 0}),"script"}),re.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||pe;var n=ce.exec(e),r=!i&&[];return n?[t.createElement(n[1])]:(n=re.buildFragment([e],t,r),r&&r.length&&re(r).remove(),re.merge([],n.childNodes))};var ti=re.fn.load;re.fn.load=function(e,t,i){if("string"!=typeof e&&ti)return ti.apply(this,arguments);var n,r,o,a=this,s=e.indexOf(" ");return s>=0&&(n=re.trim(e.slice(s,e.length)),e=e.slice(0,s)),re.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(o="POST"),a.length>0&&re.ajax({url:e,type:o,dataType:"html",data:t}).done(function(e){r=arguments,a.html(n?re("<div>").append(re.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){a.each(i,r||[e.responseText,t,e])}),this},re.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){re.fn[t]=function(e){return this.on(t,e)}}),re.expr.filters.animated=function(e){return re.grep(re.timers,function(t){return e===t.elem}).length};var ii=e.document.documentElement;re.offset={setOffset:function(e,t,i){var n,r,o,a,s,l,d,u=re.css(e,"position"),c=re(e),f={};"static"===u&&(e.style.position="relative"),s=c.offset(),o=re.css(e,"top"),l=re.css(e,"left"),d=("absolute"===u||"fixed"===u)&&re.inArray("auto",[o,l])>-1,d?(n=c.position(),a=n.top,r=n.left):(a=parseFloat(o)||0,r=parseFloat(l)||0),re.isFunction(t)&&(t=t.call(e,i,s)),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+r),"using"in t?t.using.call(e,f):c.css(f)}},re.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){re.offset.setOffset(this,e,t)});var t,i,n={top:0,left:0},r=this[0],o=r&&r.ownerDocument;if(o)return t=o.documentElement,re.contains(t,r)?(typeof r.getBoundingClientRect!==ke&&(n=r.getBoundingClientRect()),i=z(o),{top:n.top+(i.pageYOffset||t.scrollTop)-(t.clientTop||0),left:n.left+(i.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):n},position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===re.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),re.nodeName(e[0],"html")||(i=e.offset()),i.top+=re.css(e[0],"borderTopWidth",!0),i.left+=re.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-re.css(n,"marginTop",!0),left:t.left-i.left-re.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||ii;e&&!re.nodeName(e,"html")&&"static"===re.css(e,"position");)e=e.offsetParent;return e||ii})}}),re.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var i=/Y/.test(t);re.fn[e]=function(n){return xe(this,function(e,n,r){var o=z(e);return void 0===r?o?t in o?o[t]:o.document.documentElement[n]:e[n]:void(o?o.scrollTo(i?re(o).scrollLeft():r,i?r:re(o).scrollTop()):e[n]=r)},e,n,arguments.length,null)}}),re.each(["top","left"],function(e,t){re.cssHooks[t]=R(ie.pixelPosition,function(e,i){if(i)return i=tt(e,t),nt.test(i)?re(e).position()[t]+"px":i})}),re.each({Height:"height",Width:"width"},function(e,t){re.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){re.fn[n]=function(n,r){var o=arguments.length&&(i||"boolean"!=typeof n),a=i||(n===!0||r===!0?"margin":"border");return xe(this,function(t,i,n){var r;return re.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,
Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===n?re.css(t,i,a):re.style(t,i,n,a)},t,o?n:void 0,o,null)}})}),re.fn.size=function(){return this.length},re.fn.andSelf=re.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return re});var ni=e.jQuery,ri=e.$;return re.noConflict=function(t){return e.$===re&&(e.$=ri),t&&e.jQuery===re&&(e.jQuery=ni),re},typeof t===ke&&(e.jQuery=e.$=re),re}),function(e,t,i){function n(i){var n=t.console;o[i]||(o[i]=!0,e.migrateWarnings.push(i),n&&n.warn&&!e.migrateMute&&(n.warn("JQMIGRATE: "+i),e.migrateTrace&&n.trace&&n.trace()))}function r(t,i,r,o){if(Object.defineProperty)try{return void Object.defineProperty(t,i,{configurable:!0,enumerable:!0,get:function(){return n(o),r},set:function(e){n(o),r=e}})}catch(e){}e._definePropertyBroken=!0,t[i]=r}var o={};e.migrateWarnings=[],!e.migrateMute&&t.console&&t.console.log&&t.console.log("JQMIGRATE: Logging is active"),e.migrateTrace===i&&(e.migrateTrace=!0),e.migrateReset=function(){o={},e.migrateWarnings.length=0},"BackCompat"===document.compatMode&&n("jQuery is not compatible with Quirks Mode");var a=e("<input/>",{size:1}).attr("size")&&e.attrFn,s=e.attr,l=e.attrHooks.value&&e.attrHooks.value.get||function(){return null},d=e.attrHooks.value&&e.attrHooks.value.set||function(){return i},u=/^(?:input|button)$/i,c=/^[238]$/,f=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,h=/^(?:checked|selected)$/i;r(e,"attrFn",a||{},"jQuery.attrFn is deprecated"),e.attr=function(t,r,o,l){var d=r.toLowerCase(),p=t&&t.nodeType;return l&&(s.length<4&&n("jQuery.fn.attr( props, pass ) is deprecated"),t&&!c.test(p)&&(a?r in a:e.isFunction(e.fn[r])))?e(t)[r](o):("type"===r&&o!==i&&u.test(t.nodeName)&&t.parentNode&&n("Can't change the 'type' of an input or button in IE 6/7/8"),!e.attrHooks[d]&&f.test(d)&&(e.attrHooks[d]={get:function(t,n){var r,o=e.prop(t,n);return o===!0||"boolean"!=typeof o&&(r=t.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():i},set:function(t,i,n){var r;return i===!1?e.removeAttr(t,n):(r=e.propFix[n]||n,r in t&&(t[r]=!0),t.setAttribute(n,n.toLowerCase())),n}},h.test(d)&&n("jQuery.fn.attr('"+d+"') may use property instead of attribute")),s.call(e,t,r,o))},e.attrHooks.value={get:function(e,t){var i=(e.nodeName||"").toLowerCase();return"button"===i?l.apply(this,arguments):("input"!==i&&"option"!==i&&n("jQuery.fn.attr('value') no longer gets properties"),t in e?e.value:null)},set:function(e,t){var i=(e.nodeName||"").toLowerCase();return"button"===i?d.apply(this,arguments):("input"!==i&&"option"!==i&&n("jQuery.fn.attr('value', val) no longer sets properties"),void(e.value=t))}};var p,g,v=e.fn.init,m=e.parseJSON,y=/^([^<]*)(<[\w\W]+>)([^>]*)$/;e.fn.init=function(t,i,r){var o;return t&&"string"==typeof t&&!e.isPlainObject(i)&&(o=y.exec(e.trim(t)))&&o[0]&&("<"!==t.charAt(0)&&n("$(html) HTML strings must start with '<' character"),o[3]&&n("$(html) HTML text after last tag is ignored"),"#"===o[0].charAt(0)&&(n("HTML string cannot start with a '#' character"),e.error("JQMIGRATE: Invalid selector string (XSS)")),i&&i.context&&(i=i.context),e.parseHTML)?v.call(this,e.parseHTML(o[2],i,!0),i,r):v.apply(this,arguments)},e.fn.init.prototype=e.fn,e.parseJSON=function(e){return e||null===e?m.apply(this,arguments):(n("jQuery.parseJSON requires a valid JSON string"),null)},e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e.browser||(p=e.uaMatch(navigator.userAgent),g={},p.browser&&(g[p.browser]=!0,g.version=p.version),g.chrome?g.webkit=!0:g.webkit&&(g.safari=!0),e.browser=g),r(e,"browser",e.browser,"jQuery.browser is deprecated"),e.sub=function(){function t(e,i){return new t.fn.init(e,i)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(n,r){return r&&r instanceof e&&!(r instanceof t)&&(r=t(r)),e.fn.init.call(this,n,r,i)},t.fn.init.prototype=t.fn;var i=t(document);return n("jQuery.sub() is deprecated"),t},e.ajaxSetup({converters:{"text json":e.parseJSON}});var b=e.fn.data;e.fn.data=function(t){var r,o,a=this[0];return!a||"events"!==t||1!==arguments.length||(r=e.data(a,t),o=e._data(a,t),r!==i&&r!==o||o===i)?b.apply(this,arguments):(n("Use of jQuery.fn.data('events') is deprecated"),o)};var w=/\/(java|ecma)script/i,E=e.fn.andSelf||e.fn.addBack;e.fn.andSelf=function(){return n("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),E.apply(this,arguments)},e.clean||(e.clean=function(t,i,r,o){i=i||document,i=!i.nodeType&&i[0]||i,i=i.ownerDocument||i,n("jQuery.clean() is deprecated");var a,s,l,d,u=[];if(e.merge(u,e.buildFragment(t,i).childNodes),r)for(l=function(e){if(!e.type||w.test(e.type))return o?o.push(e.parentNode?e.parentNode.removeChild(e):e):r.appendChild(e)},a=0;null!=(s=u[a]);a++)e.nodeName(s,"script")&&l(s)||(r.appendChild(s),"undefined"!=typeof s.getElementsByTagName&&(d=e.grep(e.merge([],s.getElementsByTagName("script")),l),u.splice.apply(u,[a+1,0].concat(d)),a+=d.length));return u});var _=e.event.add,k=e.event.remove,S=e.event.trigger,T=e.fn.toggle,R=e.fn.live,A=e.fn.die,C="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",x=new RegExp("\\b(?:"+C+")\\b"),L=/(?:^|\s)hover(\.\S+|)\b/,D=function(t){return"string"!=typeof t||e.event.special.hover?t:(L.test(t)&&n("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),t&&t.replace(L,"mouseenter$1 mouseleave$1"))};e.event.props&&"attrChange"!==e.event.props[0]&&e.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),e.event.dispatch&&r(e.event,"handle",e.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),e.event.add=function(e,t,i,r,o){e!==document&&x.test(t)&&n("AJAX events should be attached to document: "+t),_.call(this,e,D(t||""),i,r,o)},e.event.remove=function(e,t,i,n,r){k.call(this,e,D(t)||"",i,n,r)},e.fn.error=function(){var e=Array.prototype.slice.call(arguments,0);return n("jQuery.fn.error() is deprecated"),e.splice(0,0,"error"),arguments.length?this.bind.apply(this,e):(this.triggerHandler.apply(this,e),this)},e.fn.toggle=function(t,i){if(!e.isFunction(t)||!e.isFunction(i))return T.apply(this,arguments);n("jQuery.fn.toggle(handler, handler...) is deprecated");var r=arguments,o=t.guid||e.guid++,a=0,s=function(i){var n=(e._data(this,"lastToggle"+t.guid)||0)%a;return e._data(this,"lastToggle"+t.guid,n+1),i.preventDefault(),r[n].apply(this,arguments)||!1};for(s.guid=o;a<r.length;)r[a++].guid=o;return this.click(s)},e.fn.live=function(t,i,r){return n("jQuery.fn.live() is deprecated"),R?R.apply(this,arguments):(e(this.context).on(t,this.selector,i,r),this)},e.fn.die=function(t,i){return n("jQuery.fn.die() is deprecated"),A?A.apply(this,arguments):(e(this.context).off(t,this.selector||"**",i),this)},e.event.trigger=function(e,t,i,r){return i||x.test(e)||n("Global events are undocumented and deprecated"),S.call(this,e,t,i||document,r)},e.each(C.split("|"),function(t,i){e.event.special[i]={setup:function(){var t=this;return t!==document&&(e.event.add(document,i+"."+e.guid,function(){e.event.trigger(i,null,t,!0)}),e._data(this,i,e.guid++)),!1},teardown:function(){return this!==document&&e.event.remove(document,i+"."+e._data(this,i)),!1}}})}(jQuery,window),define("libs/jquery-with-jquery-migrate",function(){}),define("jquery",["libs/jquery-with-jquery-migrate"],function(){return jQuery}),function(){"use strict";var e=null,t=function(e,t){return!0};define("version",{version:"1.0",load:function(i,n,r,o){var a,s,l=o.config.version;if(!l)throw new Error("A version config has not been setup");if(!l[i])throw new Error("A version was not specified for module: "+i);if(e&&(s=l[i],!t(s,e)))throw new Error('An incompatiable version of "'+i+'" was loaded. "'+s+'" was loaded, but "'+e+'" is required.');a=i+"-"+o.config.version[i],n([a],function(e){r(e)})},normalize:function(t){var i=/\(([^)]*)\)/.exec(t);return e=null,i&&(e=i[1],t=t.substring(0,i.index)),t}})}(),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("mpx/libs/hls-0.6.18",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Hls=e()}}(function(){var e;return function e(t,i,n){function r(a,s){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[a]={exports:{}};t[a][0].call(u.exports,function(e){var i=t[a][1][e];return r(i?i:e)},u,u.exports,e,t,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t,i){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,o,l,d;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(i=this._events[e],s(i))return!1;if(r(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),i.apply(this,o)}else if(a(i))for(o=Array.prototype.slice.call(arguments,1),d=i.slice(),n=d.length,l=0;l<n;l++)d[l].apply(this,o);return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var i,n,o,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],o=i.length,n=-1,i===t||r(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(i)){for(s=o;s-- >0;)if(i[s]===t||i[s].listener&&i[s].listener===t){n=s;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],r(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(t,i,n){!function(t){var r={buildAbsoluteURL:function(e,t){if(t=t.trim(),/^[a-z]+:/i.test(t))return t;var i=null,n=null,o=/^([^#]*)(.*)$/.exec(t);o&&(n=o[2],t=o[1]);var a=/^([^\?]*)(.*)$/.exec(t);a&&(i=a[2],t=a[1]);var s=/^([^#]*)(.*)$/.exec(e);s&&(e=s[1]);var l=/^([^\?]*)(.*)$/.exec(e);l&&(e=l[1]);var d=/^(([a-z]+:)?\/\/[a-z0-9\.\-_~]+(:[0-9]+)?)?(\/.*)$/i.exec(e);if(!d)throw new Error("Error trying to parse base URL.");var u=d[2]||"",c=d[1]||"",f=d[4],h=null;return h=/^\/\//.test(t)?u+"//"+r.buildAbsolutePath("",t.substring(2)):/^\//.test(t)?c+"/"+r.buildAbsolutePath("",t.substring(1)):r.buildAbsolutePath(c+f,t),i&&(h+=i),n&&(h+=n),h},buildAbsolutePath:function(e,t){for(var i,n,r=t,o="",a=e.replace(/[^\/]*$/,r.replace(/(\/|^)(?:\.?\/+)+/g,"$1")),s=0;n=a.indexOf("/../",s),n>-1;s=n+i)i=/^\/(?:\.\.\/)*/.exec(a.slice(n))[0].length,o=(o+a.substring(s,n)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(i-1)/3+"}$"),"/");return o+a.substr(s)}};"object"==typeof n&&"object"==typeof i?i.exports=r:"function"==typeof e&&e.amd?e([],function(){return r}):"object"==typeof n?n.URLToolkit=r:t.URLToolkit=r}(this)},{}],3:[function(e,t,i){var n=arguments[3],r=arguments[4],o=arguments[5],a=JSON.stringify;t.exports=function(e,t){function i(e){v[e]=!0;for(var t in r[e][1]){var n=r[e][1][t];v[n]||i(n)}}for(var s,l=Object.keys(o),d=0,u=l.length;d<u;d++){var c=l[d],f=o[c].exports;if(f===e||f&&f.default===e){s=c;break}}if(!s){s=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var h={},d=0,u=l.length;d<u;d++){var c=l[d];h[c]=c}r[s]=[Function(["require","module","exports"],"("+e+")(self)"),h]}var p=Math.floor(Math.pow(16,8)*Math.random()).toString(16),g={};g[s]=s,r[p]=[Function(["require"],"var f = require("+a(s)+");(f.default ? f.default : f)(self);"),g];var v={};i(p);var m="("+n+")({"+Object.keys(v).map(function(e){return a(e)+":["+r[e][0]+","+a(r[e][1])+"]"}).join(",")+"},{},["+a(p)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,b=new Blob([m],{type:"text/javascript"});if(t&&t.bare)return b;var w=y.createObjectURL(b),E=new Worker(w);return E.objectURL=w,E}},{}],4:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(28),d=n(l),u=e(27),c=n(u),f=e(30),h=n(f),p=e(26),g=e(45),v=e(9),m=n(v),y=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.FRAG_LOADING,d.default.FRAG_LOADED,d.default.FRAG_BUFFERED,d.default.ERROR));return i.lastLoadedFragLevel=0,i._autoLevelCapping=-1,i._nextAutoLevel=-1,i.hls=e,i.onCheck=i.abandonRulesCheck.bind(i),i}return a(t,e),s(t,[{key:"destroy",value:function(){this.clearTimer(),c.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this.bwEstimator){var i=this.hls,n=e.frag.level,r=i.levels[n].details.live,o=i.config,a=void 0,s=void 0;r?(a=o.abrEwmaFastLive,s=o.abrEwmaSlowLive):(a=o.abrEwmaFastVoD,s=o.abrEwmaSlowVoD),this.bwEstimator=new m.default(i,s,a,o.abrEwmaDefaultEstimate)}this.fragCurrent=t}}},{key:"abandonRulesCheck",value:function(){var e=this.hls,t=e.media,i=this.fragCurrent,n=i.loader,r=this.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return g.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var o=n.stats;if(t&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&i.autoLevel&&i.level){var a=performance.now()-o.trequest,s=Math.abs(t.playbackRate);if(a>500*i.duration/s){var l=e.levels,u=Math.max(1,o.bw?o.bw/8:1e3*o.loaded/a),c=o.total?o.total:Math.max(o.loaded,Math.round(i.duration*l[i.level].bitrate/8)),f=t.currentTime,p=(c-o.loaded)/u,v=(h.default.bufferInfo(t,f,e.config.maxBufferHole).end-f)/s;if(v<2*i.duration/s&&p>v){var m=void 0,y=void 0;for(y=i.level-1;y>r&&(m=i.duration*l[y].bitrate/(6.4*u),!(m<v));y--);m<p&&(g.logger.warn("loading too slow, abort fragment loading and switch to level "+y+":fragLoadedDelay["+y+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+m.toFixed(1)+"<"+p.toFixed(1)+":"+v.toFixed(1)),e.nextLoadLevel=y,this.bwEstimator.sample(a,o.loaded),n.abort(),this.clearTimer(),e.trigger(d.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:o}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if("main"===t.type&&(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,e.frag.bitrateTest)){var i=e.stats;i.tparsed=i.tbuffered=i.tload,this.onFragBuffered(e)}}},{key:"onFragBuffered",value:function(e){var t=e.stats,i=e.frag;if(t.aborted!==!0&&1===i.loadCounter&&"main"===i.type&&(!i.bitrateTest||t.tload===t.tbuffered)){var n=t.tparsed-t.trequest;g.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this.bwEstimator.sample(n,t.loaded),i.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(e){switch(e.details){case p.ErrorDetails.FRAG_LOAD_ERROR:case p.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"findBestLevel",value:function(e,t,i,n,r,o,a,s,l){for(var d=r;d>=n;d--){var u=l[d],c=u.details,f=c?c.totalduration/c.fragments.length:t,h=!!c&&c.live,p=void 0;p=d<=e?a*i:s*i;var v=l[d].bitrate,m=v*f/p;if(g.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+d+"/"+Math.round(p)+"/"+v+"/"+f+"/"+o+"/"+m),p>v&&(!m||h||m<o))return d}return-1}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping=e}},{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this.bwEstimator,i=this.hls,n=i.levels,r=i.config.minAutoBitrate;if(!(e===-1||t&&t.canEstimate()))return Math.min(e,this.maxAutoLevel);var o=this.nextABRAutoLevel;if(e!==-1&&(o=Math.min(e,o)),void 0!==r)for(;n[o].bitrate<r;)o++;return o},set:function(e){this._nextAutoLevel=e}},{key:"minAutoLevel",get:function(){for(var e=this.hls,t=e.levels,i=e.config.minAutoBitrate,n=t?t.length:0,r=0;r<n;r++)if(t[r].bitrate>i)return r;return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.hls.levels,i=this._autoLevelCapping;return e=i===-1&&t&&t.length?t.length-1:i}},{key:"nextABRAutoLevel",get:function(){var e=this.hls,t=this.maxAutoLevel,i=e.levels,n=e.config,r=this.minAutoLevel,o=e.media,a=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=o?o.currentTime:0,d=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,u=this.bwEstimator?this.bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,c=(h.default.bufferInfo(o,l,n.maxBufferHole).end-l)/d,f=this.findBestLevel(a,s,u,r,t,c,n.abrBandWidthFactor,n.abrBandWidthUpFactor,i);if(f>=0)return f;g.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=n.maxStarvationDelay,v=n.abrBandWidthFactor,m=n.abrBandWidthUpFactor;if(0===c){var y=this.bitrateTestDelay;y&&(p=n.maxLoadingDelay-y,g.logger.trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),v=m=1)}return f=this.findBestLevel(a,s,u,r,t,c+p,v,m,i),Math.max(f,0)}}]),t}(c.default);i.default=y},{26:26,27:27,28:28,30:30,45:45,9:9}],5:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e(41),u=n(d),c=e(30),f=n(c),h=e(22),p=n(h),g=e(28),v=n(g),m=e(27),y=n(m),b=e(31),w=n(b),E=e(46),_=n(E),k=e(26),S=e(45),T={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},R=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,v.default.MEDIA_ATTACHED,v.default.MEDIA_DETACHING,v.default.AUDIO_TRACKS_UPDATED,v.default.AUDIO_TRACK_SWITCHING,v.default.AUDIO_TRACK_LOADED,v.default.KEY_LOADED,v.default.FRAG_LOADED,v.default.FRAG_PARSING_INIT_SEGMENT,v.default.FRAG_PARSING_DATA,v.default.FRAG_PARSED,v.default.ERROR,v.default.BUFFER_CREATED,v.default.BUFFER_APPENDED,v.default.BUFFER_FLUSHED,v.default.INIT_PTS_FOUND));return i.config=e.config,i.audioCodecSwap=!1,i.ticks=0,i.ontick=i.tick.bind(i),i.initPTS=[],i.waitingFragment=null,i}return a(t,e),l(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),y.default.prototype.destroy.call(this),this.state=T.STOPPED}},{key:"onInitPtsFound",value:function(e){var t=e.id,i=e.cc,n=e.initPTS;"main"===t&&(this.initPTS[i]=n,S.logger.log("InitPTS for cc:"+i+" found from video track:"+n),this.state===T.WAITING_INIT_PTS&&(S.logger.log("sending pending audio frag to demuxer"),this.state=T.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null))}},{key:"startLoad",value:function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.fragLoadError=0,t>0&&e===-1?(S.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=T.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=T.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=T.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=T.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var e,t,i,n,r,o,a=this,l=this.hls,d=l.config,c=function(){switch(a.state){case T.ERROR:case T.PAUSED:case T.BUFFER_FLUSHING:break;case T.STARTING:a.state=T.WAITING_TRACK,a.loadedmetadata=!1;break;case T.IDLE:if(!a.media&&(a.startFragRequested||!d.startFragPrefetch))break;e=a.loadedmetadata?a.media.currentTime:a.nextLoadPosition;var s=a.mediaBuffer?a.mediaBuffer:a.media,c=f.default.bufferInfo(s,e,d.maxBufferHole),h=c.len,p=c.end,g=a.fragPrevious,m=d.maxMaxBufferLength,y=a.audioSwitch;if(h<m&&a.trackId<a.tracks.length){if(i=a.tracks[a.trackId].details,"undefined"==typeof i){a.state=T.WAITING_TRACK;break}if(!y&&!i.live&&g&&g.sn===i.endSN&&(!a.media.seeking||a.media.duration-p<g.duration/2)){a.hls.trigger(v.default.BUFFER_EOS,{type:"audio"}),a.state=T.ENDED;break}var b=i.fragments,w=b.length,E=b[0].start,_=b[w-1].start+b[w-1].duration,R=void 0;if(y)if(i.live&&!i.PTSKnown)S.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),p=0;else if(p=e,i.PTSKnown&&e<E){if(!(c.end>E||c.nextStart))return{v:void 0};S.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),a.media.currentTime=E+.05}if(p<E?R=b[0]:!function(){var e=void 0,t=d.maxFragLookUpTolerance;p<_?(p>_-t&&(t=0),e=u.default.search(b,function(e){return e.start+e.duration-t<=p?1:e.start-t>p?-1:0})):e=b[w-1],e&&(R=e,E=e.start,g&&R.level===g.level&&R.sn===g.sn&&(R.sn<i.endSN?(R=b[R.sn+1-i.startSN],S.logger.log("SN just loaded, load next one: "+R.sn)):R=null))}(),R)if(null!=R.decryptdata.uri&&null==R.decryptdata.key)S.logger.log("Loading key for "+R.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+a.trackId),a.state=T.KEY_LOADING,l.trigger(v.default.KEY_LOADING,{frag:R});else{if(S.logger.log("Loading "+R.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+a.trackId+", currentTime:"+e+",bufferEnd:"+p.toFixed(3)),void 0!==a.fragLoadIdx?a.fragLoadIdx++:a.fragLoadIdx=0,R.loadCounter){R.loadCounter++;var A=d.fragLoadingLoopThreshold;if(R.loadCounter>A&&Math.abs(a.fragLoadIdx-R.loadIdx)<A)return l.trigger(v.default.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:R}),{v:void 0}}else R.loadCounter=1;R.loadIdx=a.fragLoadIdx,a.fragCurrent=R,a.startFragRequested=!0,a.nextLoadPosition=R.start+R.duration,l.trigger(v.default.FRAG_LOADING,{frag:R}),a.state=T.FRAG_LOADING}}break;case T.WAITING_TRACK:t=a.tracks[a.trackId],t&&t.details&&(a.state=T.IDLE);break;case T.FRAG_LOADING_WAITING_RETRY:n=performance.now(),r=a.retryDate,s=a.media,o=s&&s.seeking,(!r||n>=r||o)&&(S.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),a.state=T.IDLE);break;case T.WAITING_INIT_PTS:case T.STOPPED:case T.FRAG_LOADING:case T.PARSING:case T.PARSED:case T.ENDED:}}();if("object"===("undefined"==typeof c?"undefined":s(c)))return c.v}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var i=this.config;this.tracks&&i.autoStartLoad&&this.startLoad(i.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(S.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.tracks;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){this.state===T.ENDED&&(this.state=T.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaEnded",value:function(){this.startPosition=this.lastCurrentTime=0}},{key:"onAudioTracksUpdated",value:function(e){S.logger.log("audio tracks updated"),this.tracks=e.audioTracks}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url;this.trackId=e.id,this.state=T.IDLE,this.fragCurrent=null,this.state=T.PAUSED,this.waitingFragment=null,t?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=T.IDLE,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onAudioTrackLoaded",value:function(e){var t=e.details,i=e.id,n=this.tracks[i],r=t.totalduration,o=0;if(S.logger.log("track "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+r),t.live){var a=n.details;a&&t.fragments.length>0?(w.default.mergeDetails(a,t),o=t.fragments[0].start,t.PTSKnown?S.logger.log("live audio playlist sliding:"+o.toFixed(3)):S.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,S.logger.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,!this.startFragRequested){if(this.startPosition===-1){var s=t.startTimeOffset;isNaN(s)?this.startPosition=0:(S.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s)}this.nextLoadPosition=this.startPosition}this.state===T.WAITING_TRACK&&(this.state=T.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===T.KEY_LOADING&&(this.state=T.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent;if(this.state===T.FRAG_LOADING&&t&&"audio"===e.frag.type&&e.frag.level===t.level&&e.frag.sn===t.sn){this.state=T.PARSING,this.stats=e.stats;var i=this.tracks[this.trackId],n=i.details,r=n.totalduration,o=t.start,a=t.level,s=t.sn,l=t.cc,d=this.config.defaultAudioCodec||i.audioCodec;this.appended=!1,this.demuxer||(this.demuxer=new p.default(this.hls,"audio"));var u=this.initPTS[l];if(void 0!==u){this.pendingBuffering=!0,S.logger.log("Demuxing "+s+" of ["+n.startSN+" ,"+n.endSN+"],track "+a);var c=!1;this.demuxer.push(e.payload,d,null,o,l,a,s,r,t.decryptdata,c,u)}else S.logger.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+s+" of ["+n.startSN+" ,"+n.endSN+"],track "+a),this.waitingFragment=e,this.state=T.WAITING_INIT_PTS}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent;if(t&&"audio"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===T.PARSING){var i=e.tracks,n=void 0;if(i.video&&delete i.video,n=i.audio){n.levelCodec="mp4a.40.2",n.id=e.id,this.hls.trigger(v.default.BUFFER_CODECS,i),S.logger.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var r=n.initSegment;if(r){var o={type:"audio",data:r,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[o]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(v.default.BUFFER_APPENDING,o))}this.tick()}}}},{key:"onFragParsingData",value:function(e){var t=this,i=this.fragCurrent;i&&"audio"===e.id&&"audio"===e.type&&e.sn===i.sn&&e.level===i.level&&this.state===T.PARSING&&!function(){var i=t.trackId,n=t.tracks[i],r=t.fragCurrent,o=t.hls;S.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),w.default.updateFragPTSDTS(n.details,r.sn,e.startPTS,e.endPTS);var a=t.audioSwitch,s=t.media,l=!1;if(a&&s)if(s.readyState){var d=s.currentTime;S.logger.log("switching audio track : currentTime:"+d),d>=e.startPTS&&(S.logger.log("switching audio track : flushing all audio"),
t.state=T.BUFFER_FLUSHING,o.trigger(v.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),l=!0,t.audioSwitch=!1,o.trigger(v.default.AUDIO_TRACK_SWITCHED,{id:i}))}else t.audioSwitch=!1,o.trigger(v.default.AUDIO_TRACK_SWITCHED,{id:i});var u=t.pendingData;t.audioSwitch||([e.data1,e.data2].forEach(function(t){t&&u.push({type:e.type,data:t,parent:"audio",content:"data"})}),!l&&u.length&&(u.forEach(function(e){t.pendingBuffering=!0,t.hls.trigger(v.default.BUFFER_APPENDING,e)}),t.pendingData=[],t.appended=!0)),t.tick()}()}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent;t&&"audio"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===T.PARSING&&(this.stats.tparsed=performance.now(),this.state=T.PARSED,this._checkAppendedParsed())}},{key:"onBufferCreated",value:function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0)}},{key:"onBufferAppended",value:function(e){if("audio"===e.parent){var t=this.state;t!==T.PARSING&&t!==T.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==T.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,i=this.hls;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),i.trigger(v.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;S.logger.log("audio buffered : "+_.default.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(v.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=T.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case k.ErrorDetails.FRAG_LOAD_ERROR:case k.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var n=this.config;if(i<=n.fragLoadingMaxRetry){this.fragLoadError=i,t.loadCounter=0;var r=Math.min(Math.pow(2,i-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);S.logger.warn("audioStreamController: frag loading failed, retry in "+r+" ms"),this.retryDate=performance.now()+r,this.state=T.FRAG_LOADING_WAITING_RETRY}else S.logger.error("audioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.trigger(v.default.ERROR,e),this.state=T.ERROR}break;case k.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case k.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case k.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case k.ErrorDetails.KEY_LOAD_ERROR:case k.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==T.ERROR&&(this.state=e.fatal?T.ERROR:T.IDLE,S.logger.warn("audioStreamController: "+e.details+" while loading frag,switch to "+this.state+" state ..."))}}},{key:"onBufferFlushed",value:function(){var e=this,t=this.pendingData;t&&t.length?(S.logger.log("appending pending audio data on Buffer Flushed"),t.forEach(function(t){e.hls.trigger(v.default.BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=T.PARSED):(this.state=T.IDLE,this.fragPrevious=null,this.tick())}}]),t}(y.default);i.default=R},{22:22,26:26,27:27,28:28,30:30,31:31,41:41,45:45,46:46}],6:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(28),d=n(l),u=e(27),c=n(u),f=e(45),h=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.MANIFEST_LOADING,d.default.MANIFEST_LOADED,d.default.AUDIO_TRACK_LOADED));return i.ticks=0,i.ontick=i.tick.bind(i),i}return a(t,e),s(t,[{key:"destroy",value:function(){c.default.prototype.destroy.call(this)}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){this.updateTrack(this.trackId)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(e){var t=this,i=e.audioTracks||[],n=!1;this.tracks=i,this.hls.trigger(d.default.AUDIO_TRACKS_UPDATED,{audioTracks:i});var r=0;i.forEach(function(e){return e.default?(t.audioTrack=r,void(n=!0)):void r++}),n===!1&&i.length&&(f.logger.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)}},{key:"onAudioTrackLoaded",value:function(e){e.id<this.tracks.length&&(f.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*e.details.targetduration)),!e.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))}},{key:"setAudioTrackInternal",value:function(e){if(e>=0&&e<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=e,f.logger.log("switching to audioTrack "+e);var t=this.tracks[e],i=this.hls,n=t.type,r=t.url,o={id:e,type:n,url:r};i.trigger(d.default.AUDIO_TRACK_SWITCH,o),i.trigger(d.default.AUDIO_TRACK_SWITCHING,o);var a=t.details;!r||void 0!==a&&a.live!==!0||(f.logger.log("(re)loading playlist for audioTrack "+e),i.trigger(d.default.AUDIO_TRACK_LOADING,{url:r,id:e}))}}},{key:"updateTrack",value:function(e){if(e>=0&&e<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=e,f.logger.log("updating audioTrack "+e);var t=this.tracks[e],i=t.url,n=t.details;!i||void 0!==n&&n.live!==!0||(f.logger.log("(re)loading playlist for audioTrack "+e),this.hls.trigger(d.default.AUDIO_TRACK_LOADING,{url:i,id:e}))}}},{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.trackId===e&&void 0!==this.tracks[e].details||this.setAudioTrackInternal(e)}}]),t}(c.default);i.default=h},{27:27,28:28,45:45}],7:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(28),d=n(l),u=e(27),c=n(u),f=e(45),h=e(26),p=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.MEDIA_ATTACHING,d.default.MEDIA_DETACHING,d.default.MANIFEST_PARSED,d.default.BUFFER_RESET,d.default.BUFFER_APPENDING,d.default.BUFFER_CODECS,d.default.BUFFER_EOS,d.default.BUFFER_FLUSHING,d.default.LEVEL_PTS_UPDATED,d.default.LEVEL_UPDATED));return i._msDuration=null,i._levelDuration=null,i.onsbue=i.onSBUpdateEnd.bind(i),i.onsbe=i.onSBUpdateError.bind(i),i.pendingTracks={},i.tracks={},i}return a(t,e),s(t,[{key:"destroy",value:function(){c.default.prototype.destroy.call(this)}},{key:"onLevelPtsUpdated",value:function(e){var t=e.type,i=this.tracks.audio;if("audio"===t&&i&&"audio/mpeg"===i.container){var n=this.sourceBuffer.audio,r=Math.abs(n.timestampOffset-e.start);if(r>.1){var o=n.updating;try{n.abort()}catch(e){o=!0,f.logger.warn("can not abort audio buffer: "+e)}o?this.audioTimestampOffset=e.start:(f.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}}},{key:"onManifestParsed",value:function(e){var t=e.audio,i=e.video,n=0;e.altAudio&&(t||i)&&(n=(t?1:0)+(i?1:0),f.logger.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var i=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),i.addEventListener("sourceopen",this.onmso),i.addEventListener("sourceended",this.onmse),i.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(i)}}},{key:"onMediaDetaching",value:function(){f.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){f.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(d.default.MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){f.logger.log("media source opened"),this.hls.trigger(d.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){f.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){f.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;f.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,i=this.segments.reduce(function(e,i){return i.parent===t?e+1:e},0);this.hls.trigger(d.default.BUFFER_APPENDED,{parent:t,pending:i}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(e){f.logger.error("sourceBuffer error:"+e),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;for(var t in e){var i=e[t];try{this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this.onsbue),i.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var i=this.mediaSource;i&&"open"===i.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(e){var t=this.sourceBuffer,i=this.mediaSource;for(var n in e)if(!t[n]){var r=e[n],o=r.levelCodec||r.codec,a=r.container+";codecs="+o;f.logger.log("creating sourceBuffer("+a+")");try{var s=t[n]=i.addSourceBuffer(a);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe),this.tracks[n]={codec:o,container:r.container},r.buffer=s}catch(e){f.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:a})}}this.hls.trigger(d.default.BUFFER_CREATED,{tracks:e})}},{key:"onBufferAppending",value:function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())}},{key:"onBufferAppendFail",value:function(e){f.logger.error("sourceBuffer error:",e.event),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1,frag:this.fragCurrent})}},{key:"onBufferEos",value:function(e){var t=this.sourceBuffer,i=e.type;for(var n in t)i&&n!==i||t[n].ended||(t[n].ended=!0,f.logger.log(n+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(!t||"open"!==t.readyState)return void(this._needsEos=!1);for(var i in e){var n=e[i];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}f.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){f.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var e=this.media,t=this.mediaSource,i=this.sourceBuffer,n=this._levelDuration;if(null!==n&&e&&t&&i&&0!==e.readyState&&"open"===t.readyState){for(var r in i)if(i[r].updating)return;null===this._msDuration&&(this._msDuration=t.duration);var o=e.duration;(n>this._msDuration&&n>o||o===1/0||isNaN(o))&&(f.logger.log("Updating mediasource duration to "+n.toFixed(3)),this._msDuration=t.duration=n)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,i=this.sourceBuffer;try{for(var n in i)t+=i[n].buffered.length}catch(e){f.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(d.default.BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,i=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void f.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(i&&i.length){var n=i.shift();try{var r=n.type,o=t[r];o?o.updating?i.unshift(n):(o.ended=!1,this.parent=n.parent,o.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){f.logger.error("error while trying to append buffer:"+t.message),i.unshift(n);var a={type:h.ErrorTypes.MEDIA_ERROR};if(22===t.code)return this.segments=[],a.details=h.ErrorDetails.BUFFER_FULL_ERROR,a.fatal=!1,void e.trigger(d.default.ERROR,a);if(this.appendError?this.appendError++:this.appendError=1,a.details=h.ErrorDetails.BUFFER_APPEND_ERROR,a.frag=this.fragCurrent,this.appendError>e.config.appendErrorMaxRetry)return f.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),i=[],a.fatal=!0,void e.trigger(d.default.ERROR,a);a.fatal=!1,e.trigger(d.default.ERROR,a)}}}}},{key:"flushBuffer",value:function(e,t,i){var n,r,o,a,s,l,d=this.sourceBuffer;if(Object.keys(d).length){if(f.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var u in d)if(!i||u===i){if(n=d[u],n.ended=!1,n.updating)return f.logger.warn("cannot flush, sb updating in progress"),!1;try{for(r=0;r<n.buffered.length;r++)if(o=n.buffered.start(r),a=n.buffered.end(r),navigator.userAgent.toLowerCase().indexOf("firefox")!==-1&&t===Number.POSITIVE_INFINITY?(s=e,l=t):(s=Math.max(o,e),l=Math.min(a,t)),Math.min(l,a)-s>.5)return this.flushBufferCounter++,f.logger.log("flush "+u+" ["+s+","+l+"], of ["+o+","+a+"], pos:"+this.media.currentTime),n.remove(s,l),!1}catch(e){f.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else f.logger.warn("abort flushing too many retries");f.logger.log("buffer flushed")}return!0}}]),t}(c.default);i.default=p},{26:26,27:27,28:28,45:45}],8:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(28),d=n(l),u=e(27),c=n(u),f=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.FPS_DROP_LEVEL_CAPPING,d.default.MEDIA_ATTACHING,d.default.MANIFEST_PARSED))}return a(t,e),s(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(e){this.restrictedLevels||(this.restrictedLevels=[]),this.isLevelRestricted(e.droppedLevel)||this.restrictedLevels.push(e.droppedLevel)}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){var t=this.hls;t.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}},{key:"getMaxLevel",value:function(e){var t=0,i=void 0,n=void 0,r=this.mediaWidth,o=this.mediaHeight,a=0,s=0;for(i=0;i<=e&&(n=this.levels[i],!this.isLevelRestricted(i))&&(t=i,a=n.width,s=n.height,!(r<=a||o<=s));i++);return t}},{key:"isLevelRestricted",value:function(e){return!(!this.restrictedLevels||this.restrictedLevels.indexOf(e)===-1)}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}},{key:"mediaWidth",get:function(){var e=void 0,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=this.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=this.contentScaleFactor),e}}]),t}(c.default);i.default=f},{27:27,28:28}],9:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=e(44),s=n(a),l=function(){function e(t,i,n,o){r(this,e),this.hls=t,this.defaultEstimate_=o,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new s.default(i),this.fast_=new s.default(n)}return o(e,[{key:"sample",value:function(e,t){e=Math.max(e,this.minDelayMs_);var i=8e3*t/e,n=e/1e3;this.fast_.sample(n,i),this.slow_.sample(n,i)}},{key:"canEstimate",value:function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),e}();i.default=l},{44:44}],10:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(28),d=n(l),u=e(27),c=n(u),f=e(45),h=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.MEDIA_ATTACHING))}return a(t,e),s(t,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(e){var t=this.hls.config;if(t.capLevelOnFPSDrop){var i=this.video=e.media instanceof HTMLVideoElement?e.media:null;"function"==typeof i.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod)}}},{key:"checkFPS",value:function(e,t,i){var n=performance.now();if(t){if(this.lastTime){var r=n-this.lastTime,o=i-this.lastDroppedFrames,a=t-this.lastDecodedFrames,s=1e3*o/r,l=this.hls;if(l.trigger(d.default.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:i}),s>0&&o>l.config.fpsDroppedMonitoringThreshold*a){var u=l.currentLevel;f.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(l.autoLevelCapping===-1||l.autoLevelCapping>=u)&&(u-=1,l.trigger(d.default.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,l.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}]),t}(c.default);i.default=h},{27:27,28:28,45:45}],11:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(28),d=n(l),u=e(27),c=n(u),f=e(45),h=e(26),p=e(30),g=n(p),v=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.MANIFEST_LOADED,d.default.LEVEL_LOADED,d.default.FRAG_LOADED,d.default.ERROR));return i.ontick=i.tick.bind(i),i._manualLevel=i._autoLevelCapping=-1,i}return a(t,e),s(t,[{key:"destroy",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this._manualLevel=-1}},{key:"startLoad",value:function(){this.canload=!0;var e=this._levels;e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,i=[],n=[],r={},o=!1,a=!1,s=this.hls,l=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),u=function(e,t){return MediaSource.isTypeSupported(e+"/mp4;codecs="+t)};if(e.levels.forEach(function(e){e.videoCodec&&(o=!0),l&&e.audioCodec&&e.audioCodec.indexOf("mp4a.40.34")!==-1&&(e.audioCodec=void 0),(e.audioCodec||e.attrs&&e.attrs.AUDIO)&&(a=!0);var t=r[e.bitrate];void 0===t?(r[e.bitrate]=i.length,e.url=[e.url],e.urlId=0,i.push(e)):i[t].url.push(e.url)}),o&&a?i.forEach(function(e){e.videoCodec&&n.push(e)}):n=i,n=n.filter(function(e){var t=e.audioCodec,i=e.videoCodec;return(!t||u("audio",t))&&(!i||u("video",i))}),n.length){t=n[0].bitrate,n.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=n;for(var c=0;c<n.length;c++)if(n[c].bitrate===t){this._firstLevel=c,f.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+t);break}s.trigger(d.default.MANIFEST_PARSED,{levels:n,firstLevel:this._firstLevel,stats:e.stats,audio:a,video:o,altAudio:e.audioTracks.length>0})}else s.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:s.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels;if(e>=0&&e<t.length){this.timer&&(clearTimeout(this.timer),this.timer=null),this._level!==e&&(f.logger.log("switching to level "+e),this._level=e,this.hls.trigger(d.default.LEVEL_SWITCH,{level:e}));var i=t[e],n=i.details;if(!n||n.live===!0){var r=i.urlId;this.hls.trigger(d.default.LEVEL_LOADING,{url:i.url[r],level:e,id:r})}}else this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(!e.fatal){var t=e.details,i=this.hls,n=void 0,r=void 0,o=!1,a=i.abrController,s=a.minAutoLevel;switch(t){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:case h.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case h.ErrorDetails.KEY_LOAD_ERROR:case h.ErrorDetails.KEY_LOAD_TIMEOUT:n=e.frag.level;break;case h.ErrorDetails.LEVEL_LOAD_ERROR:case h.ErrorDetails.LEVEL_LOAD_TIMEOUT:n=e.context.level,o=!0;break;case h.ErrorDetails.REMUX_ALLOC_ERROR:n=e.level}if(void 0!==n){r=this._levels[n],r.loadError?r.loadError++:r.loadError=1;var l=r.url.length;if(l>1&&r.loadError<l)r.urlId=(r.urlId+1)%l,r.details=void 0,f.logger.warn("level controller,"+t+" for level "+n+": switching to redundant stream id "+r.urlId);else{var u=this._manualLevel===-1&&n;if(u)f.logger.warn("level controller,"+t+": switch-down for next fragment"),a.nextAutoLevel=Math.max(s,n-1);else if(r&&r.details&&r.details.live)f.logger.warn("level controller,"+t+" on live stream, discard"),o&&(this._level=void 0);else if(t===h.ErrorDetails.LEVEL_LOAD_ERROR||t===h.ErrorDetails.LEVEL_LOAD_TIMEOUT){var c=i.media,p=c&&g.default.isBuffered(c,c.currentTime)&&g.default.isBuffered(c,c.currentTime+.5);if(p){var v=i.config.levelLoadingRetryDelay;f.logger.warn("level controller,"+t+", but media buffered, retry in "+v+"ms"),this.timer=setTimeout(this.ontick,v)}else f.logger.error("cannot recover "+t+" error"),this._level=void 0,this.timer&&(clearTimeout(this.timer),this.timer=null),e.fatal=!0,i.trigger(d.default.ERROR,e)}}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if(t&&"main"===t.type){var i=this._levels[t.level];i&&(i.loadError=0)}}},{key:"onLevelLoaded",value:function(e){var t=e.level;if(t===this._level){var i=this._levels[t];i.loadError=0;var n=e.details;if(n.live){var r=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration),o=i.details;o&&n.endSN===o.endSN&&(r/=2,f.logger.log("same live playlist, reload twice faster")),r-=performance.now()-e.stats.trequest,r=Math.max(1e3,Math.round(r)),f.logger.log("live playlist, reload in "+r+" ms"),this.timer=setTimeout(this.ontick,r)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e],i=t.urlId;this.hls.trigger(d.default.LEVEL_LOADING,{url:t.url[i],level:e,id:i})}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),e!==-1&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){e!==-1&&(e=Math.max(e,this.hls.abrController.minAutoLevel)),this._startLevel=e}},{key:"nextLoadLevel",get:function(){return this._manualLevel!==-1?this._manualLevel:this.hls.abrController.nextAutoLevel},set:function(e){this.level=e,this._manualLevel===-1&&(this.hls.abrController.nextAutoLevel=e)}}]),t}(c.default);i.default=v},{26:26,27:27,28:28,30:30,45:45}],12:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(41),d=n(l),u=e(30),c=n(u),f=e(22),h=n(f),p=e(28),g=n(p),v=e(27),m=n(v),y=e(31),b=n(y),w=e(46),E=n(w),_=e(26),k=e(45),S={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},T=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,g.default.MEDIA_ATTACHED,g.default.MEDIA_DETACHING,g.default.MANIFEST_LOADING,g.default.MANIFEST_PARSED,g.default.LEVEL_LOADED,g.default.KEY_LOADED,g.default.FRAG_LOADED,g.default.FRAG_LOAD_EMERGENCY_ABORTED,g.default.FRAG_PARSING_INIT_SEGMENT,g.default.FRAG_PARSING_DATA,g.default.FRAG_PARSED,g.default.ERROR,g.default.AUDIO_TRACK_SWITCHING,g.default.AUDIO_TRACK_SWITCHED,g.default.BUFFER_CREATED,g.default.BUFFER_APPENDED,g.default.BUFFER_FLUSHED));
return i.config=e.config,i.audioCodecSwap=!1,i.ticks=0,i.ontick=i.tick.bind(i),i}return a(t,e),s(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),m.default.prototype.destroy.call(this),this.state=S.STOPPED}},{key:"startLoad",value:function(e){if(this.levels){var t=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=i.startLevel;n===-1&&(n=0,this.bitrateTest=!0),this.level=i.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&e===-1&&(k.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=S.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else k.logger.warn("cannot start loading as manifest not parsed yet"),this.state=S.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=S.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){switch(this.state){case S.ERROR:break;case S.BUFFER_FLUSHING:this.fragLoadError=0;break;case S.IDLE:if(!this._doTickIdle())return;break;case S.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=S.IDLE);break;case S.FRAG_LOADING_WAITING_RETRY:var t=performance.now(),i=this.retryDate;(!i||t>=i||this.media&&this.media.seeking)&&(k.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=S.IDLE);break;case S.ERROR:case S.STOPPED:case S.FRAG_LOADING:case S.PARSING:case S.PARSED:case S.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var e=this.hls,t=e.config,i=this.media;if(void 0!==this.levelLastLoaded&&!i&&(this.startFragRequested||!t.startFragPrefetch))return!0;var n=void 0;n=this.loadedmetadata?i.currentTime:this.nextLoadPosition;var r=e.nextLoadLevel,o=this.levels[r],a=o.bitrate,s=void 0;s=a?Math.max(8*t.maxBufferSize/a,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var l=c.default.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,n,t.maxBufferHole),d=l.len;if(d>=s)return!0;k.logger.trace("buffer length of "+d.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=r;var u=o.details;if("undefined"==typeof u||u.live&&this.levelLastLoaded!==r)return this.state=S.WAITING_LEVEL,!0;var f=this.fragPrevious;if(!u.live&&f&&f.sn===u.endSN&&i.duration-Math.max(l.end,f.start)<=Math.max(.1,f.duration/2)){var h={};return this.altAudio&&(h.type="video"),this.hls.trigger(g.default.BUFFER_EOS,h),this.state=S.ENDED,!0}return this._fetchPayloadOrEos({pos:n,bufferInfo:l,levelDetails:u})}},{key:"_fetchPayloadOrEos",value:function(e){var t=e.pos,i=e.bufferInfo,n=e.levelDetails,r=this.fragPrevious,o=this.level,a=n.fragments,s=a.length;if(0===s)return!1;var l=a[0].start,d=a[s-1].start+a[s-1].duration,u=i.end,c=void 0;if(n.live){var f=this.config.initialLiveManifestSize;if(s<f)return k.logger.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+f),!1;if(c=this._ensureFragmentAtLivePoint({levelDetails:n,bufferEnd:u,start:l,end:d,fragPrevious:r,fragments:a,fragLen:s}),null===c)return!1}else u<l&&(c=a[0]);return c||(c=this._findFragment({start:l,fragPrevious:r,fragLen:s,fragments:a,bufferEnd:u,end:d,levelDetails:n})),!c||this._loadFragmentOrKey({frag:c,level:o,levelDetails:n,pos:t,bufferEnd:u})}},{key:"_ensureFragmentAtLivePoint",value:function(e){var t=e.levelDetails,i=e.bufferEnd,n=e.start,r=e.end,o=e.fragPrevious,a=e.fragments,s=e.fragLen,l=this.hls.config,d=this.media,u=void 0,c=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*t.targetduration;if(i<Math.max(n-l.maxFragLookUpTolerance,r-c)){var f=this.liveSyncPosition=this.computeLivePosition(n,t);k.logger.log("buffer end: "+i.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+f.toFixed(3)),i=f,d&&d.readyState&&d.duration>f&&(d.currentTime=f)}if(t.PTSKnown&&i>r&&d&&d.readyState)return null;if(this.startFragRequested&&!t.PTSKnown){if(o){var h=o.sn+1;h>=t.startSN&&h<=t.endSN&&(u=a[h-t.startSN],k.logger.log("live playlist, switching playlist, load frag with next SN: "+u.sn))}u||(u=a[Math.min(s-1,Math.round(s/2))],k.logger.log("live playlist, switching playlist, unknown, load middle frag : "+u.sn))}return u}},{key:"_findFragment",value:function(e){var t=e.start,i=e.fragPrevious,n=e.fragLen,r=e.fragments,o=e.bufferEnd,a=e.end,s=e.levelDetails,l=this.hls.config,u=void 0,c=void 0,f=l.maxFragLookUpTolerance;if(o<a?(o>a-f&&(f=0),c=d.default.search(r,function(e){return e.start+e.duration-f<=o?1:e.start-f>o&&e.start?-1:0})):c=r[n-1],c&&(u=c,t=c.start,i&&u.level===i.level&&u.sn===i.sn))if(u.sn<s.endSN){var h=i.deltaPTS,p=u.sn-s.startSN;h&&h>l.maxBufferHole&&i.dropped&&p?(u=r[p-1],k.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),i.loadCounter--):(u=r[p+1],k.logger.log("SN just loaded, load next one: "+u.sn))}else u=null;return u}},{key:"_loadFragmentOrKey",value:function(e){var t=e.frag,i=e.level,n=e.levelDetails,r=e.pos,o=e.bufferEnd,a=this.hls,s=a.config;if(null==t.decryptdata.uri||null!=t.decryptdata.key){if(k.logger.log("Loading "+t.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+i+", currentTime:"+r.toFixed(3)+",bufferEnd:"+o.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,t.loadCounter){t.loadCounter++;var l=s.fragLoadingLoopThreshold;if(t.loadCounter>l&&Math.abs(this.fragLoadIdx-t.loadIdx)<l)return a.trigger(g.default.ERROR,{type:_.ErrorTypes.MEDIA_ERROR,details:_.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:t}),!1}else t.loadCounter=1;return t.loadIdx=this.fragLoadIdx,this.fragCurrent=t,this.startFragRequested=!0,this.nextLoadPosition=t.start+t.duration,t.autoLevel=a.autoLevelEnabled,t.bitrateTest=this.bitrateTest,a.trigger(g.default.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new h.default(a,"main")),this.state=S.FRAG_LOADING,!0}k.logger.log("Loading key for "+t.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+i),this.state=S.KEY_LOADING,a.trigger(g.default.KEY_LOADING,{frag:t})}},{key:"getBufferRange",value:function(e){return d.default.search(this.bufferRange,function(t){return e<t.start?-1:e>t.end?1:0})}},{key:"followingBufferRange",value:function(e){return e?this.getBufferRange(e.end+.5):null}},{key:"_checkFragmentChanged",value:function(){var e,t,i=this.media;if(i&&i.readyState&&i.seeking===!1&&(t=i.currentTime,t>i.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),c.default.isBuffered(i,t)?e=this.getBufferRange(t):c.default.isBuffered(i,t+.1)&&(e=this.getBufferRange(t+.1)),e)){var n=e.frag;n!==this.fragPlaying&&(this.fragPlaying=n,this.hls.trigger(g.default.FRAG_CHANGED,{frag:n}))}}},{key:"immediateLevelSwitch",value:function(){if(k.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"immediateLevelSwitchEnd",value:function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,c.default.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t=void 0,i=void 0,n=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,i=this.getBufferRange(e.currentTime),i&&i.start>1&&this.flushMainBuffer(0,i.start-1),e.paused)t=0;else{var r=this.hls.nextLoadLevel,o=this.levels[r],a=this.fragLastKbps;t=a&&this.fragCurrent?this.fragCurrent.duration*o.bitrate/(1e3*a)+1:0}if(n=this.getBufferRange(e.currentTime+t),n&&(n=this.followingBufferRange(n))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.start,Number.POSITIVE_INFINITY)}}}},{key:"flushMainBuffer",value:function(e,t){this.state=S.BUFFER_FLUSHING;var i={startOffset:e,endOffset:t};this.altAudio&&(i.type="video"),this.hls.trigger(g.default.BUFFER_FLUSHING,i)}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(k.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var e=this.media,t=e?e.currentTime:void 0,i=this.config;if(k.logger.log("media seeking to "+t.toFixed(3)),this.state===S.FRAG_LOADING){var n=this.mediaBuffer?this.mediaBuffer:e,r=c.default.bufferInfo(n,t,this.config.maxBufferHole),o=this.fragCurrent;if(0===r.len&&o){var a=i.maxFragLookUpTolerance,s=o.start-a,l=o.start+o.duration+a;t<s||t>l?(o.loader&&(k.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=S.IDLE):k.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===S.ENDED&&(this.state=S.IDLE);e&&(this.lastCurrentTime=t),this.state!==S.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*i.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()}},{key:"onMediaSeeked",value:function(){k.logger.log("media seeked to "+this.media.currentTime.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){k.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){k.logger.log("trigger BUFFER_RESET"),this.hls.trigger(g.default.BUFFER_RESET),this.bufferRange=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(e){var t,i=!1,n=!1;e.levels.forEach(function(e){t=e.audioCodec,t&&(t.indexOf("mp4a.40.2")!==-1&&(i=!0),t.indexOf("mp4a.40.5")!==-1&&(n=!0))}),this.audioCodecSwitch=i&&n,this.audioCodecSwitch&&k.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var r=this.config;r.autoStartLoad&&this.hls.startLoad(r.startPosition)}},{key:"onLevelLoaded",value:function(e){var t=e.details,i=e.level,n=this.levels[i],r=t.totalduration,o=0;if(k.logger.log("level "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+r),this.levelLastLoaded=i,t.live){var a=n.details;a&&t.fragments.length>0?(b.default.mergeDetails(a,t),o=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(o,a),t.PTSKnown?k.logger.log("live playlist sliding:"+o.toFixed(3)):k.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,k.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,this.hls.trigger(g.default.LEVEL_UPDATED,{details:t,level:i}),this.startFragRequested===!1){if(this.startPosition===-1||this.lastCurrentTime===-1){var s=t.startTimeOffset;isNaN(s)?t.live?(this.startPosition=this.computeLivePosition(o,t),k.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(s<0&&(k.logger.log("negative start time offset "+s+", count from end of last fragment"),s=o+r+s),k.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===S.WAITING_LEVEL&&(this.state=S.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===S.KEY_LOADING&&(this.state=S.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,i=e.frag;if(this.state===S.FRAG_LOADING&&t&&"main"===i.type&&i.level===t.level&&i.sn===t.sn){var n=e.stats,r=this.levels[t.level],o=r.details;if(k.logger.log("Loaded  "+t.sn+" of ["+o.startSN+" ,"+o.endSN+"],level "+t.level),this.bitrateTest=!1,i.bitrateTest===!0&&this.hls.nextLoadLevel)this.state=S.IDLE,this.startFragRequested=!1,n.tparsed=n.tbuffered=performance.now(),this.hls.trigger(g.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else{this.state=S.PARSING,this.stats=n;var a=o.totalduration,s=isNaN(t.startDTS)?t.start:t.startDTS,l=t.level,d=t.sn,u=this.config.defaultAudioCodec||r.audioCodec;this.audioCodecSwap&&(k.logger.log("swapping playlist audio codec"),void 0===u&&(u=this.lastAudioCodec),u&&(u=u.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,k.logger.log("Parsing "+d+" of ["+o.startSN+" ,"+o.endSN+"],level "+l+", cc "+t.cc);var c=this.demuxer;c||(c=this.demuxer=new h.default(this.hls,"main"));var f=this.media,p=f&&f.seeking,v=!p&&(o.PTSKnown||!o.live);c.push(e.payload,u,r.videoCodec,s,t.cc,l,d,a,t.decryptdata,v,null)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent;if(t&&"main"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===S.PARSING){var i,n,r=e.tracks;if(r.audio&&this.altAudio&&delete r.audio,n=r.audio){var o=this.levels[this.level].audioCodec,a=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(k.logger.log("swapping playlist audio codec"),o=o.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==n.metadata.channelCount&&a.indexOf("firefox")===-1&&(o="mp4a.40.5"),a.indexOf("android")!==-1&&"audio/mpeg"!==n.container&&(o="mp4a.40.2",k.logger.log("Android: force audio codec to "+o)),n.levelCodec=o,n.id=e.id}if(n=r.video,n&&(n.levelCodec=this.levels[this.level].videoCodec,n.id=e.id),e.unique){var s={codec:"",levelCodec:""};for(i in e.tracks)n=r[i],s.container=n.container,s.codec&&(s.codec+=",",s.levelCodec+=","),n.codec&&(s.codec+=n.codec),n.levelCodec&&(s.levelCodec+=n.levelCodec);r={audiovideo:s}}this.hls.trigger(g.default.BUFFER_CODECS,r);for(i in r){n=r[i],k.logger.log("main track:"+i+",container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var l=n.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(g.default.BUFFER_APPENDING,{type:i,data:l,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this,i=this.fragCurrent;if(i&&"main"===e.id&&e.sn===i.sn&&e.level===i.level&&("audio"!==e.type||!this.altAudio)&&this.state===S.PARSING){var n=this.levels[this.level],r=this.fragCurrent;k.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0));var o=b.default.updateFragPTSDTS(n.details,r.sn,e.startPTS,e.endPTS,e.startDTS,e.endDTS),a=this.hls;a.trigger(g.default.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),"video"===e.type&&(r.dropped=e.dropped),[e.data1,e.data2].forEach(function(i){i&&(t.appended=!0,t.pendingBuffering=!0,a.trigger(g.default.BUFFER_APPENDING,{type:e.type,data:i,parent:"main",content:"data"}))}),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent;t&&"main"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===S.PARSING&&(this.stats.tparsed=performance.now(),this.state=S.PARSED,this._checkAppendedParsed())}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url,i=e.id;if(!t){if(this.mediaBuffer!==this.media){k.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(k.logger.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=S.IDLE}var r=this.hls;r.trigger(g.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),r.trigger(g.default.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}}},{key:"onAudioTrackSwitched",value:function(e){var t=e.id,i=!!this.hls.audioTracks[t].url;if(i){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(k.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=i,this.tick()}},{key:"onBufferCreated",value:function(e){var t=e.tracks,i=void 0,n=void 0,r=!1;for(var o in t){var a=t[o];"main"===a.id?(n=o,i=a,"video"===o&&(this.videoBuffer=t[o].buffer)):r=!0}r&&i?(k.logger.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(e){if("main"===e.parent){var t=this.state;t!==S.PARSING&&t!==S.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){var e=this;if(!(this.state!==S.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent;t&&!function(){var i=e.mediaBuffer?e.mediaBuffer:e.media;k.logger.log("main buffered : "+E.default.toString(i.buffered));var n=e.bufferRange.filter(function(e){return c.default.isBuffered(i,(e.start+e.end)/2)});n.push({type:t.type,start:t.startPTS,end:t.endPTS,frag:t}),e.bufferRange=n.sort(function(e,t){return e.start-t.start}),e.fragPrevious=t;var r=e.stats;r.tbuffered=performance.now(),e.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),e.hls.trigger(g.default.FRAG_BUFFERED,{stats:r,frag:t,id:"main"}),e.state=S.IDLE}(),this.tick()}}},{key:"onError",value:function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var i=this.media,n=i&&c.default.isBuffered(i,i.currentTime)&&c.default.isBuffered(i,i.currentTime+.5);switch(e.details){case _.ErrorDetails.FRAG_LOAD_ERROR:case _.ErrorDetails.FRAG_LOAD_TIMEOUT:case _.ErrorDetails.KEY_LOAD_ERROR:case _.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal){var r=this.fragLoadError;r?r++:r=1;var o=this.config;if(r<=o.fragLoadingMaxRetry||n||t.autoLevel&&t.level){this.fragLoadError=r,t.loadCounter=0;var a=Math.min(Math.pow(2,r-1)*o.fragLoadingRetryDelay,o.fragLoadingMaxRetryTimeout);k.logger.warn("mediaController: frag loading failed, retry in "+a+" ms"),this.retryDate=performance.now()+a,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=S.FRAG_LOADING_WAITING_RETRY}else k.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.trigger(g.default.ERROR,e),this.state=S.ERROR}break;case _.ErrorDetails.FRAG_LOOP_LOADING_ERROR:e.fatal||(n?(this._reduceMaxBufferLength(t.duration),this.state=S.IDLE):t.autoLevel&&0!==t.level||(e.fatal=!0,this.hls.trigger(g.default.ERROR,e),this.state=S.ERROR));break;case _.ErrorDetails.LEVEL_LOAD_ERROR:case _.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==S.ERROR&&(e.fatal?(this.state=S.ERROR,k.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):this.state===S.WAITING_LEVEL&&(this.state=S.IDLE));break;case _.ErrorDetails.BUFFER_FULL_ERROR:this.state!==S.PARSING&&this.state!==S.PARSED||(n?(this._reduceMaxBufferLength(t.duration),this.state=S.IDLE):(k.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}}},{key:"_reduceMaxBufferLength",value:function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,k.logger.warn("reduce max buffer length to "+t.maxMaxBufferLength+"s and switch to IDLE state"),this.fragLoadIdx+=2*t.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var e=this.media;if(e&&e.readyState){var t=e.currentTime,i=this.mediaBuffer?this.mediaBuffer:e,n=i.buffered;if(this.loadedmetadata||!n.length||e.seeking)if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var r=c.default.bufferInfo(e,t,0),o=!(e.paused||e.ended||0===e.buffered.length),a=.5,s=t>e.playbackRate*this.lastCurrentTime,l=this.config;if(s)this.stalled&&(this.stallReported&&(k.logger.warn("playback not stuck anymore @"+t+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0);else if(o){var d=performance.now(),u=this.hls;if(this.stalled){var f=d-this.stalled,h=r.len;if(h<=a&&f>1e3*l.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,k.logger.warn("playback stalling in low buffer @"+t),u.trigger(g.default.ERROR,{type:_.ErrorTypes.MEDIA_ERROR,details:_.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:h}));var p=r.nextStart,v=p-t;if(p&&v<l.maxSeekHole&&v>0){var m=this.nudgeRetry++,y=m*l.nudgeOffset;k.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+p+" + nudge "+y);var b=p+y-e.currentTime;e.currentTime=p+y,this.stalled=void 0,u.trigger(g.default.ERROR,{type:_.ErrorTypes.MEDIA_ERROR,details:_.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:b})}}else if(h>a&&f>1e3*l.highBufferWatchdogPeriod){k.logger.warn("playback stalling in high buffer @"+t),u.trigger(g.default.ERROR,{type:_.ErrorTypes.MEDIA_ERROR,details:_.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:h}),this.stalled=void 0;var w=this.nudgeRetry++;if(w<l.nudgeMaxRetry){var E=e.currentTime,S=E+(w+1)*l.nudgeOffset;k.logger.log("adjust currentTime from "+E+" to "+S),e.currentTime=S,u.trigger(g.default.ERROR,{type:_.ErrorTypes.MEDIA_ERROR,details:_.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else u.trigger(g.default.ERROR,{type:_.ErrorTypes.MEDIA_ERROR,details:_.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}}else this.stalled=d,this.stallReported=!1}}else{this.loadedmetadata=!0,this.nudgeRetry=0;var T=this.startPosition,R=c.default.isBuffered(i,T);t===T&&R||(k.logger.log("target start position:"+T),R||(T=n.start(0),k.logger.log("target start position not buffered, seek to buffered.start(0) "+T)),k.logger.log("adjust currentTime from "+t+" to "+T),e.currentTime=T)}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=S.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:"onBufferFlushed",value:function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferRange=this.bufferRange.filter(function(t){return c.default.isBuffered(e,(t.start+t.end)/2)}),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=S.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(e,t){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-i)}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,k.logger.log("engine state transition from "+t+" to "+e),this.hls.trigger(g.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferRange(e.currentTime);if(t)return t.frag.level}return-1}},{key:"nextBufferRange",get:function(){var e=this.media;return e?this.followingBufferRange(this.getBufferRange(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferRange;return e?e.frag.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(m.default);i.default=T},{22:22,26:26,27:27,28:28,30:30,31:31,41:41,45:45,46:46}],13:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(28),d=n(l),u=e(27),c=n(u),f=e(42),h=n(f),p=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.MEDIA_ATTACHING,d.default.MEDIA_DETACHING,d.default.FRAG_PARSING_USERDATA,d.default.MANIFEST_LOADING,d.default.FRAG_LOADED,d.default.LEVEL_SWITCH));if(i.hls=e,i.config=e.config,i.enabled=!0,i.Cues=e.config.cueHandler,i.config.enableCEA708Captions){var n=i,a=function(e,t){var i=null;try{i=new window.Event("addtrack")}catch(e){i=document.createEvent("Event"),i.initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)},s={newCue:function(e,t,i){if(!n.textTrack1){var r=n.getExistingTrack("1");r?(n.textTrack1=r,n.clearCurrentCues(n.textTrack1),a(n.textTrack1,n.media)):(n.textTrack1=n.createTextTrack("captions","English","en"),n.textTrack1.textTrack1=!0)}n.Cues.newCue(n.textTrack1,e,t,i)}},l={newCue:function(e,t,i){if(!n.textTrack2){var r=n.getExistingTrack("2");r?(n.textTrack2=r,n.clearCurrentCues(n.textTrack2),a(n.textTrack2,n.media)):(n.textTrack2=n.createTextTrack("captions","Spanish","es"),n.textTrack2.textTrack2=!0)}n.Cues.newCue(n.textTrack2,e,t,i)}};i.cea608Parser=new h.default(0,s,l)}return i}return a(t,e),s(t,[{key:"clearCurrentCues",value:function(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}},{key:"getExistingTrack",value:function(e){var t=this.media;if(t)for(var i=0;i<t.textTracks.length;i++){var n=t.textTracks[i],r="textTrack"+e;if(n[r]===!0)return n}return null}},{key:"createTextTrack",value:function(e,t,i){if(this.media)return this.media.addTextTrack(e,t,i)}},{key:"destroy",value:function(){c.default.prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(e){this.media=e.media}},{key:"onMediaDetaching",value:function(){this.clearCurrentCues(this.textTrack1),this.clearCurrentCues(this.textTrack2)}},{key:"onManifestLoading",value:function(){this.lastPts=Number.NEGATIVE_INFINITY}},{key:"onLevelSwitch",value:function(){"NONE"===this.hls.currentLevel.closedCaptions?this.enabled=!1:this.enabled=!0}},{key:"onFragLoaded",value:function(e){if("main"===e.frag.type){var t=e.frag.start;t<=this.lastPts&&(this.clearCurrentCues(this.textTrack1),this.clearCurrentCues(this.textTrack2)),this.lastPts=t}}},{key:"onFragParsingUserdata",value:function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var i=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,i)}}},{key:"extractCea608Data",value:function(e){for(var t,i,n,r,o,a=31&e[0],s=2,l=[],d=0;d<a;d++)t=e[s++],i=127&e[s++],n=127&e[s++],r=0!==(4&t),o=3&t,0===i&&0===n||r&&0===o&&(l.push(i),l.push(n));return l}}]),t}(c.default);i.default=p},{27:27,28:28,42:42}],14:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t,i){n(this,e),this.subtle=t,this.aesIV=i}return r(e,[{key:"decrypt",value:function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}]),e}();i.default=o},{}],15:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(){n(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[],this.subMix[0]=new Uint32Array(256),this.subMix[1]=new Uint32Array(256),this.subMix[2]=new Uint32Array(256),this.subMix[3]=new Uint32Array(256),this.invSubMix=[],this.invSubMix[0]=new Uint32Array(256),this.invSubMix[1]=new Uint32Array(256),this.invSubMix[2]=new Uint32Array(256),this.invSubMix[3]=new Uint32Array(256),this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return r(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),i=new Uint32Array(4),n=0;n<i.length;n++)i[n]=t.getUint32(4*n);return i}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,i=this.subMix[0],n=this.subMix[1],r=this.subMix[2],o=this.subMix[3],a=this.invSubMix[0],s=this.invSubMix[1],l=this.invSubMix[2],d=this.invSubMix[3],u=new Uint32Array(256),c=0,f=0,h=0;for(h=0;h<256;h++)h<128?u[h]=h<<1:u[h]=h<<1^283;for(h=0;h<256;h++){var p=f^f<<1^f<<2^f<<3^f<<4;p=p>>>8^255&p^99,e[c]=p,t[p]=c;var g=u[c],v=u[g],m=u[v],y=257*u[p]^16843008*p;i[c]=y<<24|y>>>8,n[c]=y<<16|y>>>16,r[c]=y<<8|y>>>24,o[c]=y,y=16843009*m^65537*v^257*g^16843008*c,a[p]=y<<24|y>>>8,s[p]=y<<16|y>>>16,l[p]=y<<8|y>>>24,d[p]=y,c?(c=g^u[u[u[m^g]]],f^=u[u[f]]):c=f=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),i=!0,n=0;n<t.length&&i;)i=t[n]===this.key[n],n++;if(!i){this.key=t;var r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);var o=this.ksRows=4*(r+6+1),a=void 0,s=void 0,l=this.keySchedule=new Uint32Array(this.ksRows),d=this.invKeySchedule=new Uint32Array(this.ksRows),u=this.sBox,c=this.rcon,f=this.invSubMix[0],h=this.invSubMix[1],p=this.invSubMix[2],g=this.invSubMix[3],v=void 0,m=void 0;for(a=0;a<o;a++)a<r?v=l[a]=t[a]:(m=v,a%r===0?(m=m<<8|m>>>24,m=u[m>>>24]<<24|u[m>>>16&255]<<16|u[m>>>8&255]<<8|u[255&m],m^=c[a/r|0]<<24):r>6&&a%r===4&&(m=u[m>>>24]<<24|u[m>>>16&255]<<16|u[m>>>8&255]<<8|u[255&m]),l[a]=v=(l[a-r]^m)>>>0);for(s=0;s<o;s++)a=o-s,m=3&s?l[a]:l[a-4],s<4||a<=4?d[s]=m:d[s]=f[u[m>>>24]]^h[u[m>>>16&255]]^p[u[m>>>8&255]]^g[u[255&m]],d[s]=d[s]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,i){for(var n,r,o=this.keySize+6,a=this.invKeySchedule,s=this.invSBox,l=this.invSubMix[0],d=this.invSubMix[1],u=this.invSubMix[2],c=this.invSubMix[3],f=this.uint8ArrayToUint32Array_(i),h=f[0],p=f[1],g=f[2],v=f[3],m=new Int32Array(e),y=new Int32Array(m.length),b=void 0,w=void 0,E=void 0,_=void 0,k=void 0,S=void 0,T=void 0,R=void 0,A=void 0,C=void 0,x=void 0,L=void 0;t<m.length;){for(A=this.networkToHostOrderSwap(m[t]),C=this.networkToHostOrderSwap(m[t+1]),x=this.networkToHostOrderSwap(m[t+2]),L=this.networkToHostOrderSwap(m[t+3]),k=A^a[0],S=L^a[1],T=x^a[2],R=C^a[3],n=4,r=1;r<o;r++)b=l[k>>>24]^d[S>>16&255]^u[T>>8&255]^c[255&R]^a[n],
w=l[S>>>24]^d[T>>16&255]^u[R>>8&255]^c[255&k]^a[n+1],E=l[T>>>24]^d[R>>16&255]^u[k>>8&255]^c[255&S]^a[n+2],_=l[R>>>24]^d[k>>16&255]^u[S>>8&255]^c[255&T]^a[n+3],k=b,S=w,T=E,R=_,n+=4;b=s[k>>>24]<<24^s[S>>16&255]<<16^s[T>>8&255]<<8^s[255&R]^a[n],w=s[S>>>24]<<24^s[T>>16&255]<<16^s[R>>8&255]<<8^s[255&k]^a[n+1],E=s[T>>>24]<<24^s[R>>16&255]<<16^s[k>>8&255]<<8^s[255&S]^a[n+2],_=s[R>>>24]<<24^s[k>>16&255]<<16^s[S>>8&255]<<8^s[255&T]^a[n+3],n+=3,y[t]=this.networkToHostOrderSwap(b^h),y[t+1]=this.networkToHostOrderSwap(_^p),y[t+2]=this.networkToHostOrderSwap(E^g),y[t+3]=this.networkToHostOrderSwap(w^v),h=A,p=C,g=x,v=L,t+=4}return y.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),e}();i.default=o},{}],16:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=e(14),s=n(a),l=e(17),d=n(l),u=e(15),c=n(u),f=e(26),h=e(45),p=function(){function e(t,i){r(this,e),this.observer=t,this.config=i;try{var n=crypto?crypto:self.crypto;this.subtle=n.subtle||n.webkitSubtle}catch(e){}this.disableWebCrypto=!this.subtle}return o(e,[{key:"decrypt",value:function(e,t,i,n){var r=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){h.logger.log("JS AES decrypt");var o=this.decryptor;o||(this.decryptor=o=new c.default),o.expandKey(t),n(o.decrypt(e,0,i))}else!function(){h.logger.log("WebCrypto AES decrypt");var o=r.subtle;r.key!==t&&(r.key=t,r.fastAesKey=new d.default(o,t)),r.fastAesKey.expandKey().then(function(t){var r=new s.default(o,i);r.decrypt(e,t).then(function(e){n(e)})}).catch(function(o){r.onWebCryptoError(o,e,t,i,n)})}()}},{key:"onWebCryptoError",value:function(e,t,i,n,r){this.config.enableSoftwareAES?(h.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.decrypt(t,i,n,r)):(h.logger.error("decrypting error : "+e.message),this.observer.trigger(Event.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}},{key:"destroy",value:function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)}}]),e}();i.default=p},{14:14,15:15,17:17,26:26,45:45}],17:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t,i){n(this,e),this.subtle=t,this.key=i}return r(e,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),e}();i.default=o},{}],18:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=e(19),s=n(a),l=e(45),d=e(24),u=n(d),c=function(){function e(t,i,n,o,a){r(this,e),this.observer=t,this.id=i,this.remuxerClass=n,this.config=o,this.remuxer=new this.remuxerClass(t,i,o,a),this.insertDiscontinuity()}return o(e,[{key:"insertDiscontinuity",value:function(){this._aacTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0}}},{key:"push",value:function(e,t,i,n,r,o,a,d,c,f){var h,p,g,v,m,y,b,w,E,_,k=new u.default(e),S=90*k.timeStamp,T=!1;for(r!==this.lastCC?(l.logger.log(this.id+" discontinuity detected"),this.lastCC=r,this.insertDiscontinuity(),this.remuxer.switchLevel(),this.remuxer.insertDiscontinuity()):o!==this.lastLevel?(l.logger.log("audio track switch detected"),this.lastLevel=o,this.remuxer.switchLevel(),this.insertDiscontinuity()):a===this.lastSN+1&&(T=!0),h=this._aacTrack,this.lastSN=a,this.lastLevel=o,y=k.length,E=e.length;y<E-1&&(255!==e[y]||240!==(240&e[y+1]));y++);for(h.audiosamplerate||(p=s.default.getAudioConfig(this.observer,e,y,t),h.config=p.config,h.audiosamplerate=p.samplerate,h.channelCount=p.channelCount,h.codec=p.codec,h.manifestCodec=p.manifestCodec,h.duration=d,l.logger.log("parsed codec:"+h.codec+",rate:"+p.samplerate+",nb channel:"+p.channelCount)),m=0,v=9216e4/h.audiosamplerate;y+5<E&&(b=1&e[y+1]?7:9,g=(3&e[y+3])<<11|e[y+4]<<3|(224&e[y+5])>>>5,g-=b,g>0&&y+b+g<=E);)for(w=S+m*v,_={unit:e.subarray(y+b,y+b+g),pts:w,dts:w},h.samples.push(_),h.len+=g,y+=g+b,m++;y<E-1&&(255!==e[y]||240!==(240&e[y+1]));y++);this.remuxer.remux(o,a,r,this._aacTrack,{samples:[]},{samples:[{pts:S,dts:S,unit:k.payload}]},{samples:[]},n,T,c,f)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,i,n=new u.default(e);if(n.hasTimeStamp)for(t=n.length,i=e.length;t<i-1;t++)if(255===e[t]&&240===(240&e[t+1]))return!0;return!1}}]),e}();i.default=c},{19:19,24:24,45:45}],19:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e(45),a=e(26),s=function(){function e(){n(this,e)}return r(e,null,[{key:"getAudioConfig",value:function(e,t,i,n){var r,s,l,d,u,c=navigator.userAgent.toLowerCase(),f=n,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return r=((192&t[i+2])>>>6)+1,s=(60&t[i+2])>>>2,s>h.length-1?void e.trigger(Event.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s}):(d=(1&t[i+2])<<2,d|=(192&t[i+3])>>>6,o.logger.log("manifest codec:"+n+",ADTS data:type:"+r+",sampleingIndex:"+s+"["+h[s]+"Hz],channelConfig:"+d),/firefox|OPR/i.test(c)?s>=6?(r=5,u=new Array(4),l=s-3):(r=2,u=new Array(2),l=s):c.indexOf("android")!==-1?(r=2,u=new Array(2),l=s):(r=5,u=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&s>=6?l=s-3:((n&&n.indexOf("mp4a.40.2")!==-1&&s>=6&&1===d||!n&&1===d)&&(r=2,u=new Array(2)),l=s)),u[0]=r<<3,u[0]|=(14&s)>>1,u[1]|=(1&s)<<7,u[1]|=d<<3,5===r&&(u[1]|=(14&l)>>1,u[2]=(1&l)<<7,u[2]|=8,u[3]=0),/Vivaldi|OPR/i.test(c)&&(f="mp4a.40.2"),{config:u,samplerate:h[s],channelCount:d,codec:"mp4a.40."+r,manifestCodec:f})}}]),e}();i.default=s},{26:26,45:45}],20:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=e(28),s=n(a),l=e(26),d=e(16),u=n(d),c=e(18),f=n(c),h=e(25),p=n(h),g=e(38),v=n(g),m=e(39),y=n(m),b=function(){function e(t,i,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r(this,e),this.hls=t,this.id=i,this.config=this.hls.config||o,this.typeSupported=n}return o(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,i,n,r,o,a,l,d,c,f){if(e.byteLength>0&&null!=d&&null!=d.key&&"AES-128"===d.method){null==this.decrypter&&(this.decrypter=new u.default(this.hls,this.config));var h,p=this;try{h=performance.now()}catch(e){h=Date.now()}this.decrypter.decrypt(e,d.key.buffer,d.iv.buffer,function(e){var d;try{d=performance.now()}catch(e){d=Date.now()}p.hls.trigger(s.default.FRAG_DECRYPTED,{level:o,sn:a,stats:{tstart:h,tdecrypt:d}}),p.pushDecrypted(new Uint8Array(e),t,i,n,r,o,a,l,c,f)})}else this.pushDecrypted(new Uint8Array(e),t,i,n,r,o,a,l,c,f)}},{key:"pushDecrypted",value:function(e,t,i,n,r,o,a,d,u,c){var h=this.demuxer;if(!h||r!==this.cc&&!h.probe(e)){var g=this.hls,m=this.id,b=this.config,w=this.typeSupported;if(p.default.probe(e))h=this.typeSupported.mp2t===!0?new p.default(g,m,y.default,b,w):new p.default(g,m,v.default,b,w),h.probe=p.default.probe;else{if(!f.default.probe(e))return void g.trigger(s.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,id:m,details:l.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});h=new f.default(g,m,v.default,b,w),h.probe=f.default.probe}this.demuxer=h}h.push(e,t,i,n,r,o,a,d,u,c),this.cc=r}}]),e}();i.default=b},{16:16,18:18,25:25,26:26,28:28,38:38,39:39}],21:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var r=e(20),o=n(r),a=e(28),s=n(a),l=e(45),d=e(1),u=n(d),c=function(e){var t=new u.default;t.trigger=function(e){for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t.removeListener.apply(t,[e].concat(n))};var i=function(t,i){e.postMessage({event:t,data:i})};e.addEventListener("message",function(n){var r=n.data;switch(r.cmd){case"init":var a=JSON.parse(r.config);e.demuxer=new o.default(t,r.id,r.typeSupported,a);try{(0,l.enableLogs)(a.debug===!0)}catch(e){console.warn("demuxerWorker: unable to enable logs")}i("init",null);break;case"demux":e.demuxer.push(r.data,r.audioCodec,r.videoCodec,r.timeOffset,r.cc,r.level,r.sn,r.duration,r.decryptdata,r.accurateTimeOffset,r.defaultInitPTS)}}),t.on(s.default.FRAG_DECRYPTED,i),t.on(s.default.FRAG_PARSING_INIT_SEGMENT,i),t.on(s.default.FRAG_PARSED,i),t.on(s.default.ERROR,i),t.on(s.default.FRAG_PARSING_METADATA,i),t.on(s.default.FRAG_PARSING_USERDATA,i),t.on(s.default.INIT_PTS_FOUND,i),t.on(s.default.FRAG_PARSING_DATA,function(t,i){var n=i.data1.buffer,r=i.data2.buffer;delete i.data1,delete i.data2,e.postMessage({event:t,data:i,data1:n,data2:r},[n,r])})};i.default=c},{1:1,20:20,28:28,45:45}],22:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=e(28),s=n(a),l=e(20),d=n(l),u=e(21),c=n(u),f=e(45),h=e(26),p=function(){function t(i,n){r(this,t),this.hls=i,this.id=n;var o={mp4:MediaSource.isTypeSupported("video/mp4"),mp2t:i.config.enableMP2TPassThrough&&MediaSource.isTypeSupported("video/mp2t"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')};if(i.config.enableWorker&&"undefined"!=typeof Worker){f.logger.log("demuxing in webworker");var a=void 0;try{var l=e(3);a=this.w=l(c.default),this.onwmsg=this.onWorkerMessage.bind(this),a.addEventListener("message",this.onwmsg),a.onerror=function(e){i.trigger(s.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},a.postMessage({cmd:"init",typeSupported:o,id:n,config:JSON.stringify(i.config)})}catch(e){f.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),a&&URL.revokeObjectURL(a.objectURL),this.demuxer=new d.default(i,n,o)}}else this.demuxer=new d.default(i,n,o);this.demuxInitialized=!0}return o(t,[{key:"destroy",value:function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}}},{key:"push",value:function(e,t,i,n,r,o,a,s,l,d,u){var c=this.w;if(c)c.postMessage({cmd:"demux",data:e,audioCodec:t,videoCodec:i,timeOffset:n,cc:r,level:o,sn:a,duration:s,decryptdata:l,accurateTimeOffset:d,defaultInitPTS:u},[e]);else{var f=this.demuxer;f&&f.push(e,t,i,n,r,o,a,s,l,d,u)}}},{key:"onWorkerMessage",value:function(e){var t=e.data,i=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case s.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data.data2=new Uint8Array(t.data2);default:i.trigger(t.event,t.data)}}}]),t}();i.default=p},{20:20,21:21,26:26,28:28,3:3,45:45}],23:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e(45),a=function(){function e(t){n(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return r(e,[{key:"loadWord",value:function(){var e=this.data,t=this.bytesAvailable,i=e.byteLength-t,n=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");n.set(e.subarray(i,i+r)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;return e>32&&o.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,i,n=8,r=8;for(t=0;t<e;t++)0!==r&&(i=this.readEG(),r=(n+i+256)%256),n=0===r?n:r}},{key:"readSPS",value:function(){var e,t,i,n,r,o,a,s,l,d=0,u=0,c=0,f=0,h=this.readUByte.bind(this),p=this.readBits.bind(this),g=this.readUEG.bind(this),v=this.readBoolean.bind(this),m=this.skipBits.bind(this),y=this.skipEG.bind(this),b=this.skipUEG.bind(this),w=this.skipScalingList.bind(this);if(h(),e=h(),t=p(5),m(3),i=h(),b(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var E=g();if(3===E&&m(1),b(),b(),m(1),v())for(s=3!==E?8:12,l=0;l<s;l++)v()&&w(l<6?16:64)}b();var _=g();if(0===_)g();else if(1===_)for(m(1),y(),y(),n=g(),l=0;l<n;l++)y();b(),m(1),r=g(),o=g(),a=p(1),0===a&&m(1),m(1),v()&&(d=g(),u=g(),c=g(),f=g());var k=[1,1];if(v()&&v()){var S=h();switch(S){case 1:k=[1,1];break;case 2:k=[12,11];break;case 3:k=[10,11];break;case 4:k=[16,11];break;case 5:k=[40,33];break;case 6:k=[24,11];break;case 7:k=[20,11];break;case 8:k=[32,11];break;case 9:k=[80,33];break;case 10:k=[18,11];break;case 11:k=[15,11];break;case 12:k=[64,33];break;case 13:k=[160,99];break;case 14:k=[4,3];break;case 15:k=[3,2];break;case 16:k=[2,1];break;case 255:k=[h()<<8|h(),h()<<8|h()]}}return{width:Math.ceil(16*(r+1)-2*d-2*u),height:(2-a)*(o+1)*16-(a?2:4)*(c+f),pixelRatio:k}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();i.default=a},{45:45}],24:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e(45),a=function(){function e(t){n(this,e),this._hasTimeStamp=!1;for(var i,r,a,s,l,d,u,c,f=0;;)if(u=this.readUTF(t,f,3),f+=3,"ID3"===u)f+=3,i=127&t[f++],r=127&t[f++],a=127&t[f++],s=127&t[f++],l=(i<<21)+(r<<14)+(a<<7)+s,d=f+l,this._parseID3Frames(t,f,d),f=d;else{if("3DI"!==u)return f-=3,c=f,void(c&&(this.hasTimeStamp||o.logger.warn("ID3 tag found, but no timestamp"),this._length=c,this._payload=t.subarray(0,c)));f+=7,o.logger.log("3DI footer found, end: "+f)}}return r(e,[{key:"readUTF",value:function(e,t,i){var n="",r=t,o=t+i;do n+=String.fromCharCode(e[r++]);while(r<o);return n}},{key:"_parseID3Frames",value:function(e,t,i){for(var n,r,a,s,l;t+8<=i;)switch(n=this.readUTF(e,t,4),t+=4,r=e[t++]<<24+e[t++]<<16+e[t++]<<8+e[t++],s=e[t++]<<8+e[t++],a=t,n){case"PRIV":if("com.apple.streaming.transportStreamTimestamp"===this.readUTF(e,t,44)){t+=44,t+=4;var d=1&e[t++];this._hasTimeStamp=!0,l=((e[t++]<<23)+(e[t++]<<15)+(e[t++]<<7)+e[t++])/45,d&&(l+=47721858.84),l=Math.round(l),o.logger.trace("ID3 timestamp found: "+l),this._timeStamp=l}}}},{key:"hasTimeStamp",get:function(){return this._hasTimeStamp}},{key:"timeStamp",get:function(){return this._timeStamp}},{key:"length",get:function(){return this._length}},{key:"payload",get:function(){return this._payload}}]),e}();i.default=a},{45:45}],25:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=e(19),s=n(a),l=e(28),d=n(l),u=e(23),c=n(u),f=e(45),h=e(26),p=function(){function e(t,i,n,o,a){r(this,e),this.observer=t,this.id=i,this.remuxerClass=n,this.config=o,this.typeSupported=a,this.lastCC=0,this.remuxer=new this.remuxerClass(t,i,o,a)}return o(e,[{key:"switchLevel",value:function(){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.remuxer.switchLevel()}},{key:"insertDiscontinuity",value:function(){this.switchLevel(),this.remuxer.insertDiscontinuity()}},{key:"push",value:function(e,t,i,n,r,o,a,s,l,u){var c,p,g,v,m,y,b=e.length,w=this.remuxer.passthrough,E=!1;this.audioCodec=t,this.videoCodec=i,this._duration=s,this.contiguous=!1,this.accurateTimeOffset=l,r!==this.lastCC&&(f.logger.log("discontinuity detected"),this.insertDiscontinuity(),this.lastCC=r),o!==this.lastLevel?(f.logger.log("level switch detected"),this.switchLevel(),this.lastLevel=o):a===this.lastSN+1&&(this.contiguous=!0),this.lastSN=a;var _=this.pmtParsed,k=this._avcTrack,S=this._audioTrack,T=this._id3Track,R=k.id,A=S.id,C=T.id,x=this._pmtId,L=k.pesData,D=S.pesData,P=T.pesData,I=this._parsePAT,O=this._parsePMT,N=this._parsePES,M=this._parseAVCPES.bind(this),F=this._parseAACPES.bind(this),U=this._parseMPEGPES.bind(this),B=this._parseID3PES.bind(this);for(b-=b%188,c=0;c<b;c+=188)if(71===e[c]){if(p=!!(64&e[c+1]),g=((31&e[c+1])<<8)+e[c+2],v=(48&e[c+3])>>4,v>1){if(m=c+5+e[c+4],m===c+188)continue}else m=c+4;switch(g){case R:if(p){if(L&&(y=N(L))&&(M(y,!1),w&&k.codec&&(A===-1||S.codec)))return void this.remux(o,a,r,e,n);L={data:[],size:0}}L&&(L.data.push(e.subarray(m,c+188)),L.size+=c+188-m);break;case A:if(p){if(D&&(y=N(D))&&(S.isAAC?F(y):U(y),w&&S.codec&&(R===-1||k.codec)))return void this.remux(o,a,r,e,n);D={data:[],size:0}}D&&(D.data.push(e.subarray(m,c+188)),D.size+=c+188-m);break;case C:p&&(P&&(y=N(P))&&B(y),P={data:[],size:0}),P&&(P.data.push(e.subarray(m,c+188)),P.size+=c+188-m);break;case 0:p&&(m+=e[m]+1),x=this._pmtId=I(e,m);break;case x:p&&(m+=e[m]+1);var j=O(e,m,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0);R=j.avc,R>0&&(k.id=R),A=j.audio,A>0&&(S.id=A,S.isAAC=j.isAAC),C=j.id3,C>0&&(T.id=C),E&&!_&&(f.logger.log("reparse from beginning"),E=!1,c=-188),_=this.pmtParsed=!0;break;case 17:case 8191:break;default:E=!0}}else this.observer.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,id:this.id,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});L&&(y=N(L))?(M(y,!0),k.pesData=null):k.pesData=L,D&&(y=N(D))?(S.isAAC?F(y):U(y),S.pesData=null):(D&&D.size&&f.logger.log("last AAC PES packet truncated,might overlap between fragments"),S.pesData=D),P&&(y=N(P))?(B(y),T.pesData=null):T.pesData=P,this.remux(o,a,r,null,n,u)}},{key:"remux",value:function(e,t,i,n,r,o){for(var a=this._avcTrack,s=a.samples,l=0,d=0,u=0;u<s.length;u++){for(var c=s[u],f=c.units.units,h=f.length,p=0,g=0;g<h;g++)p+=f[g].data.length;d+=p,l+=h,c.length=p}a.len=d,a.nbNalu=l,this.remuxer.remux(e,t,i,this._audioTrack,this._avcTrack,this._id3Track,this._txtTrack,r,this.contiguous,this.accurateTimeOffset,o,n)}},{key:"destroy",value:function(){this.switchLevel(),this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){return(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t,i){var n,r,o,a,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(n=(15&e[t+1])<<8|e[t+2],r=t+3+n-4,o=(15&e[t+10])<<8|e[t+11],t+=12+o;t<r;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 15:s.audio===-1&&(s.audio=a);break;case 21:s.id3===-1&&(s.id3=a);break;case 27:s.avc===-1&&(s.avc=a);break;case 3:case 4:i?s.audio===-1&&(s.audio=a,s.isAAC=!1):f.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:f.logger.warn("HEVC stream type found, not supported for now");break;default:f.logger.log("unkown stream type:"+e[t])}t+=((15&e[t+3])<<8|e[t+4])+5}return s}},{key:"_parsePES",value:function(e){var t,i,n,r,o,a,s,l,d,u=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&c.length>1;){var h=new Uint8Array(c[0].length+c[1].length);h.set(c[0]),h.set(c[1],c[0].length),c[0]=h,c.splice(1,1)}if(t=c[0],n=(t[0]<<16)+(t[1]<<8)+t[2],1===n){if(r=(t[4]<<8)+t[5],r&&r>e.size-6)return null;i=t[7],192&i&&(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,s>4294967295&&(s-=8589934592),64&i?(l=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,l>4294967295&&(l-=8589934592),s-l>54e5&&(f.logger.warn(Math.round((s-l)/9e4)+"s delta between PTS and DTS, align them"),s=l)):l=s),o=t[8],d=o+9,e.size-=d,a=new Uint8Array(e.size);for(var p=0,g=c.length;p<g;p++){t=c[p];var v=t.byteLength;if(d){if(d>v){d-=v;continue}t=t.subarray(d),v-=d,d=0}a.set(t,u),u+=v}return r&&(r-=o+3),{data:a,pts:s,dts:l,len:r}}return null}},{key:"pushAccesUnit",value:function(e,t){e.units.units.length&&e.frame&&(!this.config.forceKeyFrameOnDiscontinuity||e.key===!0||t.sps&&(t.samples.length||this.contiguous)?t.samples.push(e):t.dropped++),e.debug.length&&f.logger.log(e.pts+"/"+e.dts+":"+e.debug+","+e.units.length)}},{key:"_parseAVCPES",value:function(e,t){var i,n,r,o=this,a=this._avcTrack,s=this._parseAVCNALu(e.data),l=!1,d=this.avcSample;e.data=null,s.forEach(function(t){switch(t.type){case 1:n=!0,l&&d&&(d.debug+="NDR "),d.frame=!0;var s=t.data;if(s.length>4){var u=new c.default(s).readSliceType();2!==u&&4!==u&&7!==u&&9!==u||(d.key=!0)}break;case 5:n=!0,d||(d=o.avcSample=o._createAVCSample(!0,e.pts,e.dts,"")),l&&(d.debug+="IDR "),d.key=!0,d.frame=!0;break;case 6:n=!0,l&&d&&(d.debug+="SEI "),i=new c.default(o.discardEPB(t.data)),i.readUByte();for(var f=0,h=0,p=!1,g=0;!p&&i.bytesAvailable>1;){f=0;do g=i.readUByte(),f+=g;while(255===g);h=0;do g=i.readUByte(),h+=g;while(255===g);if(4===f&&0!==i.bytesAvailable){p=!0;var v=i.readUByte();if(181===v){var m=i.readUShort();if(49===m){var y=i.readUInt();if(1195456820===y){var b=i.readUByte();if(3===b){var w=i.readUByte(),E=i.readUByte(),_=31&w,k=[w,E];for(r=0;r<_;r++)k.push(i.readUByte()),k.push(i.readUByte()),k.push(i.readUByte());o._insertSampleInOrder(o._txtTrack.samples,{type:3,pts:e.pts,bytes:k})}}}}}else if(h<i.bytesAvailable)for(r=0;r<h;r++)i.readUByte()}break;case 7:if(n=!0,l&&d&&(d.debug+="SPS "),!a.sps){i=new c.default(t.data);var S=i.readSPS();a.width=S.width,a.height=S.height,a.pixelRatio=S.pixelRatio,a.sps=[t.data],a.duration=o._duration;var T=t.data.subarray(1,4),R="avc1.";for(r=0;r<3;r++){var A=T[r].toString(16);A.length<2&&(A="0"+A),R+=A}a.codec=R}break;case 8:n=!0,l&&d&&(d.debug+="PPS "),a.pps||(a.pps=[t.data]);break;case 9:n=!1,d&&o.pushAccesUnit(d,a),d=o.avcSample=o._createAVCSample(!1,e.pts,e.dts,l?"AUD ":"");break;case 12:n=!1;break;default:n=!1,d&&(d.debug+="unknown NAL "+t.type+" ")}if(d&&n){var C=d.units;C.units.push(t)}}),t&&d&&(this.pushAccesUnit(d,a),this.avcSample=null)}},{key:"_createAVCSample",value:function(e,t,i,n){return{key:e,pts:t,dts:i,units:{units:[],length:0},debug:n}}},{key:"_insertSampleInOrder",value:function(e,t){var i=e.length;if(i>0){if(t.pts>=e[i-1].pts)e.push(t);else for(var n=i-1;n>=0;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)}},{key:"_getLastNalUnit",value:function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.units.length){var i=this._avcTrack,n=i.samples;e=n[n.length-1]}if(e){var r=e.units.units;t=r[r.length-1]}return t}},{key:"_parseAVCNALu",value:function(e){var t,i,n,r,o,a=0,s=e.byteLength,l=this._avcTrack,d=l.naluState||0,u=d,c=[],f=-1;for(d===-1&&(f=0,o=31&e[0],d=0,a=1);a<s;)if(t=e[a++],d)if(1!==d)if(t)if(1===t){if(f>=0)n={data:e.subarray(f,a-d-1),type:o},c.push(n);else{var h=this._getLastNalUnit();if(h&&(u&&a<=4-u&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-u)),i=a-d-1,i>0)){var p=new Uint8Array(h.data.byteLength+i);p.set(h.data,0),p.set(e.subarray(0,i),h.data.byteLength),h.data=p}}a<s?(r=31&e[a],f=a,o=r,d=0):d=-1}else d=0;else d=3;else d=t?0:2;else d=t?0:1;if(f>=0&&d>=0&&(n={data:e.subarray(f,s),type:o,state:d},c.push(n)),0===c.length){var g=this._getLastNalUnit();if(g){var v=new Uint8Array(g.data.byteLength+e.byteLength);v.set(g.data,0),v.set(e,g.data.byteLength),g.data=v}}return l.naluState=d,c}},{key:"discardEPB",value:function(e){for(var t,i,n=e.byteLength,r=[],o=1;o<n-2;)0===e[o]&&0===e[o+1]&&3===e[o+2]?(r.push(o+2),o+=2):o++;if(0===r.length)return e;t=n-r.length,i=new Uint8Array(t);var a=0;for(o=0;o<t;a++,o++)a===r[0]&&(a++,r.shift()),i[o]=e[a];return i}},{key:"_parseAACPES",value:function(e){var t,i,n,r,o,a,l,u,c,p=this._audioTrack,g=e.data,v=e.pts,m=0,y=this.aacOverFlow,b=this.aacLastPTS;if(y){var w=new Uint8Array(y.byteLength+g.byteLength);w.set(y,0),w.set(g,y.byteLength),g=w}for(o=m,u=g.length;o<u-1&&(255!==g[o]||240!==(240&g[o+1]));o++);if(o){var E,_;if(o<u-1?(E="AAC PES did not start with ADTS header,offset:"+o,_=!1):(E="no ADTS header found in AAC PES",_=!0),f.logger.warn("parsing error:"+E),this.observer.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,id:this.id,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:_,reason:E}),_)return}if(!p.audiosamplerate){var k=this.audioCodec;t=s.default.getAudioConfig(this.observer,g,o,k),p.config=t.config,p.audiosamplerate=t.samplerate,p.channelCount=t.channelCount,p.codec=t.codec,p.manifestCodec=t.manifestCodec,p.duration=this._duration,f.logger.log("parsed codec:"+p.codec+",rate:"+t.samplerate+",nb channel:"+t.channelCount)}if(r=0,n=9216e4/p.audiosamplerate,y&&b){var S=b+n;Math.abs(S-v)>1&&(f.logger.log("AAC: align PTS for overlapping frames by "+Math.round((S-v)/90)),v=S)}for(;o+5<u&&(a=1&g[o+1]?7:9,i=(3&g[o+3])<<11|g[o+4]<<3|(224&g[o+5])>>>5,i-=a,i>0&&o+a+i<=u);)for(l=v+r*n,c={unit:g.subarray(o+a,o+a+i),pts:l,dts:l},p.samples.push(c),p.len+=i,o+=i+a,r++;o<u-1&&(255!==g[o]||240!==(240&g[o+1]));o++);y=o<u?g.subarray(o,u):null,this.aacOverFlow=y,this.aacLastPTS=l}},{key:"_parseMPEGPES",value:function(e){for(var t,i=e.data,n=e.pts,r=i.length,o=0,a=0;a<r&&(t=this._parseMpeg(i,a,r,o++,n))>0;)a+=t}},{key:"_onMpegFrame",value:function(e,t,i,n,r,o){var a=1152/i*1e3,s=o+r*a,l=this._audioTrack;l.config=[],l.channelCount=n,l.audiosamplerate=i,l.duration=this._duration,l.samples.push({unit:e,pts:s,dts:s}),l.len+=e.length}},{key:"_onMpegNoise",value:function(e){f.logger.warn("mpeg audio has noise: "+e.length+" bytes")}},{key:"_parseMpeg",value:function(e,t,i,n,r){var o=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],a=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3];if(t+2>i)return-1;if(255===e[t]||224===(224&e[t+1])){if(t+24>i)return-1;var s=e[t+1]>>3&3,l=e[t+1]>>1&3,d=e[t+2]>>4&15,u=e[t+2]>>2&3,c=!!(2&e[t+2]);if(1!==s&&0!==d&&15!==d&&3!==u){var f=3===s?3-l:3===l?3:4,h=1e3*o[14*f+d-1],p=3===s?0:2===s?1:2,g=a[3*p+u],v=c?1:0,m=e[t+3]>>6===3?1:2,y=3===l?(3===s?12:6)*h/g+v<<2:(3===s?144:72)*h/g+v|0;return t+y>i?-1:(this._onMpegFrame&&this._onMpegFrame(e.subarray(t,t+y),h,g,m,n,r),y)}}for(var b=t+2;b<i;){if(255===e[b-1]&&224===(224&e[b]))return this._onMpegNoise&&this._onMpegNoise(e.subarray(t,b-1)),b-t-1;b++}return-1}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();i.default=p},{19:19,23:23,26:26,28:28,45:45}],26:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},i.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},{}],27:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e
}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e(45),l=e(26),d=e(28),u=n(d),c=function(){function e(t){r(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];this.handledEvents=n,this.useGenericHandler=!0,this.registerListeners()}return a(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===o(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)}.bind(this))}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)}.bind(this))}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){var i=function(e,t){var i="on"+e.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)};try{i.call(this,e,t).call()}catch(t){s.logger.error("internal error happened while processing "+e+":"+t.message),this.hls.trigger(u.default.ERROR,{type:l.ErrorTypes.OTHER_ERROR,details:l.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}}}]),e}();i.default=c},{26:26,28:28,45:45}],28:[function(e,t,i){"use strict";t.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVEL_SWITCH:"hlsLevelSwitch",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},{}],29:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"getSilentFrame",value:function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),e}();i.default=o},{}],30:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"isBuffered",value:function(e,t){if(e)for(var i=e.buffered,n=0;n<i.length;n++)if(t>=i.start(n)&&t<=i.end(n))return!0;return!1}},{key:"bufferInfo",value:function(e,t,i){if(e){var n,r=e.buffered,o=[];for(n=0;n<r.length;n++)o.push({start:r.start(n),end:r.end(n)});return this.bufferedInfo(o,t,i)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:"bufferedInfo",value:function(e,t,i){var n,r,o,a,s,l=[];for(e.sort(function(e,t){var i=e.start-t.start;return i?i:t.end-e.end}),s=0;s<e.length;s++){var d=l.length;if(d){var u=l[d-1].end;e[s].start-u<i?e[s].end>u&&(l[d-1].end=e[s].end):l.push(e[s])}else l.push(e[s])}for(s=0,n=0,r=o=t;s<l.length;s++){var c=l[s].start,f=l[s].end;if(t+i>=c&&t<f)r=c,o=f,n=o-t;else if(t+i<c){a=c;break}}return{len:n,start:r,end:o,nextStart:a}}}]),e}();i.default=o},{}],31:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e(45),a=function(){function e(){n(this,e)}return r(e,null,[{key:"mergeDetails",value:function(t,i){var n,r=Math.max(t.startSN,i.startSN)-i.startSN,a=Math.min(t.endSN,i.endSN)-i.startSN,s=i.startSN-t.startSN,l=t.fragments,d=i.fragments,u=0;if(a<r)return void(i.PTSKnown=!1);for(var c=r;c<=a;c++){var f=l[s+c],h=d[c];h&&f&&(u=f.cc-h.cc,isNaN(f.startPTS)||(h.start=h.startPTS=f.startPTS,h.endPTS=f.endPTS,h.duration=f.duration,n=h))}if(u)for(o.logger.log("discontinuity sliding from playlist, take drift into account"),c=0;c<d.length;c++)d[c].cc+=u;if(n)e.updateFragPTSDTS(i,n.sn,n.startPTS,n.endPTS,n.startDTS,n.endDTS);else if(s>=0&&s<l.length){var p=l[s].start;for(c=0;c<d.length;c++)d[c].start+=p}i.PTSKnown=t.PTSKnown}},{key:"updateFragPTSDTS",value:function(t,i,n,r,o,a){var s,l,d,u;if(!t||i<t.startSN||i>t.endSN)return 0;if(s=i-t.startSN,l=t.fragments,d=l[s],!isNaN(d.startPTS)){var c=Math.abs(d.startPTS-n);isNaN(d.deltaPTS)?d.deltaPTS=c:d.deltaPTS=Math.max(c,d.deltaPTS),n=Math.min(n,d.startPTS),r=Math.max(r,d.endPTS),o=Math.min(o,d.startDTS),a=Math.max(a,d.endDTS)}var f=n-d.start;for(d.start=d.startPTS=n,d.endPTS=r,d.startDTS=o,d.endDTS=a,d.duration=r-n,u=s;u>0;u--)e.updatePTS(l,u,u-1);for(u=s;u<l.length-1;u++)e.updatePTS(l,u,u+1);return t.PTSKnown=!0,f}},{key:"updatePTS",value:function(e,t,i){var n=e[t],r=e[i],a=r.startPTS;isNaN(a)?i>t?r.start=n.start+n.duration:r.start=n.start-r.duration:i>t?(n.duration=a-n.start,n.duration<0&&o.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(r.duration=n.start-a,r.duration<0&&o.logger.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!"))}}]),e}();i.default=a},{45:45}],32:[function(e,t,i){function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=e(28),s=n(a),l=e(26),d=e(36),u=n(d),c=e(34),f=n(c),h=e(4),p=n(h),g=e(7),v=n(g),m=e(8),y=n(m),b=e(5),w=n(b),E=e(12),_=n(E),k=e(11),S=n(k),T=e(13),R=n(T),A=e(10),C=n(A),x=e(6),L=n(x),D=e(45),P=e(47),I=n(P),O=e(1),N=n(O),M=e(35),F=n(M),U=e(43),B=n(U),j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var i=e.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var n in i)n in t||(t[n]=i[n]);if(void 0!==t.liveMaxLatencyDurationCount&&t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(t.liveMaxLatencyDuration<=t.liveSyncDuration||void 0===t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,D.enableLogs)(t.debug),this.config=t;var o=this.observer=new N.default;o.trigger=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];o.emit.apply(o,[e,e].concat(i))},o.off=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];o.removeListener.apply(o,[e].concat(i))},this.on=o.on.bind(o),this.off=o.off.bind(o),this.trigger=o.trigger.bind(o),this.playlistLoader=new u.default(this),this.fragmentLoader=new f.default(this),this.levelController=new S.default(this),this.abrController=new t.abrController(this),this.bufferController=new t.bufferController(this),this.capLevelController=new t.capLevelController(this),this.fpsController=new t.fpsController(this),this.streamController=new t.streamController(this),this.audioStreamController=new t.audioStreamController(this),this.timelineController=new t.timelineController(this),this.audioTrackController=new L.default(this),this.keyLoader=new F.default(this)}return o(e,null,[{key:"isSupported",value:function(){return window.MediaSource=window.MediaSource||window.WebKitMediaSource,window.MediaSource&&"function"==typeof window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"version",get:function(){return"0.6.18"}},{key:"Events",get:function(){return s.default}},{key:"ErrorTypes",get:function(){return l.ErrorTypes}},{key:"ErrorDetails",get:function(){return l.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig||(e.defaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxMaxBufferLength:600,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.2,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:I.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:p.default,bufferController:v.default,capLevelController:y.default,fpsController:C.default,streamController:_.default,audioStreamController:w.default,timelineController:R.default,cueHandler:B.default,enableCEA708Captions:!0,enableMP2TPassThrough:!1,stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}),e.defaultConfig},set:function(t){e.defaultConfig=t}}]),o(e,[{key:"destroy",value:function(){D.logger.log("destroy"),this.trigger(s.default.DESTROYING),this.detachMedia(),this.playlistLoader.destroy(),this.fragmentLoader.destroy(),this.levelController.destroy(),this.abrController.destroy(),this.bufferController.destroy(),this.capLevelController.destroy(),this.fpsController.destroy(),this.streamController.destroy(),this.audioStreamController.destroy(),this.timelineController.destroy(),this.audioTrackController.destroy(),this.keyLoader.destroy(),this.url=null,this.observer.removeAllListeners()}},{key:"attachMedia",value:function(e){D.logger.log("attachMedia"),this.media=e,this.trigger(s.default.MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){D.logger.log("detachMedia"),this.trigger(s.default.MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){D.logger.log("loadSource:"+e),this.url=e,this.trigger(s.default.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;D.logger.log("startLoad("+e+")"),this.levelController.startLoad(),this.streamController.startLoad(e),this.audioStreamController.startLoad(e)}},{key:"stopLoad",value:function(){D.logger.log("stopLoad"),this.levelController.stopLoad(),this.streamController.stopLoad(),this.audioStreamController.stopLoad()}},{key:"swapAudioCodec",value:function(){D.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){D.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){D.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){D.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){D.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.abrController.minAutoLevel)},set:function(e){D.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){D.logger.log("set startLevel:"+e),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this.abrController.autoLevelCapping},set:function(e){D.logger.log("set autoLevelCapping:"+e),this.abrController.autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"audioTracks",get:function(){return this.audioTrackController.audioTracks}},{key:"audioTrack",get:function(){return this.audioTrackController.audioTrack},set:function(e){this.audioTrackController.audioTrack=e}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}}]),e}();i.default=j},{1:1,10:10,11:11,12:12,13:13,26:26,28:28,34:34,35:35,36:36,4:4,43:43,45:45,47:47,5:5,6:6,7:7,8:8}],33:[function(e,t,i){"use strict";t.exports=e(32).default},{32:32}],34:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(28),d=n(l),u=e(27),c=n(u),f=e(26),h=e(45),p=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.FRAG_LOADING));return i.loaders={},i}return a(t,e),s(t,[{key:"destroy",value:function(){var e=this.loaders;for(var t in e){var i=e[t];i&&i.destroy()}this.loaders={},c.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag,i=t.type,n=this.loaders[i],r=this.hls.config;t.loaded=0,n&&(h.logger.warn("abort previous fragment loader for type:"+i),n.abort()),n=this.loaders[i]=t.loader="undefined"!=typeof r.fLoader?new r.fLoader(r):new r.loader(r);var o=void 0,a=void 0,s=void 0;o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var l=t.byteRangeStartOffset,d=t.byteRangeEndOffset;isNaN(l)||isNaN(d)||(o.rangeStart=l,o.rangeEnd=d),a={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout},s={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},n.load(o,a,s)}},{key:"loadsuccess",value:function(e,t,i){var n=e.data,r=i.frag;r.loader=void 0,this.loaders[r.type]=void 0,this.hls.trigger(d.default.FRAG_LOADED,{payload:n,frag:r,stats:t})}},{key:"loaderror",value:function(e,t){var i=t.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(d.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e})}},{key:"loadtimeout",value:function(e,t){var i=t.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(d.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag})}},{key:"loadprogress",value:function(e,t,i){var n=t.frag;n.loaded=e.loaded,this.hls.trigger(d.default.FRAG_LOAD_PROGRESS,{frag:n,stats:e})}}]),t}(c.default);i.default=p},{26:26,27:27,28:28,45:45}],35:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(28),d=n(l),u=e(27),c=n(u),f=e(26),h=e(45),p=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.KEY_LOADING));return i.loaders={},i.decryptkey=null,i.decrypturl=null,i}return a(t,e),s(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},c.default.prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=e.frag,i=t.type,n=this.loaders[i],r=t.decryptdata,o=r.uri;if(o!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;n&&(h.logger.warn("abort previous key loader for type:"+i),n.abort()),t.loader=this.loaders[i]=new a.loader(a),this.decrypturl=o,this.decryptkey=null;var s=void 0,l=void 0,u=void 0;s={url:o,frag:t,responseType:"arraybuffer"},l={timeout:a.fragLoadingTimeOut,maxRetry:a.fragLoadingMaxRetry,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(s,l,u)}else this.decryptkey&&(r.key=this.decryptkey,this.hls.trigger(d.default.KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e,t,i){var n=i.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(d.default.KEY_LOADED,{frag:n})}},{key:"loaderror",value:function(e,t){var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(d.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:i,response:e})}},{key:"loadtimeout",value:function(e,t){var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(d.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})}}]),t}(c.default);i.default=p},{26:26,27:27,28:28,45:45}],36:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e(2),d=n(l),u=e(28),c=n(u),f=e(27),h=n(f),p=e(26),g=e(40),v=n(g),m=e(45),y=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,b=/#EXT-X-MEDIA:(.*)/g,w=/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*))?|(?!#)(\S.+)|#EXT-X-BYTERANGE: *(.+)|#EXT-X-PROGRAM-DATE-TIME:(.+)|#.*/g,E=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,_=function(){function e(){a(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return s(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=d.default.buildAbsoluteURL(this.baseuri,this.reluri)),this._uri}}]),e}(),k=function(){function e(){a(this,e),this._url=null,this._byteRange=null,this._decryptdata=null}return s(e,[{key:"createInitializationVector",value:function(e){for(var t=new Uint8Array(16),i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t}},{key:"fragmentDecryptdataFromLevelkey",value:function(e,t){var i=e;return e&&e.method&&e.uri&&!e.iv&&(i=new _,i.method=e.method,i.baseuri=e.baseuri,i.reluri=e.reluri,i.iv=this.createInitializationVector(t)),i}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=d.default.buildAbsoluteURL(this.baseurl,this.relurl)),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var e=this._byteRange=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var i=this.lastByteRangeEndOffset;e[0]=i?i:0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),e}(),S=function(e){function t(e){a(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.MANIFEST_LOADING,c.default.LEVEL_LOADING,c.default.AUDIO_TRACK_LOADING));return i.loaders={},i}return o(t,e),s(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},h.default.prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(e){this.load(e.url,{type:"level",level:e.level,id:e.id})}},{key:"onAudioTrackLoading",value:function(e){this.load(e.url,{type:"audioTrack",id:e.id})}},{key:"load",value:function(e,t){var i=this.loaders[t.type];if(i){var n=i.context;if(n&&n.url===e)return void m.logger.trace("playlist request ongoing");m.logger.warn("abort previous loader for type:"+t.type),i.abort()}var r=this.hls.config,o=void 0,a=void 0,s=void 0,l=void 0;"manifest"===t.type?(o=r.manifestLoadingMaxRetry,a=r.manifestLoadingTimeOut,s=r.manifestLoadingRetryDelay,l=r.manifestLoadingMaxRetryTimeout):(o=r.levelLoadingMaxRetry,a=r.levelLoadingTimeOut,s=r.levelLoadingRetryDelay,l=r.levelLoadingMaxRetryTimeout,m.logger.log("loading playlist for "+t.type+" "+(t.level||t.id))),i=this.loaders[t.type]=t.loader="undefined"!=typeof r.pLoader?new r.pLoader(r):new r.loader(r),t.url=e,t.responseType="";var d=void 0,u=void 0;d={timeout:a,maxRetry:o,retryDelay:s,maxRetryDelay:l},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},i.load(t,d,u)}},{key:"resolve",value:function(e,t){return d.default.buildAbsoluteURL(t,e)}},{key:"parseMasterPlaylist",value:function(e,t){var i=[],n=void 0;for(y.lastIndex=0;null!=(n=y.exec(e));){var r={},o=r.attrs=new v.default(n[1]);r.url=this.resolve(n[2],t);var a=o.decimalResolution("RESOLUTION");a&&(r.width=a.width,r.height=a.height),r.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),r.name=o.NAME;var s=o.CODECS;if(s){s=s.split(/[ ,]+/);for(var l=0;l<s.length;l++){var d=s[l];d.indexOf("avc1")!==-1?r.videoCodec=this.avc1toavcoti(d):r.audioCodec=d}}i.push(r)}return i}},{key:"parseMasterPlaylistMedia",value:function(e,t,i){var n=void 0,r=[];for(b.lastIndex=0;null!=(n=b.exec(e));){var o={},a=new v.default(n[1]);a.TYPE===i&&(o.groupId=a["GROUP-ID"],o.name=a.NAME,o.type=i,o.default="YES"===a.DEFAULT,o.autoselect="YES"===a.AUTOSELECT,o.forced="YES"===a.FORCED,a.URI&&(o.url=this.resolve(a.URI,t)),o.lang=a.LANGUAGE,o.name||(o.name=o.lang),r.push(o))}return r}},{key:"avc1toavcoti",value:function(e){var t,i=e.split(".");return i.length>2?(t=i.shift()+".",t+=parseInt(i.shift()).toString(16),t+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):t=e,t}},{key:"parseLevelPlaylist",value:function(e,t,i,n){var r,o,a=0,s=0,l={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},d=new _,u=0,c=null,f=new k;for(f.tagList=[],w.lastIndex=0;null!==(r=w.exec(e));){var h=r[1];if(h){f.duration=parseFloat(h);var p=(" "+r[2]).slice(1);f.title=p?p:null,f.tagList.push(p?["INF",h,p]:["INF",h])}else if(r[3]){if(!isNaN(f.duration)){var g=a++;f.type=n,f.start=s,f.levelkey=d,f.sn=g,f.level=i,f.cc=u,f.baseurl=t,f.relurl=(" "+r[3]).slice(1),l.fragments.push(f),c=f,s+=f.duration,f=new k,f.tagList=[]}}else if(r[4]){if(f.rawByteRange=(" "+r[4]).slice(1),c){var y=c.byteRangeEndOffset;y&&(f.lastByteRangeEndOffset=y)}}else if(r[5])f.rawProgramDateTime=(" "+r[5]).slice(1),f.tagList.push(["PROGRAM-DATE-TIME",f.rawProgramDateTime]);else{for(r=r[0].match(E),o=1;o<r.length&&void 0===r[o];o++);var b=(" "+r[o+1]).slice(1),S=(" "+r[o+2]).slice(1);switch(r[o]){case"#":f.tagList.push(S?[b,S]:[b]);break;case"PLAYLIST-TYPE":l.type=b.toUpperCase();break;case"MEDIA-SEQUENCE":a=l.startSN=parseInt(b);break;case"TARGETDURATION":l.targetduration=parseFloat(b);break;case"VERSION":l.version=parseInt(b);break;case"EXTM3U":break;case"ENDLIST":l.live=!1;break;case"DIS":u++,f.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":u=parseInt(b);break;case"KEY":var T=b,R=new v.default(T),A=R.enumeratedString("METHOD"),C=R.URI,x=R.hexadecimalInteger("IV");A&&(d=new _,C&&"AES-128"===A&&(d.method=A,d.baseuri=t,d.reluri=C,d.key=null,d.iv=x));break;case"START":var L=b,D=new v.default(L),P=D.decimalFloatingPoint("TIME-OFFSET");isNaN(P)||(l.startTimeOffset=P);break;default:m.logger.warn("line parsed but not handled: "+r)}}}return f=c,f&&!f.relurl&&(l.fragments.pop(),s-=f.duration),l.totalduration=s,l.averagetargetduration=s/l.fragments.length,l.endSN=a-1,l}},{key:"loadsuccess",value:function(e,t,i){var n=e.data,r=e.url,o=i.type,a=i.id,s=i.level,l=this.hls;if(this.loaders[o]=void 0,void 0!==r&&0!==r.indexOf("data:")||(r=i.url),t.tload=performance.now(),0===n.indexOf("#EXTM3U"))if(n.indexOf("#EXTINF:")>0){var d="audioTrack"!==o,u=this.parseLevelPlaylist(n,r,(d?s:a)||0,d?"main":"audio");"manifest"===o&&l.trigger(c.default.MANIFEST_LOADED,{levels:[{url:r,details:u}],audioTracks:[],url:r,stats:t}),t.tparsed=performance.now(),u.targetduration?d?l.trigger(c.default.LEVEL_LOADED,{details:u,level:s||0,id:a||0,stats:t}):l.trigger(c.default.AUDIO_TRACK_LOADED,{details:u,id:a,stats:t}):l.trigger(c.default.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:r,reason:"invalid targetduration"})}else{var f=this.parseMasterPlaylist(n,r);if(f.length){var h=this.parseMasterPlaylistMedia(n,r,"AUDIO");if(h.length){var g=!1;h.forEach(function(e){e.url||(g=!0)}),g===!1&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(m.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main"}))}l.trigger(c.default.MANIFEST_LOADED,{levels:f,audioTracks:h,url:r,stats:t})}else l.trigger(c.default.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,
details:p.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:r,reason:"no level found in manifest"})}else l.trigger(c.default.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:r,reason:"no EXTM3U delimiter"})}},{key:"loaderror",value:function(e,t){var i,n,r=t.loader;switch(t.type){case"manifest":i=p.ErrorDetails.MANIFEST_LOAD_ERROR,n=!0;break;case"level":i=p.ErrorDetails.LEVEL_LOAD_ERROR,n=!1;break;case"audioTrack":i=p.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,n=!1}r&&(r.abort(),this.loaders[t.type]=void 0),this.hls.trigger(c.default.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:i,fatal:n,url:r.url,loader:r,response:e,context:t})}},{key:"loadtimeout",value:function(e,t){var i,n,r=t.loader;switch(t.type){case"manifest":i=p.ErrorDetails.MANIFEST_LOAD_TIMEOUT,n=!0;break;case"level":i=p.ErrorDetails.LEVEL_LOAD_TIMEOUT,n=!1;break;case"audioTrack":i=p.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,n=!1}r&&(r.abort(),this.loaders[t.type]=void 0),this.hls.trigger(c.default.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:i,fatal:n,url:r.url,loader:r,context:t})}}]),t}(h.default);i.default=S},{2:2,26:26,27:27,28:28,40:40,45:45}],37:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"init",value:function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:i,audio:n};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=o,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,a,l,a,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,r))}},{key:"box",value:function(e){for(var t,i=Array.prototype.slice.call(arguments,1),n=8,r=i.length,o=r;r--;)n+=i[r].byteLength;for(t=new Uint8Array(n),t[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),r=0,n=8;r<o;r++)t.set(i[r],n),n+=i[r].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,i){return i*=t,e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,i,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,i))}},{key:"moov",value:function(t){for(var i=t.length,n=[];i--;)n[i]=e.trak(t[i]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var i=t.length,n=[];i--;)n[i]=e.trex(t[i]);return e.box.apply(null,[e.types.mvex].concat(n))}},{key:"mvhd",value:function(t,i){i*=t;var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24&255,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,n)}},{key:"sdtp",value:function(t){var i,n,r=t.samples||[],o=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)i=r[n].flags,o[n+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return e.box(e.types.sdtp,o)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var i,n,r,o=[],a=[];for(i=0;i<t.sps.length;i++)n=t.sps[i],r=n.byteLength,o.push(r>>>8&255),o.push(255&r),o=o.concat(Array.prototype.slice.call(n));for(i=0;i<t.pps.length;i++)n=t.pps[i],r=n.byteLength,a.push(r>>>8&255),a.push(255&r),a=a.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,o[3],o[4],o[5],255,224|t.sps.length].concat(o).concat([t.pps.length]).concat(a))),l=t.width,d=t.height,u=t.pixelRatio[0],c=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var i=t.audiosamplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"mp3",value:function(t){var i=t.audiosamplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))}},{key:"stsd",value:function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var i=t.id,n=t.duration*t.timescale,r=t.width,o=t.height;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,255&r,0,0,o>>8&255,255&o,0,0]))}},{key:"traf",value:function(t,i){var n=e.sdtp(t),r=t.id;return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),e.box(e.types.tfdt,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.trun(t,n.length+16+16+8+16+8+8),n)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var i=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,i){var n,r,o,a,s,l,d=t.samples||[],u=d.length,c=12+16*u,f=new Uint8Array(c);for(i+=8+c,f.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0),n=0;n<u;n++)r=d[n],o=r.duration,a=r.size,s=r.flags,l=r.cts,f.set([o>>>24&255,o>>>16&255,o>>>8&255,255&o,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,f)}},{key:"initSegment",value:function(t){e.types||e.init();var i,n=e.moov(t);return i=new Uint8Array(e.FTYP.byteLength+n.byteLength),i.set(e.FTYP),i.set(n,e.FTYP.byteLength),i}}]),e}();i.default=o},{}],38:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=e(29),s=n(a),l=e(28),d=n(l),u=e(45),c=e(37),f=n(c),h=e(26),p=function(){function e(t,i,n,o){r(this,e),this.observer=t,this.id=i,this.config=n,this.typeSupported=o,this.ISGenerated=!1,this.PES2MP4SCALEFACTOR=4,this.PES_TIMESCALE=9e4,this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR}return o(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){this._initPTS=this._initDTS=void 0}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,i,n,r,o,a,s,l,u,c){if(this.level=e,this.sn=t,this.ISGenerated||this.generateIS(n,r,s,i),null!==c&&(this._initPTS=this._initDTS=c),this.ISGenerated)if(n.samples.length){var f=this.remuxAudio(n,s,l,u);if(r.samples.length){var h=void 0;f&&(h=f.endPTS-f.startPTS),this.remuxVideo(r,s,l,h)}}else{var p=void 0;r.samples.length&&(p=this.remuxVideo(r,s,l)),p&&n.codec&&this.remuxEmptyAudio(n,s,l,p)}o.samples.length&&this.remuxID3(o,s),a.samples.length&&this.remuxText(a,s),this.observer.trigger(d.default.FRAG_PARSED,{id:this.id,level:this.level,sn:this.sn})}},{key:"generateIS",value:function(e,t,i,n){var r,o,a=this.observer,s=e.samples,l=t.samples,c=this.PES_TIMESCALE,p=this.typeSupported,g="audio/mp4",v={},m={id:this.id,level:this.level,sn:this.sn,tracks:v,unique:!1},y=void 0===this._initPTS;y&&(r=o=1/0),e.config&&s.length&&(e.timescale=e.audiosamplerate,e.timescale*e.duration>Math.pow(2,32)&&!function(){var t=function e(t,i){return i?e(i,t%i):t};e.timescale=e.audiosamplerate/t(e.audiosamplerate,e.isAAC?1024:1152)}(),u.logger.log("audio mp4 timescale :"+e.timescale),e.isAAC||(p.mpeg?(g="audio/mpeg",e.codec=""):p.mp3&&(e.codec="mp3")),v.audio={container:g,codec:e.codec,initSegment:!e.isAAC&&p.mpeg?new Uint8Array:f.default.initSegment([e]),metadata:{channelCount:e.channelCount}},y&&(r=o=s[0].pts-c*i)),t.sps&&t.pps&&l.length&&(t.timescale=this.MP4_TIMESCALE,v.video={container:"video/mp4",codec:t.codec,initSegment:f.default.initSegment([t]),metadata:{width:t.width,height:t.height}},y&&(r=Math.min(r,l[0].pts-c*i),o=Math.min(o,l[0].dts-c*i),this.observer.trigger(d.default.INIT_PTS_FOUND,{id:this.id,initPTS:r,cc:n}))),Object.keys(v).length?(a.trigger(d.default.FRAG_PARSING_INIT_SEGMENT,m),this.ISGenerated=!0,y&&(this._initPTS=r,this._initDTS=o)):a.trigger(d.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,id:this.id,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,i,n){var r,o,a,s,l,c,p,g,v=8,m=this.PES_TIMESCALE,y=this.PES2MP4SCALEFACTOR,b=e.samples,w=[],E=b.length,_=this._PTSNormalize,k=this._initDTS;b.sort(function(e,t){var i=e.dts-t.dts;return i?i:e.pts-t.pts});var S=b.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(S<0){u.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(S/90)+" ms to overcome this issue");for(var T=0;T<b.length;T++)b[T].dts+=S}var R=void 0;R=i?this.nextAvcDts:t*m;var A=b[0];l=Math.max(_(A.dts-k,R),0),s=Math.max(_(A.pts-k,R),0);var C=Math.round((l-R)/90);i&&C&&(C>1?u.logger.log("AVC:"+C+" ms hole between fragments detected,filling it"):C<-1&&u.logger.log("AVC:"+-C+" ms overlapping between fragments detected"),l=R,b[0].dts=l+k,s=Math.max(s-C,R),b[0].pts=s+k,u.logger.log("Video/PTS/DTS adjusted: "+Math.round(s/90)+"/"+Math.round(l/90)+",delta:"+C+" ms")),c=l,A=b[b.length-1],g=Math.max(_(A.dts-k,R),0),p=Math.max(_(A.pts-k,R),0),p=Math.max(p,g);var x=navigator.vendor,L=navigator.userAgent,D=x&&x.indexOf("Apple")>-1&&L&&!L.match("CriOS");D&&(r=Math.round((g-l)/(y*(b.length-1))));for(var P=0;P<E;P++){var I=b[P];D?I.dts=l+P*y*r:(I.dts=Math.max(_(I.dts-k,R),l),I.dts=Math.round(I.dts/y)*y),I.pts=Math.max(_(I.pts-k,R),I.dts),I.pts=Math.round(I.pts/y)*y}var O=e.len+4*e.nbNalu+8;try{o=new Uint8Array(O)}catch(e){return void this.observer.trigger(d.default.ERROR,{type:h.ErrorTypes.MUX_ERROR,level:this.level,id:this.id,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:O,reason:"fail allocating video mdat "+O})}var N=new DataView(o.buffer);N.setUint32(0,O),o.set(f.default.types.mdat,4);for(var M=0;M<E;M++){for(var F=b[M],U=F.units.units,B=0,j=void 0,H=0,G=U.length;H<G;H++){var q=U[H],V=q.data,W=q.data.byteLength;N.setUint32(v,W),v+=4,o.set(V,v),v+=W,B+=4+W}if(D)j=Math.max(0,r*Math.round((F.pts-F.dts)/(y*r)));else{if(M<E-1)r=b[M+1].dts-F.dts;else{var $=this.config,z=F.dts-b[M>0?M-1:M].dts;if($.stretchShortVideoTrack){var K=$.maxBufferHole,Y=$.maxSeekHole,X=Math.floor(Math.min(K,Y)*m),J=(n?s+n*m:this.nextAudioPts)-F.pts;J>X?(r=J-z,r<0&&(r=z),u.logger.log("It is approximately "+J/90+" ms to the next segment; using duration "+r/90+" ms for the last video frame.")):r=z}else r=z}r/=y,j=Math.round((F.pts-F.dts)/y)}w.push({size:B,duration:r,cts:j,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:F.key?2:1,isNonSync:F.key?0:1}})}this.nextAvcDts=g+r*y;var Q=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,w.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var Z=w[0].flags;Z.dependsOn=2,Z.isNonSync=0}e.samples=w,a=f.default.moof(e.sequenceNumber++,l/y,e),e.samples=[];var ee={id:this.id,level:this.level,sn:this.sn,data1:a,data2:o,startPTS:s/m,endPTS:(p+y*r)/m,startDTS:l/m,endDTS:this.nextAvcDts/m,type:"video",nb:w.length,dropped:Q};return this.observer.trigger(d.default.FRAG_PARSING_DATA,ee),ee}},{key:"remuxAudio",value:function(e,t,i,n){var r,o,a,l,c,p,g,v,m,y,b,w,E,_,k,S,T=this.PES_TIMESCALE,R=e.timescale,A=T/R,C=e.timescale*(e.isAAC?1024:1152)/e.audiosamplerate,x=C*A,L=this._PTSNormalize,D=this._initDTS,P=!e.isAAC&&this.typeSupported.mpeg,I=P?0:8,O=[],N=[];if(e.samples.sort(function(e,t){return e.pts-t.pts}),N=e.samples,S=this.nextAudioPts,i|=N.length&&S&&(Math.abs(t-S/T)<.1||Math.abs(N[0].pts-S-this._initDTS)<20*x),i||(S=t*T),n&&e.isAAC)for(var M=0,F=S;M<N.length;){var U=N[M],B=L(U.pts-D,S),j=B-F;if(j<=-x)u.logger.warn("Dropping 1 audio frame @ "+Math.round(F/90)/1e3+"s due to "+Math.round(Math.abs(j/90))+" ms overlap."),N.splice(M,1),e.len-=U.unit.length;else if(j>=x){var H=Math.round(j/x);u.logger.warn("Injecting "+H+" audio frame @ "+Math.round(F/90)/1e3+"s due to "+Math.round(j/90)+" ms gap.");for(var G=0;G<H;G++)k=F+D,k=Math.max(k,D),_=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),_||(u.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),_=U.unit.subarray()),N.splice(M,0,{unit:_,pts:k,dts:k}),e.len+=_.length,F+=x,M+=1;U.pts=U.dts=F+D,F+=x,M+=1}else Math.abs(j)>.1*x,F+=x,0===M?U.pts=U.dts=D+S:U.pts=U.dts=N[M-1].pts+x,M+=1}for(var q=0,V=N.length;q<V;q++){if(o=N[q],l=o.unit,y=o.pts-D,b=o.dts-D,void 0!==m)w=L(y,m),E=L(b,m),a.duration=Math.round((E-m)/A);else{w=L(y,S),E=L(b,S);var W=Math.round(1e3*(w-S)/T),$=0;if(i&&e.isAAC&&W){if(W>0)$=Math.round((w-S)/x),u.logger.log(W+" ms hole between AAC samples detected,filling it"),$>0&&(_=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),_||(_=l.subarray()),e.len+=$*_.length);else if(W<-12){u.logger.log(-W+" ms overlapping between AAC samples detected, drop frame"),e.len-=l.byteLength;continue}w=E=S}if(g=Math.max(0,w),v=Math.max(0,E),!(e.len>0))return;var z=P?e.len:e.len+8;try{c=new Uint8Array(z)}catch(e){return void this.observer.trigger(d.default.ERROR,{type:h.ErrorTypes.MUX_ERROR,level:this.level,id:this.id,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:z,reason:"fail allocating audio mdat "+z})}P||(r=new DataView(c.buffer),r.setUint32(0,z),c.set(f.default.types.mdat,4));for(var K=0;K<$;K++)k=w-($-K)*x,_=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),_||(u.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),_=l.subarray()),c.set(_,I),I+=_.byteLength,a={size:_.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},O.push(a)}c.set(l,I);var Y=l.byteLength;I+=Y,a={size:Y,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},O.push(a),m=E}var X=0,J=O.length;if(J>=2&&(X=O[J-2].duration,a.duration=X),J){this.nextAudioPts=w+A*X,e.len=0,e.samples=O,p=P?new Uint8Array:f.default.moof(e.sequenceNumber++,v/A,e),e.samples=[];var Q={id:this.id,level:this.level,sn:this.sn,data1:p,data2:c,startPTS:g/T,endPTS:this.nextAudioPts/T,startDTS:v/T,endDTS:(E+A*X)/T,type:"audio",nb:J};return this.observer.trigger(d.default.FRAG_PARSING_DATA,Q),Q}return null}},{key:"remuxEmptyAudio",value:function(e,t,i,n){var r=this.PES_TIMESCALE,o=e.timescale?e.timescale:e.audiosamplerate,a=r/o,l=this.nextAudioPts,d=(void 0!==l?l:n.startDTS*r)+this._initDTS,c=n.endDTS*r+this._initDTS,f=1024,h=a*f,p=Math.ceil((c-d)/h),g=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(u.logger.warn("remux empty Audio"),!g)return void u.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var v=[],m=0;m<p;m++){var y=d+m*h;v.push({unit:g,pts:y,dts:y}),e.len+=g.length}e.samples=v,this.remuxAudio(e,t,i)}},{key:"remuxID3",value:function(e,t){var i,n=e.samples.length;if(n){for(var r=0;r<n;r++)i=e.samples[r],i.pts=(i.pts-this._initPTS)/this.PES_TIMESCALE,i.dts=(i.dts-this._initDTS)/this.PES_TIMESCALE;this.observer.trigger(d.default.FRAG_PARSING_METADATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var i,n=e.samples.length;if(n){for(var r=0;r<n;r++)i=e.samples[r],i.pts=(i.pts-this._initPTS)/this.PES_TIMESCALE;this.observer.trigger(d.default.FRAG_PARSING_USERDATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var i;if(void 0===t)return e;for(i=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e}},{key:"passthrough",get:function(){return!1}}]),e}();i.default=p},{26:26,28:28,29:29,37:37,45:45}],39:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=e(28),s=n(a),l=function(){function e(t,i){r(this,e),this.observer=t,this.id=i,this.ISGenerated=!1}return o(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,i,n,r,o){var a=this.observer;if(!this.ISGenerated){var l={},d={id:this.id,tracks:l,unique:!0},u=t,c=u.codec;c&&(d.tracks.video={container:u.container,codec:c,metadata:{width:u.width,height:u.height}}),u=e,c=u.codec,c&&(d.tracks.audio={container:u.container,codec:c,metadata:{channelCount:u.channelCount}}),this.ISGenerated=!0,a.trigger(s.default.FRAG_PARSING_INIT_SEGMENT,d)}a.trigger(s.default.FRAG_PARSING_DATA,{id:this.id,data1:o,startPTS:r,startDTS:r,type:"audiovideo",nb:1,dropped:0})}},{key:"passthrough",get:function(){return!0}}]),e}();i.default=l},{28:28}],40:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,s=function(){function e(t){n(this,e),"string"==typeof t&&(t=e.parseAttrList(t));for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i])}return r(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)i[n]=parseInt(t.slice(2*n,2*n+2),16);return i}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=o.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){var t,i={};for(a.lastIndex=0;null!==(t=a.exec(e));){var n=t[2],r='"';0===n.indexOf(r)&&n.lastIndexOf(r)===n.length-1&&(n=n.slice(1,-1)),i[t[1]]=n}return i}}]),e}();i.default=s},{}],41:[function(e,t,i){"use strict";var n={search:function(e,t){for(var i=0,n=e.length-1,r=null,o=null;i<=n;){r=(i+n)/2|0,o=e[r];var a=t(o);if(a>0)i=r+1;else{if(!(a<0))return o;n=r-1}}return null}};t.exports=n},{}],42:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},a=function(e){var t=e;return o.hasOwnProperty(e)&&(t=o[e]),String.fromCharCode(t)},s=15,l=32,d={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},c={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},f={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],p={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var i=this.verboseFilter[e];this.verboseLevel>=i&&console.log(this.time+" ["+e+"] "+t)}},g=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].toString(16));return t},v=function(){function e(t,i,r,o,a){n(this,e),this.foreground=t||"white",this.underline=i||!1,this.italics=r||!1,this.background=o||"black",this.flash=a||!1}return r(e,[{key:"reset",value:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}},{key:"setStyles",value:function(e){for(var t=["foreground","underline","italics","background","flash"],i=0;i<t.length;i++){var n=t[i];e.hasOwnProperty(n)&&(this[n]=e[n])}}},{key:"isDefault",value:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}},{key:"equals",value:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}},{key:"copy",value:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}},{key:"toString",value:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]),e}(),m=function(){function e(t,i,r,o,a,s){n(this,e),this.uchar=t||" ",this.penState=new v(i,r,o,a,s)}return r(e,[{key:"reset",value:function(){this.uchar=" ",this.penState.reset()}},{key:"setChar",value:function(e,t){this.uchar=e,this.penState.copy(t)}},{key:"setPenState",value:function(e){this.penState.copy(e)}},{key:"equals",value:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}},{key:"copy",value:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)}},{key:"isEmpty",value:function(){return" "===this.uchar&&this.penState.isDefault()}}]),e}(),y=function(){function e(){n(this,e),this.chars=[];for(var t=0;t<l;t++)this.chars.push(new m);this.pos=0,this.currPenState=new v}return r(e,[{key:"equals",value:function(e){for(var t=!0,i=0;i<l;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<l;t++)this.chars[t].copy(e.chars[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<l;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}},{key:"setCursor",value:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(p.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>l&&(p.log("ERROR","Too large cursor position "+this.pos),this.pos=l)}},{key:"moveCursor",value:function(e){var t=this.pos+e;if(e>1)for(var i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)}},{key:"backSpace",value:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function(e){e>=144&&this.backSpace();var t=a(e);return this.pos>=l?void p.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),void this.moveCursor(1))}},{key:"clearFromPos",value:function(e){var t;for(t=e;t<l;t++)this.chars[t].reset()}},{key:"clear",value:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}},{key:"clearToEndOfRow",value:function(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function(){for(var e=[],t=!0,i=0;i<l;i++){var n=this.chars[i].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")}},{key:"setPenStyles",value:function(e){this.currPenState.setStyles(e);var t=this.chars[this.pos];t.setPenState(this.currPenState)}}]),e}(),b=function(){function e(){n(this,e),this.rows=[];for(var t=0;t<s;t++)this.rows.push(new y);this.currRow=s-1,this.nrRollUpRows=null,this.reset()}return r(e,[{key:"reset",value:function(){for(var e=0;e<s;e++)this.rows[e].clear();this.currRow=s-1}},{key:"equals",value:function(e){for(var t=!0,i=0;i<s;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<s;t++)this.rows[t].copy(e.rows[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<s;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}},{key:"backSpace",value:function(){var e=this.rows[this.currRow];e.backSpace()}},{key:"clearToEndOfRow",value:function(){var e=this.rows[this.currRow];e.clearToEndOfRow()}},{key:"insertChar",value:function(e){var t=this.rows[this.currRow];t.insertChar(e)}},{key:"setPen",value:function(e){var t=this.rows[this.currRow];t.setPenStyles(e)}},{key:"moveCursor",value:function(e){var t=this.rows[this.currRow];t.moveCursor(e)}},{key:"setCursor",value:function(e){p.log("INFO","setCursor: "+e);var t=this.rows[this.currRow];t.setCursor(e)}},{key:"setPAC",value:function(e,t){p.log("INFO","pacData = "+JSON.stringify(e));var i=e.row-1;if(this.nrRollUpRows&&i<this.nrRollUpRows-1&&(i=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==i){for(var n=0;n<s;n++)this.rows[n].clear();var r=this.currRow+1-this.nrRollUpRows,o=t.rows[r].cueStartTime;if(o&&o<p.time)for(n=0;n<this.nrRollUpRows;n++)this.rows[i-this.nrRollUpRows+n+1].copy(t.rows[r+n])}this.currRow=i;var a=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,d=Math.max(l-1,0);a.setCursor(e.indent),e.color=a.chars[d].penState.foreground}var u={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(u)}},{key:"setBkgData",value:function(e){p.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}},{key:"setRollUpRows",value:function(e){this.nrRollUpRows=e}},{key:"rollUp",value:function(){if(null===this.nrRollUpRows)return void p.log("DEBUG","roll_up but nrRollUpRows not set yet");p.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),p.log("INFO","Rolling up")}},{key:"getDisplayText",value:function(e){e=e||!1;for(var t=[],i="",n=-1,r=0;r<s;r++){var o=this.rows[r].getTextString();o&&(n=r+1,e?t.push("Row "+n+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i}},{key:"getTextAndFormat",value:function(){return this.rows}}]),e}(),w=function(){function e(t,i){n(this,e),this.chNr=t,this.outputFilter=i,this.mode=null,this.verbose=0,this.displayedMemory=new b,this.nonDisplayedMemory=new b,this.lastOutputScreen=new b,this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return r(e,[{key:"reset",value:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null}},{key:"getHandler",value:function(){return this.outputFilter}},{key:"setHandler",value:function(e){this.outputFilter=e}},{key:"setPAC",value:function(e){this.writeScreen.setPAC(e,this.lastOutputScreen)}},{key:"setBkgData",value:function(e){this.writeScreen.setBkgData(e)}},{key:"setMode",value:function(e){e!==this.mode&&(this.mode=e,p.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset(),this.lastOutputScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}},{key:"insertChars",value:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";p.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(p.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}},{key:"ccRCL",value:function(){p.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function(){p.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}},{key:"ccAOF",value:function(){}},{key:"ccAON",value:function(){}},{key:"ccDER",value:function(){p.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}},{key:"ccRU",value:function(e){p.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),
this.writeScreen.setRollUpRows(e)}},{key:"ccFON",value:function(){p.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})}},{key:"ccRDC",value:function(){p.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function(){p.log("INFO","TR"),this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function(){p.log("INFO","RTD"),this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function(){p.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()}},{key:"ccCR",value:function(){p.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()}},{key:"ccENM",value:function(){p.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function(){if(p.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,p.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()}},{key:"ccTO",value:function(e){p.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}},{key:"ccMIDROW",value:function(e){var t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{var i=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[i]}p.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}},{key:"outputDataUpdate",value:function(){var e=p.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}},{key:"cueSplitAtTime",value:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}]),e}(),E=function(){function e(t,i,r){n(this,e),this.field=t||1,this.outputs=[i,r],this.channels=[new w(1,i),new w(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return r(e,[{key:"getHandler",value:function(e){return this.channels[e].getHandler()}},{key:"setHandler",value:function(e,t){this.channels[e].setHandler(t)}},{key:"addData",value:function(e,t){var i,n,r,o=!1;this.lastTime=e,p.setTime(e);for(var a=0;a<t.length;a+=2)if(n=127&t[a],r=127&t[a+1],0!==n||0!==r){if(p.log("DATA","["+g([t[a],t[a+1]])+"] -> ("+g([n,r])+")"),i=this.parseCmd(n,r),i||(i=this.parseMidrow(n,r)),i||(i=this.parsePAC(n,r)),i||(i=this.parseBackgroundAttributes(n,r)),!i&&(o=this.parseChars(n,r)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(o)}else p.log("WARNING","No channel found yet. TEXT-MODE?");i?this.dataCounters.cmd+=2:o?this.dataCounters.char+=2:(this.dataCounters.other+=2,p.log("WARNING","Couldn't parse cleaned data "+g([n,r])+" orig: "+g([t[a],t[a+1]])))}else this.dataCounters.padding+=2}},{key:"parseCmd",value:function(e,t){var i=null,n=(20===e||28===e)&&32<=t&&t<=47,r=(23===e||31===e)&&33<=t&&t<=35;if(!n&&!r)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,p.log("DEBUG","Repeated command ("+g([e,t])+") is dropped"),!0;i=20===e||23===e?1:2;var o=this.channels[i-1];return 20===e||28===e?32===t?o.ccRCL():33===t?o.ccBS():34===t?o.ccAOF():35===t?o.ccAON():36===t?o.ccDER():37===t?o.ccRU(2):38===t?o.ccRU(3):39===t?o.ccRU(4):40===t?o.ccFON():41===t?o.ccRDC():42===t?o.ccTR():43===t?o.ccRTD():44===t?o.ccEDM():45===t?o.ccCR():46===t?o.ccENM():47===t&&o.ccEOC():o.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0}},{key:"parseMidrow",value:function(e,t){var i=null;if((17===e||25===e)&&32<=t&&t<=47){if(i=17===e?1:2,i!==this.currChNr)return p.log("ERROR","Mismatch channel in midrow parsing"),!1;var n=this.channels[i-1];return n.ccMIDROW(t),p.log("DEBUG","MIDROW ("+g([e,t])+")"),!0}return!1}},{key:"parsePAC",value:function(e,t){var i=null,n=null,r=(17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127,o=(16===e||24===e)&&64<=t&&t<=95;if(!r&&!o)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;i=e<=23?1:2,n=64<=t&&t<=95?1===i?d[e]:c[e]:1===i?u[e]:f[e];var a=this.interpretPAC(n,t),s=this.channels[i-1];return s.setPAC(a),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0}},{key:"interpretPAC",value:function(e,t){var i=t,n={color:null,italics:!1,indent:null,underline:!1,row:e};return i=t>95?t-96:t-64,n.underline=1===(1&i),i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((i-16)/2),n}},{key:"parseChars",value:function(e,t){var i=null,n=null,r=null;if(e>=25?(i=2,r=e-8):(i=1,r=e),17<=r&&r<=19){var o=t;o=17===r?t+80:18===r?t+112:t+144,p.log("INFO","Special char '"+a(o)+"' in channel "+i),n=[o]}else 32<=e&&e<=127&&(n=0===t?[e]:[e,t]);if(n){var s=g(n);p.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n}},{key:"parseBackgroundAttributes",value:function(e,t){var i,n,r,o,a=(16===e||24===e)&&32<=t&&t<=47,s=(23===e||31===e)&&45<=t&&t<=47;return!(!a&&!s)&&(i={},16===e||24===e?(n=Math.floor((t-32)/2),i.background=h[n],t%2===1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0)),r=e<24?1:2,o=this.channels[r-1],o.setBkgData(i),this.lastCmdA=null,this.lastCmdB=null,!0)}},{key:"reset",value:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null}},{key:"cueSplitAtTime",value:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}}]),e}();i.default=E},{}],43:[function(e,t,i){"use strict";var n={newCue:function(e,t,i,n){for(var r,o,a,s,l,d=window.VTTCue||window.TextTrackCue,u=0;u<n.rows.length;u++)if(r=n.rows[u],a=!0,s=0,l="",!r.isEmpty()){for(var c=0;c<r.chars.length;c++)r.chars[c].uchar.match(/\s/)&&a?s++:(l+=r.chars[c].uchar,a=!1);r.cueStartTime=t,o=new d(t,i,l.trim()),s>=16?s--:s++,navigator.userAgent.match(/Firefox\//)?o.line=u+1:o.line=u>7?u-2:u+1,o.align="left",o.position=Math.max(0,Math.min(100,100*(s/32)+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(o)}}};t.exports=n},{}],44:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return r(e,[{key:"sample",value:function(e,t){var i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();i.default=o},{}],45:[function(e,t,i){"use strict";function n(){}function r(e,t){return t="["+e+"] > "+t}function o(e){var t=self.console[e];return t?function(){for(var i=arguments.length,n=Array(i),o=0;o<i;o++)n[o]=arguments[o];n[0]&&(n[0]=r(e,n[0])),t.apply(self.console,n)}:n}function a(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];i.forEach(function(t){d[t]=e[t]?e[t].bind(e):o(t)})}Object.defineProperty(i,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l={trace:n,debug:n,log:n,warn:n,info:n,error:n},d=l;i.enableLogs=function(e){if(e===!0||"object"===("undefined"==typeof e?"undefined":s(e))){a(e,"debug","log","info","warn","error");try{d.log()}catch(e){d=l}}else d=l},i.logger=d},{}],46:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"toString",value:function(e){for(var t="",i=e.length,n=0;n<i;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t}}]),e}();i.default=o},{}],47:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e(45),a=function(){function e(t){n(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return r(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(e,t,i){this.context=e,this.config=t,this.callbacks=i,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest,e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.open("GET",t.url,!0),t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.responseType=t.responseType;var i=this.stats;i.tfirst=0,i.loaded=0,this.xhrSetup&&this.xhrSetup(e,t.url),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"readystatechange",value:function(e){var t=e.currentTarget,i=t.readyState,n=this.stats,r=this.context,a=this.config;if(!n.aborted&&i>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest)),4===i){var s=t.status;if(s>=200&&s<300){n.tload=Math.max(n.tfirst,performance.now());var l=void 0,d=void 0;"arraybuffer"===r.responseType?(l=t.response,d=l.byteLength):(l=t.responseText,d=l.length),n.loaded=n.total=d;var u={url:t.responseURL,data:l};this.callbacks.onSuccess(u,n,r)}else n.retry>=a.maxRetry||s>=400&&s<499?(o.logger.error(s+" while loading "+r.url),this.callbacks.onError({code:s,text:t.statusText},r)):(o.logger.warn(s+" while loading "+r.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)}},{key:"loadtimeout",value:function(){o.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context)}},{key:"loadprogress",value:function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total);var i=this.callbacks.onProgress;i&&i(t,this.context,null)}}]),e}();i.default=a},{45:45}]},{},[33])(33)}),define("fly/utils/string-helper-1.0",["jquery"],function(e){return{capitalize:function(e){return e.replace(/\b[a-z]/g,function(e){return e.toUpperCase()})},lowerFirst:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},toBool:function(e){return e===!0||"true"===e||"1"===e},toCleanArray:function(t,i){return i=i||",",t="string"==typeof t?e.map(t.split(i),e.trim):e.makeArray(t),t=e.grep(t,function(e){return e})},toCamelCase:function(e,t){return t=t||"-",e.replace(new RegExp("(\\"+t+"[a-z])","g"),function(e){return e.toUpperCase().replace(t,"")})},fromCamelCase:function(e,t){return t=t||"-",e.replace(/[A-Z]/g,function(e){return t+e.toLowerCase()})},toEventName:function(e){return e.replace(/^on([A-Z])/,function(e){return e.charAt(2).toLowerCase()})},isEventOption:function(e){return/^on([A-Z])/.test(e)}}}),define("fly/utils/url-helper-1.0",["jquery"],function(e){return{getParam:function(e){var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href);return t?t[1]:null},getParamAsArray:function(e){var t=this.getParam(e);return t?t.split(","):null},getAllParams:function(){var e=window.location.search.substring(1),t=e.split("&"),i={};if(""===e)return{};for(var n=0;n<t.length;n++){var r=t[n].split("=");i[unescape(r[0])]=unescape(r[1])}return i},getHashParam:function(e){var t=window.location.hash.substring(1),i="",n="";if(t.indexOf(e)!=-1){if(i=t.substring(t.indexOf(e)),i.indexOf("&")!=-1){var r=i.split("&");n=r[0].split("=")}else n=i.split("=");return n[1]}return!1},paramExists:function(e){return!!window.location.href.match("[\\?&]"+e+"([=&#]|$)")}}}),define("fly/libs/jquery.cookie-1.2",["jquery"],function(e){function t(e){return e}function i(e){return decodeURIComponent(e.replace(n," "))}var n=/\+/g;e.cookie=function(n,r,o){if(void 0!==r&&!/Object/.test(Object.prototype.toString.call(r))){if(o=e.extend({},e.cookie.defaults,o),null===r&&(o.expires=-1),"number"==typeof o.expires){var a=o.expires,s=o.expires=new Date;s.setDate(s.getDate()+a)}return r=String(r),document.cookie=[encodeURIComponent(n),"=",o.raw?r:encodeURIComponent(r),o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}o=r||e.cookie.defaults||{};for(var l,d=o.raw?t:i,u=document.cookie.split("; "),c=0;l=u[c]&&u[c].split("=");c++)if(d(l.shift())===n)return d(l.join("="));return null},e.cookie.defaults={},e.removeCookie=function(t,i){return null!==e.cookie(t,i)&&(e.cookie(t,null,i),!0)}}),define("fly/managers/cookie-1.0",["jquery","fly/libs/jquery.cookie-1.2"],function(e){var t={domains:{default:null}};return{init:function(e){this.setConfig(e)},setConfig:function(i){e.isPlainObject(i)&&e.extend(t,i)},set:function(i,n,r){r=r||{},(e.isPlainObject(n)||e.isArray(n))&&(n=JSON.stringify(n)),r.domain?r.domain in t.domains&&(r.domain=t.domains[r.domain]):r.domain=t.domains.default,r.domain||delete r.domain,e.cookie(i,n,r)},get:function(t){var i,n=e.cookie(t);try{i=e.parseJSON(n)}catch(e){i=n}return i},remove:function(t,i){e.removeCookie(t,i)}}}),define("fly/managers/debug-1.0",["jquery","module","version!fly/utils/string-helper","version!fly/utils/url-helper","version!fly/managers/cookie"],function(e,t,i,n,r){var o,a,s,l={},d={queryParam:"jsDebug",cookie:{name:"fly_js_debug",domain:"default"}},u=!1,c=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};return e.extend(d,t.config()),a=n.getParamAsArray(d.queryParam),a?r.set(d.cookie.name,a,{path:"/",domain:d.cookie.domain}):s=r.get(d.cookie.name)||[],(e.inArray("true",a)>-1||e.inArray("all",a)>-1)&&(r.set(d.cookie.name,!0,{path:"/",domain:d.cookie.domain}),u=!0),o=function(t){this.name=t,this.color="hsl("+c(0,360)+","+c(35,80)+"%,"+c(20,45)+"%)",(s===!0||e.inArray(this.name,a)>-1||e.inArray(this.name,s)>-1)&&this.enable()},o.prototype={constructor:o,enabled:!1,log:function(){var e,t=arguments;if(window.console&&(this.enabled||u))return t.callee=t.callee.caller,e=[].slice.call(t),e.unshift("%c "+this.name+" ","color:#fff;border-radius:3px;background-color:"+this.color+";"),"object"==typeof console.log||console.log.apply(console,e),this},enable:function(){return this.enabled=!0,this},disable:function(){return this.enabled=!1,this}},{init:function(e){var t=new o(e);return l[e]=t,t},get:function(e){return l[e]||this.init(e)}}}),define("fly/utils/data-prefix-1.0",["jquery","version!fly/utils/string-helper"],function(e,t){var i=function(i,n){var r=e(this),o=r.data(n),a={};if(i)return e.each(o,function(e,n){0===e.indexOf(i)&&(e=e.substr(i.length),a[t.lowerFirst(e)]=n)}),a};return e.fn.dataPrefix=i,i}),define("fly/libs/jquery.widget-1.9.2",["jquery"],function(e){var t=0,i=Array.prototype.slice,n=e.cleanData;e.cleanData=function(t){for(var i,r=0;null!=(i=t[r]);r++)try{e(i).triggerHandler("remove")}catch(e){}n(t)},e.widget=function(t,i,n){var r,o,a,s,l=t.split(".")[0];t=t.split(".")[1],r=l+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[l]=e[l]||{},o=e[l][t],a=e[l][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,o,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),s=new i,s.options=e.widget.extend({},s.options),e.each(n,function(t,r){e.isFunction(r)&&(n[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;return this._super=e,this._superApply=n,t=r.apply(this,arguments),this._super=i,this._superApply=o,t}}())}),a.prototype=e.widget.extend(s,{widgetEventPrefix:o?s.widgetEventPrefix:t},n,{constructor:a,namespace:l,widgetName:t,widgetBaseClass:r,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,a,i._proto)}),delete o._childConstructors):i._childConstructors.push(a),e.widget.bridge(t,a)},e.widget.extend=function(t){for(var n,r,o=i.call(arguments,1),a=0,s=o.length;a<s;a++)for(n in o[a])r=o[a][n],void 0!==r&&(e.isPlainObject(r)?t[n]=e.isPlainObject(t[n])?e.widget.extend({},t[n],r):e.widget.extend({},r):t[n]=r);return t},e.widget.bridge=function(t,n){var r=n.prototype.widgetFullName||t;e.fn[t]=function(o){var a="string"==typeof o,s=i.call(arguments,1),l=this;return o=!a&&s.length?e.widget.extend.apply(null,[o].concat(s)):o,a?this.each(function(){var i,n=e.data(this,r);return n?e.isFunction(n[o])&&"_"!==o.charAt(0)?(i=n[o].apply(n,s),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}):this.each(function(){var t=e.data(this,r);t?t.option(o||{})._init():e.data(this,r,new n(o,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetName,this),e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var n,r,o,a=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(a={},n=t.split("."),t=n.shift(),n.length){for(r=a[t]=e.widget.extend({},this.options[t]),o=0;o<n.length-1;o++)r[n[o]]=r[n[o]]||{},r=r[n[o]];if(t=n.pop(),void 0===i)return void 0===r[t]?null:r[t];r[t]=i}else{if(void 0===i)return void 0===this.options[t]?null:this.options[t];a[t]=i}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,i,n){var r,o=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=r=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,r=this.widget()),e.each(n,function(n,a){function s(){if(t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof a?o[a]:a).apply(o,arguments)}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=n.match(/^(\w+)\s*(.*)$/),d=l[1]+o.eventNamespace,u=l[2];u?r.delegate(u,d,s):i.bind(d,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var r,o,a=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(r in o)r in i||(i[r]=o[r]);return this.element.trigger(i,n),!(e.isFunction(a)&&a.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,r,o){"string"==typeof r&&(r={effect:r});var a,s=r?r===!0||"number"==typeof r?i:r.effect||i:t;r=r||{},"number"==typeof r&&(r={duration:r}),a=!e.isEmptyObject(r),r.complete=o,r.delay&&n.delay(r.delay),a&&e.effects&&(e.effects.effect[s]||e.uiBackCompat!==!1&&e.effects[s])?n[t](r):s!==t&&n[s]?n[s](r.duration,r.easing,o):n.queue(function(i){e(this)[t](),o&&o.call(n[0]),i()})}}),e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})}),define("fly/components/base-1.0",["jquery","version!fly/utils/data-prefix","version!fly/libs/jquery.widget"],function(e){var t={},i={},n={setDefaultOptions:function(i,n){"string"==typeof i?(t[i]=t[i]||{},e.extend(!0,t[i],n)):e.extend(!0,t,i)},addDefaultEvents:function(i,r){var o;"string"==typeof i?(t[i]=t[i]||{},n.addDefaultEvent(i,r)):(o=i,e.each(o,function(e,t){n.addDefaultEvent(e,t)}))},addDefaultEvent:function(e,t){i[e]=i[e]||[],i[e].push(t)}};return e.widget("fly.base",{options:{defaultsDisabled:!1,defaultOptionsDisabled:!1,defaultEventsDisabled:!1},_setup:function(){var t=this,n=i[this.widgetName]||[];this.$element=this.element,this.$document=this.document,this.$window=this.window,n.length&&e.each(n,function(i,n){var r={};e.each(n,function(e,i){r[(t.widgetEventPrefix+e).toLowerCase()]=i}),t.$element.on(r)})},_getCreateOptions:function(){var t=this.getDefaultOptions(),i=this.getDataOptions(this.element);return e.extend(!0,{},t,i)},getDefaultOptions:function(){var e=this.options,i={};return e.defaultsDisabled||e.defaultOptionsDisabled||(i=t[this.widgetName]||{}),i},getDataOptions:function(e,t){var i;return t=t||this.widgetName,i=e.data(t+"Options")||e.dataPrefix(t)},_triggerGlobal:function(e,t){this.$document.trigger(e,t)},_create:function(){this.$element=this.element},setOptionsFromData:function(){}}),n}),define("components/video/hls-wrapper",["jquery","version!mpx/libs/hls","version!fly/managers/debug","version!fly/components/base"],function(e,t,i){var n=i.init("hlsWrapper");n.log("starting widget"),e.widget("cbsnews.hlsWrapper",e.fly.base,{hls:null,hiddenName:null,visibilityChangeName:null,visibilityState:null,pageVisibilitySupported:null,_create:function(){var i=this,r=this.element,o=r[0];return this.initPageVisibility()&&document.addEventListener(this.visibilityChangeName,e.proxy(this.onPageVisibilityChange,this),!1),setInterval(function(){i.togglePlayback(r.is(":hidden"))},1e3),"VIDEO"!==o.nodeName?void n.log("not a video tag"):o.canPlayType("application/vnd.apple.mpegURL")?void n.log("Native HLS playback supported"):t.isSupported()?(this.hls=new t,this.hls.loadSource(o.getAttribute("src")),this.hls.attachMedia(o),this.hls.on(t.Events.MANIFEST_PARSED,function(){i.togglePlayback(!0)}),void this.hls.on(t.Events.ERROR,function(e,r){if(r.fatal)switch(r.type){case t.ErrorTypes.NETWORK_ERROR:n.log("fatal network error encountered, try to recover"),i.hls.startLoad();break;case t.ErrorTypes.MEDIA_ERROR:n.log("fatal media error encountered, try to recover"),i.hls.recoverMediaError();break;default:i.hls.destroy()}})):void n.log("Hls.js not supported")},togglePlayback:function(e){var t=this.element[0];e||this.isPageHidden()?t.paused||(n.log("Pause video",t),t.pause(),this.hls&&this.hls.stopLoad()):t.paused&&(n.log("Play video",t),setTimeout(function(){t.play()},150),this.hls&&this.hls.startLoad(-1))},initPageVisibility:function(){return this.hiddenName&&this.visibilityChangeName||("undefined"!=typeof document.hidden?(this.hiddenName="hidden",this.visibilityChangeName="visibilitychange",this.visibilityStateName="visibilityState",this.pageVisibilitySupported=!0):"undefined"!=typeof document.webkitHidden?(this.hiddenName="webkitHidden",this.visibilityChangeName="webkitvisibilitychange",this.visibilityStateName="webkitVisibilityState",this.pageVisibilitySupported=!0):this.pageVisibilitySupported=!1),this.pageVisibilitySupported},isPageHidden:function(){return!(!this.pageVisibilitySupported||"visible"==document[this.visibilityStateName]||!document[this.hiddenName])},onPageVisibilityChange:function(e){n.log("Page is",document[this.hiddenName]?"hidden":"visible"),this.togglePlayback(document[this.hiddenName])}})}),!function(){"use strict";function e(e,t,i){"addEventListener"in window?e.addEventListener(t,i,!1):"attachEvent"in window&&e.attachEvent("on"+t,i)}function t(){var e,t=["moz","webkit","o","ms"];for(e=0;e<t.length&&!_;e+=1)_=window[t[e]+"RequestAnimationFrame"];_||i(" RequestAnimationFrame not supported")}function i(e){S.log&&"object"==typeof console&&console.log(y+"[Host page"+w+"]"+e)}function n(e){function t(){function e(){s(_),o(),S.resizedCallback(_)}l(e,_,"resetPage")}function n(e){var t=e.id;i(" Removing iFrame: "+t),e.parentNode.removeChild(e),S.closedCallback(t),i(" --")}function r(){var e=E.substr(b).split(":");return{iframe:document.getElementById(e[0]),id:e[0],height:e[1],width:e[2],type:e[3]}}function d(e){var t=Number(S["max"+e]),n=Number(S["min"+e]),r=e.toLowerCase(),o=Number(_[r]);if(n>t)throw new Error("Value for min"+e+" can not be greater than max"+e);i(" Checking "+r+" is in range "+n+"-"+t),n>o&&(o=n,i(" Set "+r+" to min value")),o>t&&(o=t,i(" Set "+r+" to max value")),_[r]=""+o}function u(){var t=e.origin,n=_.iframe.src.split("/").slice(0,3).join("/");if(S.checkOrigin&&(i(" Checking connection is from: "+n),""+t!="null"&&t!==n))throw new Error("Unexpected message received from: "+t+" for "+_.iframe.id+". Message was: "+e.data+". This error can be disabled by adding the checkOrigin: false option.");return!0}function c(){return y===(""+E).substr(0,b)}function f(){var e=_.type in{true:1,false:1};return e&&i(" Ignoring init message from meta parent page"),e}function h(){var e=E.substr(E.indexOf(":")+m+6);i(" MessageCallback passed: {iframe: "+_.iframe.id+", message: "+e+"}"),S.messageCallback({iframe:_.iframe,message:e}),i(" --")}function p(){if(null===_.iframe)throw new Error("iFrame ("+_.id+") does not exist on "+w);return!0}function v(){switch(_.type){case"close":n(_.iframe),S.resizedCallback(_);break;case"message":h();break;case"reset":a(_);break;case"init":t(),S.initCallback(_.iframe);break;default:t()}}var E=e.data,_={};c()&&(i(" Received: "+E),_=r(),d("Height"),d("Width"),!f()&&p()&&u()&&(v(),g=!1))}function r(){null===E&&(E={x:void 0!==window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop},i(" Get position: "+E.x+","+E.y))}function o(){null!==E&&(window.scrollTo(E.x,E.y),i(" Set position: "+E.x+","+E.y),E=null)}function a(e){function t(){s(e),d("reset","reset",e.iframe)}i(" Size reset requested by "+("init"===e.type?"host page":"iFrame")),r(),l(t,e,"init")}function s(e){function t(t){e.iframe.style[t]=e[t]+"px",i(" IFrame ("+e.iframe.id+") "+t+" set to "+e[t]+"px")}S.sizeHeight&&t("height"),S.sizeWidth&&t("width")}function l(e,t,n){n!==t.type&&_?(i(" Requesting animation frame"),_(e)):e()}function d(e,t,n){i("["+e+"] Sending msg to iframe ("+t+")"),n.contentWindow.postMessage(y+t,"*")}function u(){function t(){function e(e){1/0!==S[e]&&0!==S[e]&&(u.style[e]=S[e]+"px",i(" Set "+e+" = "+S[e]+"px"))}e("maxHeight"),e("minHeight"),e("maxWidth"),e("minWidth")}function n(e){return""===e&&(u.id=e="iFrameResizer"+p++,i(" Added missing iframe ID: "+e)),e}function r(){i(" IFrame scrolling "+(S.scrolling?"enabled":"disabled")+" for "+c),u.style.overflow=!1===S.scrolling?"hidden":"auto",u.scrolling=!1===S.scrolling?"no":"yes"}function o(){("number"==typeof S.bodyMargin||"0"===S.bodyMargin)&&(S.bodyMarginV1=S.bodyMargin,S.bodyMargin=""+S.bodyMargin+"px")}function s(){return c+":"+S.bodyMarginV1+":"+S.sizeWidth+":"+S.log+":"+S.interval+":"+S.enablePublicMethods+":"+S.autoResize+":"+S.bodyMargin+":"+S.heightCalculationMethod+":"+S.bodyBackground+":"+S.bodyPadding+":"+S.tolerance}function l(t){e(u,"load",function(){var e=g;d("iFrame.onload",t,u),!e&&S.heightCalculationMethod in k&&a({iframe:u,height:0,width:0,type:"init"})}),d("init",t,u)}var u=this,c=n(u.id);r(),t(),o(),l(s())}function c(e){if("object"!=typeof e)throw new TypeError("Options is not an object.")}function f(){function e(e){if("IFRAME"!==e.tagName)throw new TypeError("Expected <IFRAME> tag, found <"+e.tagName+">.");u.call(e)}function t(e){e=e||{},c(e);for(var t in T)T.hasOwnProperty(t)&&(S[t]=e.hasOwnProperty(t)?e[t]:T[t])}return function(i,n){t(i),Array.prototype.forEach.call(document.querySelectorAll(n||"iframe"),e)}}function h(e){e.fn.iFrameResize=function(t){return c(t),S=e.extend({},T,t),this.filter("iframe").each(u).end()}}var p=0,g=!0,v="message",m=v.length,y="[iFrameSizer]",b=y.length,w="",E=null,_=window.requestAnimationFrame,k={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},S={},T={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,enablePublicMethods:!1,heightCalculationMethod:"offset",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,closedCallback:function(){},initCallback:function(){},messageCallback:function(){},resizedCallback:function(){}};t(),e(window,"message",n),"jQuery"in window&&h(jQuery),"function"==typeof define&&define.amd?define("libs/iframe-resizer.min",[],function(){
return f()}):window.iFrameResize=f()}(),function(){function e(){n=new t,window.addEventListener("message",n.getMessageFromAd,!1)}function t(){var e=this;e._connections={},e._debug_mode={},window.prGarabageCollect=function(){for(var t in e._connections)e.removeAd(t)},window.prGarbageCollect=function(){for(var t in e._connections)e.removeAd(t)},e.createConnection=function(t){var o=t.id,a=t.index,s=null,l={},d={};if(e.log(o,"attempting to find iframe for connection"),document.getElementById("profr"+o))e.log(o,"pr iframe found, connection in progress"),s=document.getElementById("profr"+o);else for(var u=document.getElementsByTagName("iframe"),c=0;c<u.length;c++)try{u[c].contentWindow.prPlacementId==o&&(e.log(o,"non-pr iframe found with matching prPlacementId, connection in progress"),s=u[c])}catch(t){e.error(o,"no iframe contentWindow['prPlacementId'] found")}if(null!=s){e.log(o,"connection listeners and callbacks initialized, connection complete"),e._connections[o]=new i(o,s);for(var f in e._connections[o]._iframe.getBoundingClientRect())l[f]=e._connections[o]._iframe.getBoundingClientRect()[f];try{d={body:{width:document.body.offsetWidth,height:document.body.offsetHeight},iframe:l,window:{width:r.width.target[r.width.prefix+"Width"],height:r.height.target[r.height.prefix+"Height"]},scroll:{x:window.scrollX,y:window.scrollY}}}catch(t){n.error(e._id,"getBoundingClientRect is not supported by this browser")}window.addEventListener("orientationchange",e._connections[o].getBrowserSize,!1),window.addEventListener("resize",e._connections[o].getBrowserSize,!1),window.addEventListener("scroll",e._connections[o].windowScrollHandler,!1),e._connections[o].setAdSlotTarget(a),e._connections[o].getBrowserSize(),e._connections[o].incrementTrackingCount(),e._connections[o].sendMessageToAd({updatePubPageInfo:d})}else e.error(o,"no pr ad found in any iframe")},e.destroyConnection=function(t){window.removeEventListener("orientationchange",e._connections[t].getBrowserSize,!1),window.removeEventListener("resize",e._connections[t].getBrowserSize,!1),window.removeEventListener("scroll",e._connections[t].windowScrollHandler,!1),e._connections[t].removeAllListeners()},e.error=function(t,i){e._debug_mode[t]&&console.log("prPubConnection error ("+t+") - "+i)},e.getMessageFromAd=function(t){var i,n,o;try{i=JSON.parse(t.data),n=i.id,o=i.messages}catch(e){return}null==r&&(r={},r.width={},r.height={},e.getViewport("Width"),e.getViewport("Height"));for(var a in o){var s=a,l=o[a];if(!(/addCustomStyles/.test(s)||/addDirectStyles/.test(s)||/addListener/.test(s)||/debug/.test(s)||/destroy/.test(s)||/hide/.test(s)||/init/.test(s)||/wrapElements/.test(s)||/overwriteImportantStyles/.test(s)||/remove/.test(s)||/removeListener/.test(s)||/reveal/.test(s)||/setAdOffset/.test(s)||/setAdPosition/.test(s)||/setAdSize/.test(s)||/setAdSlotTarget/.test(s)))return;switch(e.log(n,"message received ("+s+")"),e.log(n,l),s){case"addCustomStyles":e._connections[n].setCustomStyles(l);break;case"addDirectStyles":e._connections[n].setDirectStyles(l);break;case"addListener":e._connections[n].addListener(l);break;case"debug":e.setDebugMode(n,l);break;case"destroy":e.destroyConnection(n);break;case"hide":e._connections[n].hideAd();break;case"init":e.createConnection(l);break;case"wrapElements":e._connections[n].wrapElements(l);break;case"overwriteImportantStyles":e._connections[n].overwriteImportantStyles(l);break;case"remove":e.removeAd(n);break;case"removeListener":e._connections[n].removeListener(l);break;case"reveal":e._connections[n].revealAd();break;case"setAdOffset":e._connections[n].setAdOffset(l);break;case"setAdPosition":e._connections[n].setAdPosition(l);break;case"setAdSize":e._connections[n].setAdSize(l);break;case"setAdSlotTarget":e._connections[n].setAdSlotTarget(l)}}},e.getViewport=function(e){var t=e,i=t.toLowerCase(),n=window.document,o=n.documentElement;if(void 0===window["inner"+t])r[i].target=o,r[i].prefix="client";else if(window["inner"+t]!=o["client"+t]){var a=document.createElement("body");a.id="pr-viewport-test-body",a.style.cssText="overflow: scroll;";var s=document.createElement("div");s.id="pr-viewport-test-div",s.style.cssText="position: absolute; top: -1000px;",s.innerHTML="<style>@media("+i+": "+o["client"+t]+"px){body#pr-viewport-test-body div#pr-viewport-test-div{"+i+": 7px! important}}</style>",a.appendChild(s),o.insertBefore(a,n.head),7==s["offset"+t]?(r[i].target=o,r[i].prefix="client"):(r[i].target=window,r[i].prefix="inner"),o.removeChild(a)}else r[i].target=window,r[i].prefix="inner"},e.log=function(t,i){e._debug_mode[t]&&("string"==typeof i?console.log("prPubConnection log ("+t+") - "+i):console.log(i))},e.removeAd=function(t){e.destroyConnection(t),e._connections[t].removeCustomStyles(),e._connections[t].getAdSlotTarget(e._ad_slot_index).style.height="0px",e._connections[t]._iframe.parentNode.removeChild(e._connections[t]._iframe),delete e._connections[t],delete e._debug_mode[t]},e.setDebugMode=function(t,i){e._debug_mode[t]=i},e.warning=function(t,i){e._debug_mode[t]&&console.log("prPubConnection warning ("+t+") - "+i)}}function i(e,t){var i=this;i._ad_is_shown=!0,i._ad_has_shown=!1,i._ad_slot_height=null,i._ad_slot_index=null,i._ad_slot_target=null,i._ad_styles_applied={},i._id=e,i._iframe=t,i._listeners={},i._tracking_buffer=.5,i._tracking_count=0,i._tracking_timeout=null,i.addListener=function(e){var t,n=e.target,r=e.type;switch(n){case"document":t=document;break;case"window":t=window;break;default:t=document.getElementById(n)}i._listeners[n]||(i._listeners[n]={}),t.addEventListener(r,i.customEventFunction,!1),i._listeners[n][r]="added"},i.applyCustomStyles=function(){var e=i._ad_styles_applied;for(var t in e){var n=i.getAdSlotTarget(parseInt(t)),r=i._ad_styles_applied[t];for(var o in r)n.style[o]=i._ad_styles_applied[t][o]}},i.customEventFunction=function(e){var t,r,o,a={},s={};for(var l in e)a[l]=e[l];switch(a.currentTarget.window?(t=window,r="window"):a.currentTarget.write?(t=document,r="document"):(t=document.getElementById(a.target.id),r=a.target.id),o=a.type,a.currentTarget=null,a.explicitOriginalTarget=null,a.originalTarget=null,a.srcElement=null,a.target=null,a.toElement=null,a.view=null,o){case"resize":a.innerWidth=window.innerWidth,a.innerHeight=window.innerHeight;break;case"scroll":a.scrollX=t.scrollX,a.scrollY=t.scrollY}try{for(var d in i._iframe.getBoundingClientRect())s[d]=i._iframe.getBoundingClientRect()[d];a.rect=s}catch(e){n.error(i._id,"getBoundingClientRect is not supported by this browser")}try{var u=JSON.stringify(a);i.sendMessageToAd({dispatchCustomEvent:{name:"custom"+r+o,event:u}})}catch(e){try{for(var l in a)"string"!=typeof a[l]&&"number"!=typeof a[l]&&"rect"!==l&&delete a[l];var u=JSON.stringify(a);i.sendMessageToAd({dispatchCustomEvent:{name:"custom"+r+o,event:u}})}catch(e){n.error(i._id,"cyclic structure found in listener event object, cannot send event to ad"),n.log(i._id,a)}}},i.getAdSlotSize=function(){var e=i._ad_slot_target.offsetWidth,t=i._ad_slot_target.offsetHeight;i.sendMessageToAd({setAdSlotSize:{width:e,height:t}})},i.getAdSlotTarget=function(e){var t;if(void 0!=e&&null!=e&&""!=e){t=i._iframe;for(var n=0;n<e;n++)t=t.parentNode}else t=i._ad_slot_target;return t},i.getBrowserSize=function(){window.setTimeout(function(){var e=r.width.target[r.width.prefix+"Width"],t=r.height.target[r.height.prefix+"Height"];i.getAdSlotSize(),i.updateBodySize(),i.updateIframeRect(),i.updateWindowSize(),i.sendMessageToAd({browserSizeUpdated:{width:e,height:t}})},0)},i.hideAd=function(){if(window.clearTimeout(i._tracking_timeout),i._tracking_count/1e3<i._tracking_buffer&&(i._tracking_count=i._tracking_buffer,i.sendMessageToAd({fireNonImpression:null})),i._ad_is_shown){i._ad_is_shown=!1;var e=i.getAdSlotTarget(i._ad_slot_index);_ad_slot_height=e.offsetHeight,e.style.height="0px",e.style.overflow="hidden",i.removeCustomStyles()}},i.incrementTrackingCount=function(){i._tracking_count+=10,i._tracking_timeout=window.setTimeout(i.incrementTrackingCount,10)},i.overwriteImportantStyles=function(e){for(var t in e){var i=document.querySelectorAll(t),n=e[t],r="";for(var o in n)r+=o+": "+n[o]+" !important; ";for(var a=0;a<i.length;a++)i[a].style.cssText=r}},i.removeAllListeners=function(){for(var e in i._listeners){var t;switch(e){case"window":t=window;break;case"document":t=document;break;default:t=document.getElementById(e)}for(var n in i._listeners[e])"added"==i._listeners[e][n]&&(t.removeEventListener(n,i.customEventFunction,!1),i._listeners[e][n]="removed")}},i.removeCustomStyles=function(){var e=i._ad_styles_applied;for(var t in e){var n=i.getAdSlotTarget(parseInt(t)),r=i._ad_styles_applied[t];for(var o in r)n.style[o]="initial"}},i.removeListener=function(e){var t,r=e.target,o=e.type;switch(r){case"window":t=window;break;case"document":t=document;break;default:t=document.getElementById(target)}t.removeEventListener(o,i.customEventFunction,!1);try{i._listeners[r][o]="removed"}catch(e){n.error(i._id,"trying to remove event listener that has not yet been added")}},i.revealAd=function(){i._ad_is_shown||(i._ad_is_shown=!0,i.getAdSlotTarget(i._ad_slot_index).style.height=_ad_slot_height+"px"),i.applyCustomStyles()},i.sendMessageToAd=function(e){i._iframe.contentWindow.postMessage(JSON.stringify(e),"*")},i.setAdOffset=function(e){for(var t in e)i._iframe.style[t]=e[t];i.updateIframeRect()},i.setAdPosition=function(e){i._iframe.style.position=e,i.updateIframeRect()},i.setAdSize=function(e){for(var t in e){var n=e[t];i._iframe.setAttribute(t,n.replace(/px/g,"")),i._ad_slot_target.style[t]=n}i.updateIframeRect()},i.setAdSlotTarget=function(e){i._ad_slot_index=parseInt(e),i._ad_slot_target=i._iframe;for(var t=0;t<i._ad_slot_index;t++)i._ad_slot_target=i._ad_slot_target.parentNode},i.setCustomStyles=function(e){var t=i._ad_slot_index,r=i.getAdSlotTarget(t);if(i._ad_is_shown){i._ad_styles_applied[t]||(i._ad_styles_applied[t]={});for(var o in e)i._ad_styles_applied[t][o]=e[o],r.style[o]=e[o]}else n.warning(i._id,"attempting to add custom styles to the ad slot while it is hidden")},i.setDirectStyles=function(e){for(var t in e)for(var i=document.querySelectorAll(t),n=e[t],r=0;r<i.length;r++)for(var o in n)i[r].style[o]=n[o]},i.updateBodySize=function(e){var t={body:{width:document.body.offsetWidth,height:document.body.offsetHeight}};i.sendMessageToAd({updatePubPageInfo:t})},i.updateIframeRect=function(){try{var e={iframe:{}};for(var t in i._iframe.getBoundingClientRect())e.iframe[t]=i._iframe.getBoundingClientRect()[t];i.sendMessageToAd({updatePubPageInfo:e})}catch(e){n.error(i._id,"getBoundingClientRect is not supported by this browser")}},i.updateWindowSize=function(){var e={window:{width:r.width.target[r.width.prefix+"Width"],height:r.height.target[r.height.prefix+"Height"]}};i.sendMessageToAd({updatePubPageInfo:e})},i.windowScrollHandler=function(e){var t={scroll:{x:window.scrollX,y:window.scrollY}};i.sendMessageToAd({updatePubPageInfo:t})},i.wrapElements=function(e){var t,i=e.class||"",n=Array.prototype.slice.call(document.querySelectorAll(e.elements)),r=e.id,o=e.max||n.length,a=e.min||0,s=e.tag,l=e.to;t=s?document.createElement(s):document.createElement("div"),t.id=r,t.className=i;for(var d=a;d<o;d++){var u=n[d];d===a&&u.parentNode.insertBefore(t,u),t.appendChild(u)}l&&document.querySelectorAll(l)[0].appendChild(t)}}var n,r=null;e()}(),!window.console)var console={dir:function(){},info:function(){},log:function(){},warn:function(){}};define("libs/pointroll.resp.lib",function(){}),window.uuid||(window.uuid={}),"undefined"==typeof window.uuid.v4&&(window.uuid.v4=function(){var e,t,i="";for(e=0;e<32;e++)t=16*Math.random()|0,8!=e&&12!=e&&16!=e&&20!=e||(i+="-"),i+=(12==e?4:16==e?3&t|8:t).toString(16);return i}),define("fly/libs/uuid.v4",function(){}),define("fly/managers/gpt-4.2",["jquery","version!fly/utils/string-helper","version!fly/utils/url-helper","version!fly/managers/debug"],function(e,t,i,n){var r={},o=n.get("ads"),a={},s={},l=[],d=[],u=0,c=[],f=[],h="1",p=!1,g=[],v={callbackMethods:{},adDivEventCallbacks:{},setCallback:function(e,t){this.callbackMethods[e]=t},setAdDivEventCallback:function(e,t,i){var n=this.callbackMethods[i];"function"==typeof n&&(o.log("gpt::setAdDivEventCallback:",e,{eventName:t,callbackName:i,callbackMethod:n}),this.adDivEventCallbacks[e]||(this.adDivEventCallbacks[e]={}),this.adDivEventCallbacks[e][t]||(this.adDivEventCallbacks[e][t]=[]),this.adDivEventCallbacks[e][t].push(n))},slotRenderEndedCallBack:function(t){var i=v,n="NOT FOUND";e.each(s,function(e,i){if(i===t.slot)return void(n=e)}),o.log("gpt::slotRenderEndedCallback",{divId:n,event:t});var r=i.adDivEventCallbacks[n]&&i.adDivEventCallbacks[n].slotRenderEnded;if(r){o.log("gpt::slotRenderEndedCallback: calling event callbacks");for(var a=0;a<r.length;a++)r[a](n,t)}}},m=function(e,t,i){if(e&&(t||i)&&(i&&(o.log("gpt::setAdSlotTargeting:","clearing targeting on slot:",e),e.clearTargeting()),t)){o.log("gpt::setAdSlotTargeting:","setting targeting:",t,"on slot:",e);for(var n in t)e.setTargeting(n,t[n])}};return{companionAds:!1,delayIndvAds:!1,init:function(t){if(r={slot:{},adConfig:{},targeting:{}},e.extend(r,t),!this._isClearTargetingOnInitDisabled()){for(var i=0;i<g.length;i++){var n=g[i];googletag.pubads().clearTargeting(n),o.log("gpt::init: clearTargeting:",n)}g=[]}this._initWrappers();var a=null;r.device=r.slotVars.platform;var s="iOS App",l="Android App",d=window.navigator.userAgent;a=d&&d.indexOf&&(d.indexOf(s)!=-1||d.indexOf(l)!=-1)?"app"+r.region:"mobile"==r.device?"m"+r.region:r.region,r.slot="/"+r.slotVars.network+"/"+a+"-"+r.slotVars.siteName+(r.slotVars.topics?"/"+r.slotVars.topics:""),o.log("gpt::init:","Slot:",r.slot)},setSlot:function(e){r.slot=e},createAdSlot:function(i){var n=this;o.log("gpt::createAdSlot","creating adSlot for",i);var d=i.substring(0,i.indexOf("-"+r.containerId));if(r.suppressAds&&(e.inArray(d,r.suppressAds)>-1||e.inArray(d.replace(/-/g,"_"),r.suppressAds)>-1))return void o.log("   in list of suppressed ads, skipping");var u=r.adConfig.adUnits[t.toCamelCase(d,"-")];if(o.log("   adUnit config:",u),!u)return o.log("gpt::createAdSlot:",i,"Error: no adUnit config for this divId"),void(window.console&&window.console.error&&console.error("gpt::createAdSlot:",i,"Error: no adUnit config for this divId"));var c;if(1==u.outOfPage?(c=googletag.defineOutOfPageSlot(r.slot,i),o.log("   create out of page slot")):(c=googletag.defineSlot(r.slot,u.sizes,i),o.log("   create regular slot")),!c)return o.log("gpt::createAdSlot:",i,"Error: failed to create adSlot"),void(window.console&&window.console.error&&console.error("gpt::createAdSlot:",i,"Error: failed to create adSlot"));1==u.isVideo&&(n.companionAds=!0,c.addService(googletag.companionAds()),o.log("   add companionAds service")),c.addService(googletag.pubads()),o.log("   add pubad service"),u.position&&("increment"==u.position?(c.setTargeting("pos",h),o.log("   setTargeting:","pos="+h),h++):(c.setTargeting("pos",u.position),o.log("   setTargeting:","pos="+u.position))),u.customTargeting&&e.each(u.customTargeting,function(e,t){o.log("    setTargeting:",e+"="+t),c.setTargeting(e,t)}),u.disableInitialLoad||u.delayLoad?(n.delayIndvAds=!0,o.log("   delayLoad")):l.push(c);var f=u.collapseEmptyDiv,p=u.collapseEmptyDivOnPageload;f!==!0&&f!==!1||(p===!0||p===!1?(c.setCollapseEmptyDiv(f,p),o.log("   setCollapseEmptyDiv(",f,",",p,")")):(c.setCollapseEmptyDiv(f),o.log("   setCollapseEmptyDiv(",f,")"))),u.eventCallbacks&&e.each(u.eventCallbacks,function(e,t){for(var n=t.split(","),r=0;r<n.length;r++)v.setAdDivEventCallback(i,e,n[r])}),s[i]=c,a[r.containerId]||(a[r.containerId]={}),a[r.containerId][d]||(a[r.containerId][d]=[]),a[r.containerId][d].push(c)},setTargeting:function(e,t){googletag.pubads().setTargeting(e,t),o.log("gpt::setTargeting:",e+"="+t),g.push(e)},displayAds:function(t){var i=this;e.each(t,function(e,t){o.log("gpt::displayAds:",t),i.wrappers.display(t)})},isAsyncInline:function(){var t=r.adDivIds;return"async-inline"==r.adConfig.method&&t&&e.isArray(t)&&(1!=t.length||"ad-div-id-list"!=t[0])},getAdDivIds:function(){var i=this,n=[],a={};if(i.isAsyncInline()){var s=new RegExp("^([\\w\\-]+)\\-"+r.containerId+"(\\-\\d+)?$");return e.each(r.adDivIds,function(e,t){var i;if(i=t.match(s)){var l=i[1];"mobile"!=r.targeting.device&&a[l]?o.log("gpt::getAdDivIds:","skipping divId:",t,"because repeated adUnits are not supported on ",r.targeting.device):(n.push(t),a[l]=1)}else o.log("gpt::getAdDivIds:","skipping divId:",t,"because it does not match:",s,"(async-inline adConfig.adDivIds list was probably not re-initialized with the current divIds)")}),i.adOrder(n)}return e("div[data-ad]").each(function(i,s){var l=e(s).attr("data-ad"),d=e(s).attr("id");if(!r.adConfig.adUnits[t.toCamelCase(l,"-")])return void o.log("gpt::getAdDivIds:","skipping divId:",d,'because there is no config (probably another type of div with "data-ad" attr)');var u=new RegExp(l+"-"+r.containerId+"(\\-\\d+)?$");d.match(u)?"mobile"!=r.targeting.device&&a[l]?o.log("gpt::getAdDivIds:","skipping divId:",d,"because repeated adUnits are not supported on ",r.targeting.device):(n.push(d),a[l]=1):o.log("gpt::getAdDivIds:","skipping divId:",d,"because it does not match:",u,'(was probably already loaded under a different "containerId", or possibly another type of div with "data-ad" attr)')}),i.adOrder(n)},adOrder:function(i){if("undefined"!=typeof r.adConfig.adOrder&&e.isArray(r.adConfig.adOrder)&&i.length>0){var n=r.containerId&&i&&i[0].indexOf("-"+r.containerId)!=-1,a=[];e.each(r.adConfig.adOrder,function(e,i){i=t.fromCamelCase(t.toCamelCase(i,"_"),"-"),n&&(i+="-"+r.containerId),a.push(i)}),e.each(a.reverse(),function(t,n){currentIndex=e.inArray(n,i),currentIndex>-1&&(i.splice(currentIndex,1),i.unshift(n))}),o.log("gpt::adOrder:","ordered divIds",i)}return i},displayInlineAd:function(t){var i=e.inArray(t,c);if(i>-1){if(o.log("gpt::displayInlineAd:",t),this.wrappers.display(t),c.splice(i,1),0==c.length)for(o.log("gpt::displayInlineAd:","running any postDisplayCmds:",f);f.length;)f.shift()()}else o.log("gpt::displayInlineAd:",t,"ERROR: ad was already displayed or should not be displayed at all")},adDisplayTrigger:function(){var t=this;if(o.log("gpt::adDisplayTrigger:","ready to display any inline ads"),e.isArray(window.cbsiGptDivIds))for(o.log("gpt::adDisplayTrigger:","displaying ads for any existing cbsiGptDivIds:",window.cbsiGptDivIds);window.cbsiGptDivIds.length;)t.displayInlineAd(window.cbsiGptDivIds.shift());o.log("gpt::adDisplayTrigger:","setting future cbsiGptDivId ads to display immediately"),window.cbsiGptDivIds={push:t.displayInlineAd}},loadAds:function(){var t=this;return o.log("gpt::loadAds:",r),r.suppressAds&&e.inArray("all",r.suppressAds)>-1?void o.log('gpt::loadAds: not loading any ads because "suppressAds" contains "all"'):"async"==r.adConfig.method||t.isAsyncInline()?(t.isAsyncInline()&&(c=r.adDivIds.slice()),u++,d.push(r.containerId),l=[],r.adConfig.disableInitialLoadCompanions===!0&&e.each(r.adConfig.adUnits,function(e,t){t.isVideo&&(t.disableInitialLoad=!0)}),googletag=window.googletag||{},googletag.cmd=googletag.cmd||[],void googletag.cmd.push(function(){var i=t.getAdDivIds();if(o.log("gpt::loadAds","adDivIds:",i),e.each(i,function(e,i){t.createAdSlot(i)}),e.each(r.targeting,function(e,i){t.setTargeting(e,i)}),1==t.companionAds&&(null==r.adConfig.setRefreshUnfilledSlots||r.adConfig.setRefreshUnfilledSlots===!0?(googletag.companionAds().setRefreshUnfilledSlots(!0),o.log("gpt::loadAds","CompanionAds setRefreshUnfilledSlots = true")):(googletag.companionAds().setRefreshUnfilledSlots(!1),o.log("gpt::loadAds","CompanionAds setRefreshUnfilledSlots = false")),r.adConfig.setClearUnfilledSlots===!0&&(googletag.companionAds().setClearUnfilledSlots(!0),o.log("gpt::loadAds","CompanionAds setClearUnfilledSlots = true"))),null!=r.adConfig.enableAsyncRendering&&r.adConfig.enableAsyncRendering!==!0||(googletag.pubads().enableAsyncRendering(),o.log("gpt::loadAds","enableAsyncRendering")),null!=r.adConfig.enableSingleRequest&&r.adConfig.enableSingleRequest!==!0||(googletag.pubads().enableSingleRequest(),o.log("gpt::loadAds","enableSingleRequest")),1==u&&(r.adConfig.collapseEmptyDiv===!0?(googletag.pubads().collapseEmptyDivs(!0),o.log("gpt::loadAds","collapseEmptyDivs before ad fetch")):(googletag.pubads().collapseEmptyDivs(),o.log("gpt::loadAds","collapseEmptyDivs after ad fetch")),r.adConfig.disableInitialLoad!==!0&&1!=t.delayIndvAds&&r.adConfig.disableInitialLoadRefresh!==!0||(googletag.pubads().disableInitialLoad(),p=!0,o.log("gpt::loadAds","disableInitialLoad")),googletag.enableServices(),o.log("gpt::loadAds","enableServices"),googletag.pubads().addEventListener("slotRenderEnded",v.slotRenderEndedCallBack)),t.isAsyncInline()?t.adDisplayTrigger():t.displayAds(i),p&&r.adConfig.disableInitialLoad!==!0){var n=function(){t.wrappers.refresh(l),o.log("gpt::loadAds","refreshing initialLoad ads",l)};t.isAsyncInline()&&c.length>0?f.push(n):n()}})):void o.log("gpt::Unable to load ads as method is not async or async-inline")},registerCallback:function(e,t){v.setCallback(e,t)},refresh:function(i,n,r,l){var u=this;i&&i.length>25&&(i=""),googletag.cmd.push(function(){if(!i&&void 0===n){if(r||l)for(var c in s)m(s[c],r,l);return u.wrappers.refresh(),void o.log("gpt::refresh:","refresh all ads")}if(n){var f=[];e.each(n,function(e,i){f.push(t.fromCamelCase(t.toCamelCase(i,"_"),"-"))}),n=f}var h=[];if(i){if(a[i]){var p=[];p=n?n:Object.keys(a[i]),p=u.adOrder(p),e.each(p,function(e,t){a[i][t]&&(h=h.concat(a[i][t]),o.log("gpt::refresh:",t+"-"+i))})}}else if(n){n=u.adOrder(n);for(var g={},v=d.length-1;v>-1;v--)a[d[v]]&&e.each(n,function(e,t){!g.hasOwnProperty(t)&&a[d[v]][t]&&(g[t]=1,h=h.concat(a[d[v]][t]),o.log("gpt::refresh:",t+"-"+d[v]))})}if(r||l)for(var v=0;v<h.length;v++)m(h[v],r,l);u.wrappers.refresh(h),o.log("gpt::refresh",h)})},refreshLastLoad:function(e,t,i){var n=this;d.length>0&&n.refresh(d[d.length-1],e,t,i)},_isClearTargetingOnInitDisabled:function(){return!0===r.adConfig.disableClearTargetingOnInit},_initWrappers:function(){this.headerBidding.isEnabled()&&(o.log("gpt::_initWrappers","Replacing wrappers"),this.wrappers=this.headerBidding)},wrappers:{display:function(e){o.log("gpt::wrappers.display","Executing the standard ad logic"),googletag.display(e)},refresh:function(e){o.log("gpt::wrappers.refresh","Executing the standard ad logic"),googletag.pubads().refresh(e)}},headerBidding:{isEnabled:function(){return!0===r.adConfig.enableHeaderBidding&&"object"==typeof window.index_headertag_lightspeed&&"function"==typeof window.index_headertag_lightspeed.set_slot_targeting&&"function"==typeof window.index_headertag_lightspeed.add_session_end_hook&&"function"==typeof window.index_headertag_lightspeed.refresh},display:function(t){o.log("gpt::headerBidding.display","Header bidding display() started"),e(window).trigger("gptMgr.headerBiddingDisplayStart"),index_headertag_lightspeed.display(!1,[t]),e(window).trigger("gptMgr.headerBiddingDisplayEnd"),o.log("gpt::headerBidding.display","Header bidding display() completed")},refresh:function(t){o.log("gpt::headerBidding.refresh","Header bidding refresh() started"),e(window).trigger("gptMgr.headerBiddingRefreshStart"),void 0===t&&(t=window.googletag.pubads().getSlots());var i=function(t){return function(){window.index_headertag_lightspeed.set_slot_targeting(t),e(window).trigger("gptMgr.headerBiddingRefreshEnd"),googletag.pubads().refresh(t),o.log("gpt::headerBidding.refresh","Header bidding refresh() completed")}}(t);window.index_headertag_lightspeed.add_session_end_hook(i,!0),window.index_headertag_lightspeed.refresh()}}}}),define("fly/managers/geo-1.0",["jquery","version!fly/managers/cookie"],function(e,t){var i=t.get("fly_geo")||{};return{get:function(e){return i[e]?i[e]:null}}}),define("fly/managers/ad-2.0",["jquery","version!fly/managers/gpt","version!fly/managers/debug","version!fly/managers/geo","version!fly/utils/url-helper","version!fly/libs/jquery.cookie"],function(e,t,i,n,r){var o={data:{},init:function(e){this.data=e,s.log("blueKai::init::data",e)},fire:function(){var t=this;t.data.bkSiteId&&require(["//tags.bkrtx.com/js/bk-coretag.js"],function(){bk_addPageCtx("anon_id",e.cookie("XCLGFbrowser")),e.each(t.data,function(e,t){"bkSiteId"!=e&&"limit"!=e&&bk_addPageCtx(e,t)}),s.log("bluekai fire",t.data),bk_doJSTag(t.data.bkSiteId,t.data.limit),bk_ignore_meta=!0,e("#__bkframe").hide()})}},a=null,s=i.get("ads"),l={debug:i.get("paramMgr"),get:function(t){if(this.debug.log("getting params for",t),t){var i=r.getParamAsArray(t);this.debug.log("url params:",i);var n="fly_params_"+t;return i?(e.cookie(n,JSON.stringify(i),{path:"/"}),this.debug.log("set cookie:",n,i)):r.paramExists(t)?(e.removeCookie(n,{path:"/"}),this.debug.log("deleted cookie:",n)):(i=JSON.parse(e.cookie(n)),this.debug.log("cookie params:",i)),i}}},d={adData:{},adType:null,isCookieLoaded:!1,cookieValues:{},targeting:{},ftagCookieValue:null,getAdType:function(){return!!this.cookieValues&&this.cookieValues.type},getAdRegion:function(){return!!this.cookieValues&&this.cookieValues.region},getSessionTargeting:function(){return!(!this.cookieValues||!this.cookieValues.session)&&this.cookieValues.session},getSubSessionTargeting:function(){return!(!this.cookieValues||!this.cookieValues.subSession)&&this.cookieValues.subSession},getFtagTargeting:function(){return this.ftagCookieValue},isCrossDomain:function(e){e=e.toLowerCase();var t=window.location;return 0==e.search(/https?:\/\//)&&0!=e.search(t.protocol+"//"+t.host+"/")},getCookieDefaults:function(e){var t=e.ad,i={type:t.defaultAdType,region:t[t.defaultAdType].adConfig.defaultRegion};return t.session&&(i.session=this.getSession(t.session)),t.subSession&&(i.subSession=this.getSession(t.subSession,"1234567890")),i},getSession:function(e,t){if(e){var t=t||"abcdefghijklmnopqrstuvwxyz";return e>t.length&&(s.log("ad::getSession:",e,"exceeds the max number of sessions",t.length),e=t.length),t.charAt(Math.floor(Math.random()*e))}},getRegion:function(t,i){var r=t.adConfig.regions||[],o=t.targeting.device||"desktop",a=t.adConfig.deviceRegions&&t.adConfig.deviceRegions[o];if(a&&a.length>0&&(r=a),i=i||n.get("countryCode"),!i&&r.length>0)return void s.log("ad::getRegion: failed to get countryCode from fly geo cookie");for(var l,d=0;d<r.length;d++)if(e.inArray(i,r[d].countries)>-1||e.inArray("all",r[d].countries)>-1){l=r[d].region;break}return l||t.adConfig.defaultRegion},buildCookie:function(e,t){var i=e.ad;t=t||{};var n={};return n.type=t.adType||"gpt",n.region=t.adRegion||this.getRegion(i[n.type],t.adCountry),n.region?((t.adSession||i.session)&&(n.session=t.adSession||this.getSession(i.session)),(t.adSubSession||i.subSession)&&(n.subSession=t.adSubSession||this.getSession(i.subSession,"1234567890")),n):void s.log("ad::buildCookie: failed to determine ad region")},postCookieInit:function(i){var n=i.ad;if(a=this.getAdType(),!a)return s.log("unable to get adtype cookie"),!1;if(s.log("ads::init:","adType",a),n=n[a],!n)return s.log("Can't access adType data for "+a),!1;if(i.ad.useFirstPageTargeting){var r="first_page_today";if(window.firstpgvar=1==window.firstpgvar||null==e.cookie(r)?"1":"0",n.targeting.firstpg=window.firstpgvar,s.log('setting "first page" targeting to:',n.targeting.firstpg),null==e.cookie(r)){var d=new Date,u=Date.UTC(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),this.isEDT(d)?4:5);u+=u>d.getTime()?0:864e5;var c=document.domain.split(".").reverse(),f=c[1]+"."+c[0];e.cookie(r,!1,{path:"/",expires:new Date(u),domain:f}),s.log("set "+r+" cookie to expire at ",new Date(u).toUTCString())}}n.suppressAds=l.get("adSuppress"),s.log("ads::init suppressAds = ",n.suppressAds),n.targeting.vguid=i.viewGuid,s.log("ads::init","vguid",n.targeting.vguid);var h=this.getSessionTargeting(),p=this.getSubSessionTargeting();h&&(n.targeting.session=h),p&&(n.targeting.subses=p);var g=this.getFtagTargeting();if(g&&(n.targeting.ftag=g),e.extend(n.targeting,this.targeting),n.region=this.getAdRegion(),i.ad.blueKai){var v=i.ad.blueKai,m=n.slotVars,y="";n.targeting.device&&"mobile"==n.targeting.device&&(y="m"),v.path=y+n.region+"-"+m.siteName+"/"+m.topics,o.init(v)}"madison"===a?(madisonMgr.init(n),s.log("ads::init:","Initialize Madison",n)):"gpt"===a&&(t.init(n),s.log("ads::init:","Initialize Gpt",n))},loadAds:function(e){(1==e||d.isCookieLoaded)&&(s.log("ads::loadAds:","Loading Gpt"),t.loadAds(),s.log("ads::loadAds:","Finished Loading Gpt"),o.fire())},init:function(t){var i=this,n=t.ad.cookieName;r.getParam("ftag")&&(e.cookie(n+"_ftag",r.getParam("ftag")),i.ftagCookieValue=r.getParam("ftag")),r.getHashParam("ftag")&&(e.cookie(n+"_ftag",r.getHashParam("ftag")),i.ftagCookieValue=r.getHashParam("ftag")),e.cookie(n+"_ftag")&&(i.ftagCookieValue=e.cookie(n+"_ftag"));var o={},a=!1;if(r.getParam("adRegion")&&(o.adRegion=r.getParam("adRegion"),a=!0),r.getParam("adType")&&(o.adType=r.getParam("adType"),a=!0),r.getParam("adCountry")&&(o.adCountry=r.getParam("adCountry"),a=!0),r.getParam("adSession")&&(o.adSession=r.getParam("adSession"),a=!0),r.getParam("adSubses")&&(o.adSubSession=r.getParam("adSubses"),a=!0),r.getParam("adNetwork")&&("7336"==r.getParam("adNetwork")||"8264"==r.getParam("adNetwork"))&&t.ad.gpt&&(t.ad.gpt.slotVars.network=r.getParam("adNetwork")),e.each(r.getAllParams(),function(e,t){var n=e.match(/adTargeting_(.+)/);n&&n[1]&&(i.targeting[n[1]]=t)}),e.cookie(n)&&1!=a)i.cookieValues=JSON.parse(e.cookie(n)),i.postCookieInit(t),i.isCookieLoaded=!0;else{var l=i.buildCookie(t,o);l?(e.cookie(n,JSON.stringify(l),{path:"/"}),i.cookieValues=l,i.postCookieInit(t),i.isCookieLoaded=!0):s.log("ad::init: failed to build cookie")}if(!i.isCookieLoaded){var d={type:"get",data:o,cache:!1},u=t.ad.cookieServicePath||"/ad/ad-cookie/";i.isCrossDomain(u)&&e.extend(d,{jsonp:!1,jsonpCallback:"handleCookie",dataType:"jsonp",timeout:3e3,data:{p:""}}),d.url=u+t.viewGuid,e.ajax(d).done(function(r){s.log("trackingCookie::init","loading json response"),e.cookie(n)||e.cookie(n,JSON.stringify(r),{path:"/"}),i.cookieValues=r,i.postCookieInit(t),i.loadAds(!0)}).fail(function(e,n){s.log("trackingCookie::init","unable to load url",u+t.viewGuid,n),window.console&&window.console.error&&console.error("ads::trackingCookie::init","unable to load url",u+t.viewGuid,n),t.ad.useDefaultsOnCookieError?(s.log("trackingCookie::init","using default cookie values instead"),i.cookieValues=i.getCookieDefaults(t),i.postCookieInit(t),i.loadAds(!0)):s.log("trackingCookie::init","not loading ads")})}},isEDT:function(e){var t=new Date(e.getFullYear(),2,1);t=Date.UTC(t.getUTCFullYear(),2,14-(t.getUTCDay()+13)%7,5);var i=new Date(e.getFullYear(),10,1);return i=Date.UTC(i.getUTCFullYear(),10,7-(i.getUTCDay()+6)%7,4),e.getTime()>=t&&e.getTime()<i}};return{init:function(e){d.init(e)},loadAds:function(){d.loadAds()},getAdObj:function(){if(d.isCookieLoaded)return t},getGptObj:function(){return t},getBlueKaiPath:function(){return t.getBlueKaiPath}}}),function(){"use strict";window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],googletag.cmd.push(function(){if(!(googletag.hasOwnProperty("on")||googletag.hasOwnProperty("off")||googletag.hasOwnProperty("trigger")||googletag.hasOwnProperty("events"))){var e=googletag.debug_log.log,t=[],i=function(e,i,n){t.push({name:e,id:i,match:n})};i("gpt-google_js_loaded",8,/Google service JS loaded/gi),i("gpt-gpt_fetch",46,/Fetching GPT implementation/gi),i("gpt-gpt_fetched",48,/GPT implementation fetched\./gi),i("gpt-page_load_complete",1,/Page load complete/gi),i("gpt-queue_start",31,/^Invoked queued function/gi),i("gpt-service_add_slot",40,/Associated ([\w]*) service with slot ([\/\w]*)/gi),i("gpt-service_add_targeting",88,/Setting targeting attribute ([\w]*) with value ([\w\W]*) for service ([\w]*)/gi),i("gpt-service_collapse_containers_enable",78,/Enabling collapsing of containers when there is no ad content/gi),i("gpt-service_create",35,/Created service: ([\w]*)/gi),i("gpt-service_single_request_mode_enable",63,/Using single request mode to fetch ads/gi),i("gpt-slot_create",2,/Created slot: ([\/\w]*)/gi),
i("gpt-slot_add_targeting",17,/Setting targeting attribute ([\w]*) with value ([\w\W]*) for slot ([\/\w]*)/gi),i("gpt-slot_fill",50,/Calling fillslot/gi),i("gpt-slot_fetch",3,/Fetching ad for slot ([\/\w]*)/gi),i("gpt-slot_receiving",4,/Receiving ad for slot ([\/\w]*)/gi),i("gpt-slot_render_delay",53,/Delaying rendering of ad slot ([\/\w]*) pending loading of the GPT implementation/gi),i("gpt-slot_rendering",5,/^Rendering ad for slot ([\/\w]*)/gi),i("gpt-slot_rendered",6,/Completed rendering ad for slot ([\/\w]*)/gi),i("gpt-refreshing_ads",70,/Refreshing ads/gi),i("gpt-clearing_slot_contents",71,/Clearing slot contents/gi),googletag.events=googletag.events||{},googletag.on=function(e,t,i){if(!t)return this;e=e.split(" ");var n=i?t:void 0,r=i||t,o=0,a="";for(r.data=n,a=e[o=0];o<e.length;a=e[++o])(this.events[a]=this.events[a]||[]).push(r);return this},googletag.off=function(e,t){e=e.split(" ");var i=0,n="",r=0,o=function(){};for(n=e[i];i<e.length;n=e[++i])if(this.events.hasOwnProperty(n))if(t){for(r=this.events[n].length-1,o=this.events[n][r];r>=0;o=this.events[n][--r])o==t&&this.events[n].splice(r,1);0===this.events[n].length&&delete this.events[n]}else delete this.events[n];return this},googletag.trigger=function(e,t){if(!this.events[e]||0===this.events[e].length)return this;var t=t||[],i=0,n=this.events[e][i];for(n;i<this.events[e].length&&n.apply(this,[{data:n.data}].concat(t))!==!1;n=this.events[e][++i]);return this},googletag.debug_log.log=function(i,n,r,o,a){if(n&&n.getMessageId&&"number"==typeof n.getMessageId()){var s=Array.prototype.slice.call(arguments),l=0;for(l;l<t.length;l++)t[l].id===n.getMessageId()&&googletag.trigger(t[l].name,s)}return e.apply(this,arguments)}}})}(),define("libs/xfp-gpt-events",function(){}),define("managers/ad",["jquery","version!fly/managers/ad","version!fly/managers/debug","libs/xfp-gpt-events","tealium"],function(e,t,i){var n=i.init("ads"),r=!1,o=t.getGptObj();e(document).ready(function(){e(".inverse-header, .content-primary-inverse, .elp-header, .hero-48-hours").length>0&&e(".ad-leader-top, .ad-leader-plus-top").addClass("dark-theme"),r||e(".ad-leader-top, .ad-leader-plus-top").addClass("no-mantle-skin"),o&&e('[data-component="imageGallery"], [data-component="mediaPost"]').on("imagegalleryshown mediapostshown",function(){o.setTargeting("vguid",CBSNEWS.tracking.pageViewGuid),o.setTargeting("firstpg","0"),o.refreshLastLoad()})}),!window.addEventListener||window.addEventListener("message",function(e){if(e.origin===window.location.protocol+"//"+window.location.host&&"string"==typeof e.data&&0===e.data.indexOf("nativeAdBlankServed_")){n.log("cbsnews::bidtelect","Message",e);for(var t=window.frames,i=0;i<t.length;i++){var r=t[i];r==e.source.parent&&(n.log("cbsnews::bidtelect","Message received, hide blank iframe",r),r.frameElement.parentNode.style.display="none")}}},!1);var a=function(t,i){n.log("leaderboardTopCallback called with adId:",t);var r=e("#"+t);i.isEmpty?(n.log("empty leader"),r.removeClass("contains-ad"),r.css("display","none")):(n.log("found leader"),r.addClass("contains-ad"),e(".ad-leader-top, .ad-leader-plus-top").css("min-height","0"))},s=function(t){n.log("skinCallback called with adId:",t),"none"!=e("#"+t).css("display")?(n.log("found skin"),r=!0,e(".ad-leader-top, .ad-leader-plus-top").removeClass("no-mantle-skin"),e(".ad-leader-top, .ad-leader-plus-top, .deep-story-header, .deep-story-body .container, .elp-header").addClass("has-mantle-skin")):n.log("empty skin")},l=function(e){if(n.log("marqueeVideoRenderCallback called with slot:",e),!e.is(":visible")){var t='<a href="//www.cbsnews.com/live/?ftag=CNMf880813"><img src="/bundles/cbsnewscore/images/standalone/cbsn-adunit-300x80.jpg"/></a>';n.log("slot is empty, replacing with content:",t),e.html(t),e.show()}};return o.registerCallback("leaderboardTop",a),o.registerCallback("skin",s),n.log('configuring "xfp-gpt-events" event callbacks'),window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],googletag.cmd.push(function(){return googletag.on?(n.log('subscribing to "xfp-gpt-events" event callbacks'),googletag.on("gpt-refreshing_ads",function(t,i,r,o,a,s){n.log("gpt-refreshing_ads callback",t,r,a,s);var d=e("[data-ad=marquee-video-top]");d.length>0&&l(d)}),void googletag.on("gpt-clearing_slot_contents",function(t,i,r,o,a,s){n.log("gpt-clearing_slot_contents callback",t,r,a,s);var d=e("[data-ad=marquee-video-top]");d.length>0&&setTimeout(function(){l(d)},50)})):void n.log('WARNING: "xfp-gpt-events" on() subscribe function does not exist - callbacks not defined')}),t}),define("managers/beanstock-sonobi",["version!fly/managers/gpt","version!fly/managers/debug","version!fly/libs/jquery.cookie"],function(e,t){function i(){!d.adCallsFired&&(d.bidsExpired||d.ixComplete&&d.sbComplete)&&(d.adCallsFired=!0,o(),l.log("adCallsFired"))}function n(e){return function(){l.log(e),d[e]=!0,l.log("status",d),i()}}function r(e,t){var i=document.createElement("script");i.async=!0,i.defer=!0,i.src=e,i.addEventListener("load",n(t)),c.parentNode.insertBefore(i,c)}var o,a,s,l=t.init("beanstock-sonobi"),d={adCallsFired:!1,bidsExpired:!1,ixComplete:!1,sbComplete:!1},u=800,c=document.getElementsByTagName("script")[0];return{init:function(e,t){o=t,l.log("callback",o),a=e.gpt.containerId,l.log("containerId",a),s=e.gpt.targeting.device,l.log("device",s),setTimeout(n("bidsExpired"),u),r("//js-sec.indexww.com/ht/ls-cbsnews.js","ixComplete"),r("//mtrx.go.sonobi.com/morpheus.cbsnews.2652.js","sbComplete")},isEnabled:function(){var e=CBSNEWS.features.beanstockSonobi;return l.log("bsEnabled",e),e}}}),define("managers/click-tracking",["jquery","tealium"],function(e){e(".module-click-tracking").on("click",function(){}),e(".subscribe-button").on("click",function(){var e="mobile"==utag_data.deviceType?"CNI2f17d43":"CNId322db2";om.trackCampaignDriver({intcid:e,campaignType:"all-access",campaignChannel:"locked content",campaignText:utag_data.topicName+";"+utag_data.articleTitle})}),e(".sixty-subscribe-overlay a").on("click",function(){om.trackCampaignDriver({intcid:"CNI0ed2038",campaignType:"all-access",campaignChannel:"locked content",campaignText:utag_data.topicName+";"+utag_data.articleTitle})}),e(".smart-banner--60-minutes #smart-banner--text-container").on("click",function(){var e="mobile"==utag_data.deviceType?"CNIe400434":"CNI17adef7";om.trackCampaignDriver({intcid:e,campaignType:"all-access",campaignChannel:"upsell footerbar",campaignText:"learn more"})}),e(".site-section-tab.sixty-tab-60-minutes-all-access a").on("click",function(){var e="mobile"==utag_data.deviceType?"CNIa25c77d":"CNIaa8c952";om.trackCampaignDriver({intcid:e,campaignType:"all-access",campaignChannel:"navigation bar",campaignText:"60 minutes all access"})}),e("#module-60-minutes-landing-page-cover-flow > li.title > a.cta-primary").on("click",function(){om.trackCampaignDriver({intcid:"CNI49ef995",campaignType:"all-access",campaignChannel:"60 front door",campaignText:"subscribe now"})}),e("#module-sixty-minutes-all-access-promo-mobile a.cta-primary").on("click",function(){om.trackCampaignDriver({intcid:"CNI0ed2038",campaignType:"all-access",campaignChannel:"locked content",campaignText:utag_data.topicName+";"+utag_data.articleTitle})}),e('.to-go a[href*="CNIf15cd3f"]').on("click",function(){om.trackCampaignDriver({intcid:"CNIf15cd3f",campaignType:"all-access",campaignChannel:"60 footer",campaignText:"Introducing CBS All Access"})})}),define("managers/tealium",["jquery","version!fly/managers/debug","fly/libs/uuid.v4","tealium"],function(e,t){var i=(e.support.touch?"vclick":"click",t.get("tealium"));return{trackingData:{},viewGuid:null,resetGuidEnabled:!0,init:function(e){this.trackingData=e,i.log("tealium::init:","loading tracking data",this.trackingData)},explicitTrackView:function(e){var e="undefined"==typeof e?{}:e;utag.view(e)},explicitTrackLink:function(e){var e="undefined"==typeof e?{}:e;utag.link(e)},setViewGuid:function(e){this.viewGuid=e,i.log("tealium::setViewGuid",this.viewGuid)},resetViewGuid:function(){return this.resetGuidEnabled&&(this.viewGuid=uuid.v4()),i.log("tealium::resetViewGuid",this.viewGuid),this.viewGuid},getViewGuid:function(){return this.viewGuid},syncResetViewGuid:function(){var e="";return e=this.resetViewGuid(),this.resetGuidEnabled=!this.resetGuidEnabled,e},getTrackingData:function(){return this.trackingData}}}),define("fly/components/modal-1.0",["jquery","version!fly/components/base"],function(e){var t=e.support.touch?"vclick":"click";e.widget("fly.modal",e.fly.base,{options:{content:null,position:"absolute",classModal:"modal",classBackdrop:"modal-backdrop",classShow:"show",classFixed:"fixed",enableKeyEvents:!0,openOnInit:!1,template:null},$modal:null,$backdrop:null,$body:null,isOpen:!1,eventData:{},_create:function(){var i=this.options,n="fixed"===i.position?" "+i.classFixed:"",r={},o={};this._setup(),this.$modal=this.$element.addClass(i.classModal+n),this.$backdrop=e("<div>").addClass(i.classBackdrop+n),this.$body=e(document.body),this.top=parseInt(this.$modal.css("top"),10),i.content&&this.setContent(i.content),this.eventData={$modal:this.$modal,$backdrop:this.$backdrop},r[t]="_handleClose",o[t+' [data-close="modal"]']="_handleClose",this._on(this.$backdrop,r),this._on(this.$modal,o)},_init:function(){this.options.openOnInit&&this.open()},_handleKeyboard:function(e){27==e.keyCode&&this.close()},_handleClose:function(e){e.preventDefault(),this.close()},open:function(){var e=this.options;this.isOpen||this._trigger("open",null,this.eventData)!==!1&&(this.$backdrop.addClass(e.classShow).appendTo(this.$body),this.$modal.addClass(e.classShow).appendTo(this.$body),this.position(),e.enableKeyEvents&&this._on(this.$document,{keyup:"_handleKeyboard"}),this.isOpen=!0,this._trigger("opened",null,this.eventData))},close:function(){var e=this.options;this.isOpen&&this._trigger("close",null,this.eventData)!==!1&&(this.$backdrop.removeClass(e.classShow),this.$modal.removeClass(e.classShow),this._off(this.$document,"keyup"),this.isOpen=!1,this._trigger("closed",null,this.eventData))},setContent:function(t){var i,n=this.options,r=this,o=e(t);o.hasClass(n.classModal)&&(o.removeClass(n.classModal),i=o.prop("attributes"),e.each(i,function(){"class"===this.name?r.$modal.addClass(this.value):r.$modal.attr(this.name,this.value)}),o=o.children()),this.$modal.empty().append(o),this._trigger("contentSet",null,e.extend({},this.eventData,{$modal:this.$modal,$content:o}))},position:function(){var e=this.options,t=this.$window.height(),i=isNaN(this.top)?(t-this.$modal.outerHeight())/3:this.top;i<20&&(i=20),"absolute"==e.position&&(i+=this.$window.scrollTop(),this.$backdrop.css({height:this.$document.height()})),this.$modal.css({top:i}),this._trigger("positioned",null,{$modal:this.$modal})},_destroy:function(){this.$backdrop.remove()}}),e(document).on(t+".modal-api.data-api",'[data-open="modal"]',function(t){var i=e(this),n=i.data(),r=n.$modal;t.preventDefault(),r||(r=e(n.target||i.attr("href")),i.data("$modal",r)),r.length&&r.modal().modal("open")})}),define("fly/utils/object-helper-1.0",["jquery"],function(e){return{deepFind:function(e,t){if(!e||!t)return null;var n=t.split("."),r=n.length;for(i=0;i<r;i++){if(!e.hasOwnProperty(n[i]))return null;e=e[n[i]]}return e}}}),define("fly/utils/string-vars-1.0",["jquery"],function(e){return{compile:function(t,i,n){var r=this;return"string"!=typeof t?"":(n=e.makeArray(n),t=t.replace(/\{([^}]+)\}/g,function(t){var o=n,a="";return t=t.replace(/\|[^\}|]+/g,function(e){return o.push(e.substr(1)),""}),a=i[t.replace(/[{}]+/g,"")]||"",e.each(o,function(e,t){a=r.modify(t,a)}),a}))},modify:function(e,t){switch(e){case"lower":t=t.toLowerCase();break;case"upper":t=t.toUpperCase();break;case"urlencode":t=encodeURIComponent(t)}return t}}}),define("fly/components/loading-1.0",["jquery","version!fly/utils/string-vars","version!fly/components/base"],function(e,t){e.widget("fly.loading",e.fly.base,{options:{disabled:!1,delay:100,timeout:25e3,initState:"",template:'<div class="{baseClass} {stateClass}"><span class="text">{text}</span></div>',classes:{base:"loader",idle:"",loading:"loading",end:"load-end",error:"load-error"},text:{idle:"",loading:"Loading",end:"The End",error:"Error Encountered :("}},_create:function(){this._setup(),this._state=null,this._timeoutId=null},_init:function(){var e=this.options;!e.disabled&&e.initState&&(this._setContent(e.initState),this._state=e.initState)},_setContent:function(i,n){var r,o=this.options;return"remove"===i?void this.$element.empty():(r=t.compile(o.template,e.extend({state:i,baseClass:o.classes.base,stateClass:o.classes[i],text:o.text[i]},n)),void this.$element.html(r))},add:function(){var t=this.options;this._trigger("add")!==!1&&(this.update("loading"),"number"==typeof t.timeout&&t.timeout>0&&(this._timeoutId=setTimeout(e.proxy(this.remove,this),t.timeout)),this._trigger("added"))},remove:function(){this._trigger("remove")!==!1&&(this.update("remove"),this._trigger("removed"))},update:function(e,t){var i=this.options,n={state:e};this._trigger("update",null,n)!==!1&&(this._state=e,i.disabled||(clearTimeout(this._timeoutId),this._setContent(e,t),this._trigger("updated",null,n)))},isLoading:function(){return"loading"===this._state},getState:function(){return this._state},_setOption:function(e,t){var i=this.options;"data"===e?this.$element.data("data",t):"disabled"===e&&(t===!0?this.$element.empty():this._setContent(i.initState)),this._super(e,t)},_destroy:function(){this.$element.remove()}})}),define("fly/components/modal-async-1.0",["jquery","version!fly/utils/object-helper","version!fly/components/modal","version!fly/components/loading","version!fly/utils/data-prefix"],function(e,t){var i=e.support.touch?"vclick":"click";e.widget("fly.modalAsync",e.fly.modal,{options:{url:null,requestData:{},responseKey:"modal",loader:{disabled:!1}},isContentLoaded:!1,_create:function(){this._super(),this._setupLoader()},open:function(){this.isOpen||(this.isContentLoaded||this.loadContent(),this._super())},_setupLoader:function(){this.loader=e.fly.loading(this.options.loader),this.loader.$element.appendTo(this.$element)},loadContent:function(){var i=this.options,n=this;this.loader.add(),e.ajax({dataType:"json",url:i.url,data:i.requestData}).done(function(r){var o=t.deepFind(r,i.responseKey)||{},a=o.html;return a?(n._trigger("contentLoaded",null,e.extend({},this.eventData,{content:a})),n.isContentLoaded=!0,n.setContent(a),void n.$backdrop.css({height:n.$document.height()})):void n.destroy()}).fail(function(e,t){n.destroy()}).always(function(){n.loader.remove()})},_destroy:function(){this._trigger("destroy"),this._super(),this.$modal.remove()}}),e(document).on(i+".modalAsync-api.data-api",'[data-open="modalAsync"]',function(t){var i,n=e(this),r=n.data(),o=r.$modal;n.data("modalOptions").checkIE?$checkIE=n.data("modalOptions").checkIE:$checkIE=!1,!$checkIE||navigator.appVersion.indexOf("MSIE 8.")==-1&&navigator.appVersion.indexOf("MSIE 7.")==-1?(t.preventDefault(),t.stopImmediatePropagation(),o?o.open():(i=n.data("modalAsyncOptions")||n.dataPrefix("modalAsync"),o=e.fly.modalAsync(e.extend(!0,{},{openOnInit:!0,destroy:function(){n.removeData("$modal")}},i)),n.data("$modal",o))):($url="//"+location.host+n.attr("href"),window.open($url))})}),define("components/modal-homepage",["jquery","version!fly/utils/object-helper","version!fly/components/modal","version!fly/components/loading","version!fly/utils/data-prefix"],function(e){var t=e.support.touch?"vclick":"click";e.widget("fly.modalHomepage",e.fly.modal,{}),e(document).on(t+".modal-api.data-api",'[data-open="modal-homepage"]',function(t){var i=e(this),n=i.data(),r=n.$modal;$html='<div class="modal-wrapper"><div class="modal-header"><button class="close" data-close="modal"><div>&times;</div></button></div><div class="modal-body">',$browser="",navigator.userAgent.toLowerCase().indexOf("firefox")>-1?($browser="Firefox",$instructions='<p>1. Click the menu button and choose "Options" or "Preferences".<br/>2. Select the "General" panel.<br/>3. In the "Home Page" box enter www.cbsnews.com then click OK or just close the window. </p>'):navigator.userAgent.toLowerCase().indexOf("chrome")>-1?($browser="Chrome",$instructions='<p>1. Click on the Chrome menu icon, located in the upper right hand corner of your browser window then select "Settings".<br/>2. Under the "On Startup" click on the "Open a specific page or set of pages" then click on the "Set Pages". <br/>3. Click on the "Use Current" button then click "OK".</p>'):navigator.userAgent.toLowerCase().indexOf("safari")>-1?($browser="Safari",$instructions='<p>1. From the top menu bar, click "Safari." Select "Preferences."<br/>2. On the "General" tab, type www.cbsnews.com in the Homepage entry box and you\'re done.</p>'):(navigator.userAgent.toLowerCase().indexOf("msie")>-1||navigator.userAgent.toLowerCase().indexOf("trident")>-1)&&($browser="Internet Explorer",$instructions='<p>1. Click on the gear icon, located in the upper right hand corner of your browser window then select "Internet Options".<br/>2. Under the "Home Page" box click on the "Use Current" button then click "OK".'),""!=$browser&&($html+="<h3>To make CBS News your homepage in "+$browser+":</h3>"+$instructions+"</div></div>"),t.preventDefault(),r||(r=e(n.target||i.attr("href")),r[0].innerHTML=$html,i.data("$modal",r)),r.length&&r.modal().modal("open")})}),define("components/smart-banner",["jquery","version!fly/managers/debug","version!fly/components/base","version!fly/libs/jquery.cookie"],function(e,t){var i=e(document.documentElement),n=t.init("smartBanner");n.log("starting widget"),e.widget("cbsnews.smartBanner",e.fly.base,{options:{url:null,bannerAnchorSelector:"#smart-banner--text-container",bannerVisibleClass:"smart-banner--visible",bannerHiddenClass:"smart-banner--hidden",cookieName:"smartBannerState",retryDays:7,hideDays:30,hideOnZoom:!0},deviceName:null,isHidden:!1,zoomInterval:null,_create:function(){if(n.log("creating component",this.options),this._isTargetDevice()){this._setup(),this.options.hideOnZoom&&!this._isHidden()&&(this.zoomInterval=setInterval(e.proxy(this._onZoom,this),300));var t=this._url(this.deviceName);n.log("set click url to ",t),this.$element.on("click","a",e.proxy(this._toggleHide,this)).find(this.options.bannerAnchorSelector).attr("href",t),this._show()}},_show:function(){n.log("show component"),null===this.isHidden&&setTimeout(e.proxy(this._setCookie,this,this.options.retryDays),3e4),this._toggleVisibleClass()},_toggleHide:function(){n.log((this.isHidden?"show":"hide")+" component"),this.isHidden=!this.isHidden,this._setCookie(this.options.hideDays),this._toggleVisibleClass(),clearInterval(this.zoomInterval)},_onZoom:function(){var t=this.$element.width()!=e(document).width();t!=this.isHidden&&(n.log("onZoom ",this.isHidden?"show":"hide"," banner"),this._toggleVisibleClass(t))},_setCookie:function(t){n.log("set cookie for "+t+" days"),e.cookie(this.options.cookieName,+this.isHidden,{path:"/",expires:t})},_isTargetDevice:function(){var e=navigator.userAgent.toLowerCase(),t=this.options.url,r=t&&"object"==typeof t&&Object.keys(t).join("|"),o=new RegExp("("+r+")"),a=e.match(o);return r?a?(n.log("detected device as ",a[0]),this.deviceName=a[0],i.addClass(this.deviceName)):n.log("device does not match the rule ",a):(n.log("no devices provided, default to true",a),a=!0),!!a},_isHidden:function(){return this.isHidden=e.cookie(this.options.cookieName),n.log("banner is ",this.isHidden?"hidden":"visible"),this.isHidden},_toggleVisibleClass:function(e){e=e||this.isHidden,n.log("toggle state to "+(e?"hidden":"visible")),i.toggleClass(this.options.bannerVisibleClass,!e).toggleClass(this.options.bannerHiddenClass,e)},_url:function(e){var t=this.options.url;return n.log("Guess URL ",t,"by ",e),"string"==typeof t?t:"object"==typeof t&&e in t?t[e]:""}})}),require(["components/video/hls-wrapper"]),require(["jquery","libs/iframe-resizer.min"],function(e){e(function(){var t=e("iframe.resizer");t.length&&typeof t.iFrameResize==typeof Function&&t.iFrameResize({log:!1,enablePublicMethods:!0,autoResize:!0,heightCalculationMethod:"lowestElement",checkOrigin:!0})})}),"front_door"!==utag_data.pageType&&"category_door"!==utag_data.pageType||require(["libs/pointroll.resp.lib"]),require(["fly/libs/uuid.v4"],function(){CBSNEWS.tracking.pageViewGuid=uuid.v4()}),require(["jquery","managers/ad","managers/beanstock-sonobi","gpt"],function(e,t,i){e(function(){if(!e("body").data("suppress-ads")){var n=CBSNEWS.ad,r=CBSNEWS.tracking.pageViewGuid;require(["sharethrough"]);var o=function(){t.init({ad:n,viewGuid:r}),t.loadAds()};i.isEnabled?i.init(n,o):o()}})}),require(["managers/click-tracking"]),require(["managers/tealium"],function(e){window.$tealium=e,1==CBSNEWS.tracking.isEnabled&&(e.setViewGuid(CBSNEWS.tracking.pageViewGuid),e.init(CBSNEWS.tracking))}),require(["version!fly/components/modal"]),require(["version!fly/components/modal-async"]),require(["components/modal-homepage"]),require(["components/smart-banner"]),define("common",function(){}),define("fly/managers/components-1.0",["jquery","version!fly/utils/string-helper","version!fly/utils/object-helper","version!fly/managers/debug","version!fly/components/base"],function(e,t,i,n,r){var o,a={attr:"data-component",includeContext:!0},s=n.init("components"),l={};return e(document).on("domUpdated",function(e,t){t=t||{},o.process(t.$context)}),o={process:function(i){var n=this,r=this.findByAttr(i);r.each(function(i,r){var o=e(r),a=o.data(),s=t.toCleanArray(a.component);e.each(s,function(e,t){n.init(t,o)})})},init:function(t,i,n){var r,o,a=l[t];a&&(n=n||{},r=e.makeArray(a.require)||[],o=t,a.alias&&(o=a.alias,n=e.extend(!0,{},a.options||{},n)),require(r,function(){i&&i.length&&e.isFunction(i[o])&&i[o](n)}),s.log("init: ",t,i,n))},setConfig:function(t){if(!e.isPlainObject(t))throw new Error("Component setConfig failure. Map is in the wrong format.");e.extend(a,t)},register:function(t){if(!e.isPlainObject(t))throw new Error("Component register failure. Map is in the wrong format.");e.each(t,function(e,t){l[e]=t,t.options&&r.setDefaultOptions(e,t.options),t.events&&r.addDefaultEvents(e,t.events)}),s.log("register: ",t)},findByAttr:function(t,i,n){var r,o="";return i=i&&!e.isArray(i)?[i]:i,i?e.each(i,function(e,t){o+=e>0?", ":"",o+="["+a.attr+'="'+t+'"], ['+a.attr+"*='\""+t+"\"']"}):o="["+a.attr+"]",t=t||e(document.body),r=t.find(o),n="undefined"!=typeof n?n:a.includeContext,n&&(r=r.addBack(o)),r}}}),define("managers/components.desktop",["jquery","version!fly/managers/components","managers/tealium","version!fly/managers/ad","version!fly/managers/debug"],function(e,t,i,n,r){var o=r.init("components");return t.register({accordion:{require:["version!fly/components/accordion"]},alert:{require:["version!fly/components/alert"]},bluehornet:{require:["managers/bluehornet"]},carousel:{require:["version!fly/components/carousel"]},cbsnLiveHeadline:{require:["components/cbsn-live-headline"]},cbsnPromo:{require:["components/cbsn-promo"]},cbsvideoui:{require:["components/video/cbsvideoui"]},cndcDesktopPromo:{require:["components/video/video-cndc-fd-desktop"]},cndcPlayer:{require:["components/video/video-cndc-player"]},comments:{require:["components/comments"]},credspark:{require:["components/credspark"]},dashboardCarousel:{require:["components/dashboard-carousel"]},dashboardLoader:{require:["components/dashboard-loader"],options:{contentAvailable:function(e,i){o.log("content available"),t.process(i.$content)}}},deepStoryLoader:{require:["components/deep-story-loader"],options:{loaded:function(e,i){t.process(i.$content)}}},deepStoryLoadMore:{require:["components/deep-story-load-more"]},dependentField:{require:["version!fly/components/dependent-field"]},dropdown:{require:["components/dropdown"]},elections:{require:["components/elections"]},elections2016:{require:["components/elections-2016"]},generalElections2016:{require:["components/general-elections-2016"]},fixate:{require:["version!fly/components/fixate"]},flyout:{require:["components/flyout"]},fontDetection:{require:["components/font-detection"]},formValidate:{require:["version!fly/components/form-validate"]},genericPlaylist:{require:["components/video/generic-playlist"]},googleSearchAds:{require:["components/google-search-ads"]},hlsWrapper:{require:["components/video/hls-wrapper"]},imageGallery:{require:["components/image-gallery"]},inlineAds:{require:["components/inline-ads"]},livefyreCommentcount:{require:["components/livefyre-commentcount"]},livefyreConversation:{require:["components/livefyre-conversation"],options:{commentPosted:function(e,t){om.trackCommentAdd()},userLoggedIn:function(t,i){i.isModerator&&e("head").append('<style id="showLivefyreDelete" type="text/css">.fyre-delete-link { display: inline-block !important; }</style>')}}},loadExternal:{require:["components/load-external"]},loadMore:{require:["version!fly/components/load-more"],options:{create:function(){e("#no_js3").hide()}}},loadMoreScroll:{require:["version!fly/components/load-more-scroll"]},localize:{require:["components/localize"]},localNews:{require:["components/local-news"]},magazineHero:{require:["components/magazine-hero"]},mediaPost:{require:["components/media-post"]},modal:{require:["version!fly/components/modal"]},modalAsync:{require:["version!fly/components/modal-async"],options:{contentSet:function(r,o){t.process(o.$content);var a,s=e("body").data("suppress-ads");s!==!0&&(o.$modal&&(a=o.$modal.data("ad")),a||(a=CBSNEWS.ad),n.init({ad:a,viewGuid:i.syncResetViewGuid()}),n.loadAds());var l=e(this).data("modalAsync");l&&l.position()}}},modalHomepage:{require:["components/modal-homepage"]},moreDropdown:{require:["components/more-dropdown"]},newsletters:{require:["components/newsletters"]},placeholder:{require:["components/placeholder"]},poll:{require:["components/poll"]},radioNews:{require:["components/radio-news"]},recirc:{require:["components/recirc"]},scrollbar:{require:["version!fly/components/scrollbar"]},search:{require:["components/search"]},sharebar:{require:["components/sharebar"]},smartBanner:{require:["components/smart-banner"]},socialButton:{require:["version!fly/components/social-button"],options:{clicked:function(e,t){"top"==t.location?om.trackSocialClick({socialService:t.name}):"condensed"==t.location&&om.trackSocialClick({socialService:t.name})},loaded:function(){o.log("social button loaded")}}},socialCounts:{require:["version!fly/components/social-counts"]},socialLinks:{require:["version!fly/components/social-links"]},tabs:{require:["version!fly/components/tabs"],options:{shown:function(e,i){t.process(i.$content)}}},ticker:{require:["components/ticker"]},tooltip:{require:["version!fly/components/tooltip"]},videoDesktop:{require:["components/video/video-desktop"]},videoHi5:{require:["components/video/video-Hi5"]},videoHi5AdControls:{require:["components/video/video-Hi5-ad-controls"]},videoHi5CBSN:{require:["components/video/video-cbsn-Hi5"]},videoHi5Controls:{require:["components/video/video-Hi5-controls"]},videoHi5Preview:{require:["components/video/video-Hi5-preview"]},videoPlayer:{require:["components/video/video-player"]},vpcbsnComponent:{require:["components/video/vp-cbsn-component"]},weather:{require:["components/weather"]}}),t}),define("fly/libs/jquery.nano-scroller-0.7.2",["jquery"],function(e){"use strict";var t,i,n,r,o,a,s,l,d,u,c,f,h,p,g,v,m,y,b,w,E;w={paneClass:"pane",sliderClass:"slider",contentClass:"content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},v="scrollbar",g="scroll",l="mousedown",d="mousemove",c="mousewheel",u="mouseup",p="resize",o="drag",y="up",h="panedown",n="DOMMouseScroll",r="down",b="wheel",a="keydown",s="keyup",m="touchmove",t="Microsoft Internet Explorer"===window.navigator.appName&&/msie 7./i.test(window.navigator.appVersion)&&window.ActiveXObject,i=null,E=function(){var e,t,i;return e=document.createElement("div"),t=e.style,t.position="absolute",t.width="100px",t.height="100px",t.overflow=g,t.top="-9999px",document.body.appendChild(e),i=e.offsetWidth-e.clientWidth,document.body.removeChild(e),i},f=function(){function a(t,n){this.el=t,this.options=n,i||(i=E()),this.$el=e(this.el),this.doc=e(this.options.documentContext||document),this.win=e(this.options.windowContext||window),this.$content=this.$el.children("."+n.contentClass),this.$content.attr("tabindex",0),this.content=this.$content[0],this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return a.prototype.preventScrolling=function(e,t){if(this.isActive)if(e.type===n)(t===r&&e.originalEvent.detail>0||t===y&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===c){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(t===r&&e.originalEvent.wheelDelta<0||t===y&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},a.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},a.prototype.updateScrollValues=function(){var e;e=this.content,this.maxScrollTop=e.scrollHeight-e.clientHeight,this.contentScrollTop=e.scrollTop,this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},a.prototype.createEvents=function(){var e=this;this.events={down:function(t){return e.isBeingDragged=!0,e.offsetY=t.pageY-e.slider.offset().top,e.pane.addClass("active"),e.doc.bind(d,e.events[o]).bind(u,e.events[y]),!1},drag:function(t){return e.sliderY=t.pageY-e.$el.offset().top-e.offsetY,e.scroll(),e.updateScrollValues(),e.contentScrollTop>=e.maxScrollTop?e.$el.trigger("scrollend"):0===e.contentScrollTop&&e.$el.trigger("scrolltop"),!1},up:function(t){return e.isBeingDragged=!1,e.pane.removeClass("active"),e.doc.unbind(d,e.events[o]).unbind(u,e.events[y]),!1},resize:function(t){e.reset()},panedown:function(t){return e.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*e.sliderHeight,e.scroll(),e.events.down(t),!1},scroll:function(t){e.isBeingDragged||(e.updateScrollValues(),e.iOSNativeScrolling||(e.sliderY=e.sliderTop,e.slider.css({top:e.sliderTop})),null!=t&&(e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(t,r),e.$el.trigger("scrollend")):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(t,y),e.$el.trigger("scrolltop"))))},wheel:function(t){if(null!=t)return e.sliderY+=-t.wheelDeltaY||-t.delta,e.scroll(),!1}}},a.prototype.addEvents=function(){var e;this.removeEvents(),e=this.events,this.options.disableResize||this.win.bind(p,e[p]),this.iOSNativeScrolling||(this.slider.bind(l,e[r]),this.pane.bind(l,e[h]).bind(""+c+" "+n,e[b])),this.$content.bind(""+g+" "+c+" "+n+" "+m,e[g])},a.prototype.removeEvents=function(){var e;e=this.events,this.win.unbind(p,e[p]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(""+g+" "+c+" "+n+" "+m,e[g])},a.prototype.generate=function(){var e,t,n,r,o;return n=this.options,r=n.paneClass,o=n.sliderClass,e=n.contentClass,this.$el.find(""+r).length||this.$el.find(""+o).length||this.$el.append('<div class="'+r+'"><div class="'+o+'" /></div>'),this.pane=this.$el.children("."+r),this.slider=this.pane.find("."+o),i&&(t="rtl"===this.$el.css("direction")?{left:-i}:{right:-i},this.$el.addClass("has-scrollbar")),null!=t&&this.$content.css(t),this},a.prototype.restore=function(){this.stopped=!1,this.pane.show(),this.addEvents()},a.prototype.reset=function(){var e,n,r,o,a,s,l,d,u;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),e=this.content,r=e.style,o=r.overflowY,t&&this.$content.css({height:this.$content.height()}),n=e.scrollHeight+i,s=this.pane.outerHeight(),d=parseInt(this.pane.css("top"),10),a=parseInt(this.pane.css("bottom"),10),
l=s+d+a,u=Math.round(l/n*l),u<this.options.sliderMinHeight?u=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&u>this.options.sliderMaxHeight&&(u=this.options.sliderMaxHeight),o===g&&r.overflowX!==g&&(u+=i),this.maxSliderTop=l-u,this.contentHeight=n,this.paneHeight=s,this.paneOuterHeight=l,this.sliderHeight=u,this.slider.height(u),this.events.scroll(),this.pane.show(),this.isActive=!0,e.scrollHeight===e.clientHeight||this.pane.outerHeight(!0)>=e.scrollHeight&&o!==g?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===e.scrollHeight&&o===g?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),this)},a.prototype.scroll=function(){if(this.isActive)return this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop((this.paneHeight-this.contentHeight+i)*this.sliderY/this.maxSliderTop*-1),this.iOSNativeScrolling||this.slider.css({top:this.sliderY}),this},a.prototype.scrollBottom=function(e){if(this.isActive)return this.reset(),this.$content.scrollTop(this.contentHeight-this.$content.height()-e).trigger(c),this},a.prototype.scrollTop=function(e){if(this.isActive)return this.reset(),this.$content.scrollTop(+e).trigger(c),this},a.prototype.scrollTo=function(t){if(this.isActive)return this.reset(),this.scrollTop(e(t).get(0).offsetTop),this},a.prototype.stop=function(){return this.stopped=!0,this.removeEvents(),this.pane.hide(),this},a.prototype.flash=function(){var e=this;if(this.isActive)return this.reset(),this.pane.addClass("flashed"),setTimeout(function(){e.pane.removeClass("flashed")},this.options.flashDelay),this},a}(),e.fn.nanoScroller=function(t){return this.each(function(){var i,n;if((n=this.nanoscroller)||(i=e.extend({},w,t),this.nanoscroller=n=new f(this,i)),t&&"object"==typeof t){if(e.extend(n.options,t),t.scrollBottom)return n.scrollBottom(t.scrollBottom);if(t.scrollTop)return n.scrollTop(t.scrollTop);if(t.scrollTo)return n.scrollTo(t.scrollTo);if("bottom"===t.scroll)return n.scrollBottom(0);if("top"===t.scroll)return n.scrollTop(0);if(t.scroll&&t.scroll instanceof e)return n.scrollTo(t.scroll);if(t.stop)return n.stop();if(t.flash)return n.flash()}return n.reset()})}}),define("fly/components/scrollbar-1.0",["jquery","fly/libs/jquery.nano-scroller-0.7.2","version!fly/components/base"],function(e){e.widget("fly.scrollbar",e.fly.base,{options:{containerClass:"content-scroll",height:null},isCreated:!1,_create:function(){var e=this.options;this._setup(),this.$element.addClass(e.containerClass),e.height&&this.$element.css("height",e.height),this.$element.nanoScroller(this.options)},_init:function(){return this.isCreated?void this.$element.nanoScroller():void(this.isCreated=!0)},fire:function(e){this.$element.nanoScroller(e)}})});var swfobject=function(){function e(){if(!q){try{var e=M.getElementsByTagName("body")[0].appendChild(v("span"));e.parentNode.removeChild(e)}catch(e){return}q=!0;for(var t=B.length,i=0;i<t;i++)B[i]()}}function t(e){q?e():B[B.length]=e}function i(e){if(typeof N.addEventListener!=C)N.addEventListener("load",e,!1);else if(typeof M.addEventListener!=C)M.addEventListener("load",e,!1);else if(typeof N.attachEvent!=C)m(N,"onload",e);else if("function"==typeof N.onload){var t=N.onload;N.onload=function(){t(),e()}}else N.onload=e}function n(){U?r():o()}function r(){var e=M.getElementsByTagName("body")[0],t=v(x);t.setAttribute("type",P);var i=e.appendChild(t);if(i){var n=0;!function(){if(typeof i.GetVariable!=C){var r=i.GetVariable("$version");r&&(r=r.split(" ")[1].split(","),$.pv=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)])}else if(n<10)return n++,void setTimeout(arguments.callee,10);e.removeChild(t),i=null,o()}()}else o()}function o(){var e=j.length;if(e>0)for(var t=0;t<e;t++){var i=j[t].id,n=j[t].callbackFn,r={success:!1,id:i};if($.pv[0]>0){var o=g(i);if(o)if(!y(j[t].swfVersion)||$.wk&&$.wk<312)if(j[t].expressInstall&&s()){var u={};u.data=j[t].expressInstall,u.width=o.getAttribute("width")||"0",u.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(u.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(u.align=o.getAttribute("align"));for(var c={},f=o.getElementsByTagName("param"),h=f.length,p=0;p<h;p++)"movie"!=f[p].getAttribute("name").toLowerCase()&&(c[f[p].getAttribute("name")]=f[p].getAttribute("value"));l(u,c,i,n)}else d(o),n&&n(r);else w(i,!0),n&&(r.success=!0,r.ref=a(i),n(r))}else if(w(i,!0),n){var v=a(i);v&&typeof v.SetVariable!=C&&(r.success=!0,r.ref=v),n(r)}}}function a(e){var t=null,i=g(e);if(i&&"OBJECT"==i.nodeName)if(typeof i.SetVariable!=C)t=i;else{var n=i.getElementsByTagName(x)[0];n&&(t=n)}return t}function s(){return!V&&y("6.0.65")&&($.win||$.mac)&&!($.wk&&$.wk<312)}function l(e,t,i,n){V=!0,S=n||null,T={success:!1,id:i};var r=g(i);if(r){"OBJECT"==r.nodeName?(_=u(r),k=null):(_=r,k=i),e.id=I,(typeof e.width==C||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==C||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),M.title=M.title.slice(0,47)+" - Flash Player Installation";var o=$.ie&&$.win?"ActiveX":"PlugIn",a="MMredirectURL="+N.location.toString().replace(/&/g,"%26")+"&MMplayerType="+o+"&MMdoctitle="+M.title;if(typeof t.flashvars!=C?t.flashvars+="&"+a:t.flashvars=a,$.ie&&$.win&&4!=r.readyState){var s=v("div");i+="SWFObjectNew",s.setAttribute("id",i),r.parentNode.insertBefore(s,r),r.style.display="none",function(){4==r.readyState?r.parentNode.removeChild(r):setTimeout(arguments.callee,10)}()}c(e,t,i)}}function d(e){if($.ie&&$.win&&4!=e.readyState){var t=v("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(u(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(u(e),e)}function u(e){var t=v("div");if($.win&&$.ie)t.innerHTML=e.innerHTML;else{var i=e.getElementsByTagName(x)[0];if(i){var n=i.childNodes;if(n)for(var r=n.length,o=0;o<r;o++)1==n[o].nodeType&&"PARAM"==n[o].nodeName||8==n[o].nodeType||t.appendChild(n[o].cloneNode(!0))}}return t}function c(e,t,i){var n,r=g(i);if($.wk&&$.wk<312)return n;if(r)if(typeof e.id==C&&(e.id=i),$.ie&&$.win){var o="";for(var a in e)e[a]!=Object.prototype[a]&&("data"==a.toLowerCase()?t.movie=e[a]:"styleclass"==a.toLowerCase()?o+=' class="'+e[a]+'"':"classid"!=a.toLowerCase()&&(o+=" "+a+'="'+e[a]+'"'));var s="";for(var l in t)t[l]!=Object.prototype[l]&&(s+='<param name="'+l+'" value="'+t[l]+'" />');r.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+o+">"+s+"</object>",H[H.length]=e.id,n=g(e.id)}else{var d=v(x);d.setAttribute("type",P);for(var u in e)e[u]!=Object.prototype[u]&&("styleclass"==u.toLowerCase()?d.setAttribute("class",e[u]):"classid"!=u.toLowerCase()&&d.setAttribute(u,e[u]));for(var c in t)t[c]!=Object.prototype[c]&&"movie"!=c.toLowerCase()&&f(d,c,t[c]);r.parentNode.replaceChild(d,r),n=d}return n}function f(e,t,i){var n=v("param");n.setAttribute("name",t),n.setAttribute("value",i),e.appendChild(n)}function h(e){var t=g(e);t&&"OBJECT"==t.nodeName&&($.ie&&$.win?(t.style.display="none",function(){4==t.readyState?p(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function p(e){var t=g(e);if(t){for(var i in t)"function"==typeof t[i]&&(t[i]=null);t.parentNode.removeChild(t)}}function g(e){var t=null;try{t=M.getElementById(e)}catch(e){}return t}function v(e){return M.createElement(e)}function m(e,t,i){e.attachEvent(t,i),G[G.length]=[e,t,i]}function y(e){var t=$.pv,i=e.split(".");return i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10)||0,i[2]=parseInt(i[2],10)||0,t[0]>i[0]||t[0]==i[0]&&t[1]>i[1]||t[0]==i[0]&&t[1]==i[1]&&t[2]>=i[2]}function b(e,t,i,n){if(!$.ie||!$.mac){var r=M.getElementsByTagName("head")[0];if(r){var o=i&&"string"==typeof i?i:"screen";if(n&&(R=null,A=null),!R||A!=o){var a=v("style");a.setAttribute("type","text/css"),a.setAttribute("media",o),R=r.appendChild(a),$.ie&&$.win&&typeof M.styleSheets!=C&&M.styleSheets.length>0&&(R=M.styleSheets[M.styleSheets.length-1]),A=o}$.ie&&$.win?R&&typeof R.addRule==x&&R.addRule(e,t):R&&typeof M.createTextNode!=C&&R.appendChild(M.createTextNode(e+" {"+t+"}"))}}}function w(e,t){if(W){var i=t?"visible":"hidden";q&&g(e)?g(e).style.visibility=i:b("#"+e,"visibility:"+i)}}function E(e){var t=/[\\\"<>\.;]/,i=null!=t.exec(e);return i&&typeof encodeURIComponent!=C?encodeURIComponent(e):e}var _,k,S,T,R,A,C="undefined",x="object",L="Shockwave Flash",D="ShockwaveFlash.ShockwaveFlash",P="application/x-shockwave-flash",I="SWFObjectExprInst",O="onreadystatechange",N=window,M=document,F=navigator,U=!1,B=[n],j=[],H=[],G=[],q=!1,V=!1,W=!0,$=function(){var e=typeof M.getElementById!=C&&typeof M.getElementsByTagName!=C&&typeof M.createElement!=C,t=F.userAgent.toLowerCase(),i=F.platform.toLowerCase(),n=i?/win/.test(i):/win/.test(t),r=i?/mac/.test(i):/mac/.test(t),o=!!/webkit/.test(t)&&parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),a=!1,s=[0,0,0],l=null;if(typeof F.plugins!=C&&typeof F.plugins[L]==x)l=F.plugins[L].description,!l||typeof F.mimeTypes!=C&&F.mimeTypes[P]&&!F.mimeTypes[P].enabledPlugin||(U=!0,a=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),s[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),s[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof N.ActiveXObject!=C)try{var d=new ActiveXObject(D);d&&(l=d.GetVariable("$version"),l&&(a=!0,l=l.split(" ")[1].split(","),s=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]))}catch(e){}return{w3:e,pv:s,wk:o,ie:a,win:n,mac:r}}();(function(){$.w3&&((typeof M.readyState!=C&&"complete"==M.readyState||typeof M.readyState==C&&(M.getElementsByTagName("body")[0]||M.body))&&e(),q||(typeof M.addEventListener!=C&&M.addEventListener("DOMContentLoaded",e,!1),$.ie&&$.win&&(M.attachEvent(O,function(){"complete"==M.readyState&&(M.detachEvent(O,arguments.callee),e())}),N==top&&!function(){if(!q){try{M.documentElement.doScroll("left")}catch(e){return void setTimeout(arguments.callee,0)}e()}}()),$.wk&&!function(){if(!q)return/loaded|complete/.test(M.readyState)?void e():void setTimeout(arguments.callee,0)}(),i(e)))})(),function(){$.ie&&$.win&&window.attachEvent("onunload",function(){for(var e=G.length,t=0;t<e;t++)G[t][0].detachEvent(G[t][1],G[t][2]);for(var i=H.length,n=0;n<i;n++)h(H[n]);for(var r in $)$[r]=null;$=null;for(var o in swfobject)swfobject[o]=null;swfobject=null})}();return{registerObject:function(e,t,i,n){if($.w3&&e&&t){var r={};r.id=e,r.swfVersion=t,r.expressInstall=i,r.callbackFn=n,j[j.length]=r,w(e,!1)}else n&&n({success:!1,id:e})},getObjectById:function(e){if($.w3)return a(e)},embedSWF:function(e,i,n,r,o,a,d,u,f,h){var p={success:!1,id:i};$.w3&&!($.wk&&$.wk<312)&&e&&i&&n&&r&&o?(w(i,!1),t(function(){n+="",r+="";var t={};if(f&&typeof f===x)for(var g in f)t[g]=f[g];t.data=e,t.width=n,t.height=r;var v={};if(u&&typeof u===x)for(var m in u)v[m]=u[m];if(d&&typeof d===x)for(var b in d)typeof v.flashvars!=C?v.flashvars+="&"+b+"="+d[b]:v.flashvars=b+"="+d[b];if(y(o)){var E=c(t,v,i);t.id==i&&w(i,!0),p.success=!0,p.ref=E}else{if(a&&s())return t.data=a,void l(t,v,i,h);w(i,!0)}h&&h(p)})):h&&h(p)},switchOffAutoHideShow:function(){W=!1},ua:$,getFlashPlayerVersion:function(){return{major:$.pv[0],minor:$.pv[1],release:$.pv[2]}},hasFlashPlayerVersion:y,createSWF:function(e,t,i){return $.w3?c(e,t,i):void 0},showExpressInstall:function(e,t,i,n){$.w3&&s()&&l(e,t,i,n)},removeSWF:function(e){$.w3&&h(e)},createCSS:function(e,t,i,n){$.w3&&b(e,t,i,n)},addDomLoadEvent:t,addLoadEvent:i,getQueryParamValue:function(e){var t=M.location.search||M.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return E(t);for(var i=t.split("&"),n=0;n<i.length;n++)if(i[n].substring(0,i[n].indexOf("="))==e)return E(i[n].substring(i[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(V){var e=g(I);e&&_&&(e.parentNode.replaceChild(_,e),k&&(w(k,!0),$.ie&&$.win&&(_.style.display="block")),S&&S(T)),V=!1}}}}();define("libs/swfobject",function(){}),define("components/video/video-desktop",["jquery","version!fly/managers/debug","version!fly/utils/url-helper","libs/swfobject","managers/tealium","version!fly/libs/jquery.cookie","version!fly/components/base"],function(e,t,i){var n=t.get("video"),r=CBSNEWS.ad||{};n.log("video-desktop:","adData = ",r);e(window);e.widget("fly.videoDesktop",e.fly.base,{options:{pid:"H387n3FRoTqD",url:"//www.cbsnews.com/videos/",playerWidth:"100%",playerHeight:"100%",si:"162",suppress:!1,autoplay:!0,articleAuto:!1,articleAutoState:!0,pageType:null,pagePlaylist:!1,elementRef:null,live:!1,lengthSecs:60,cid:999999,hed:null,subscriptionPreView:null,viewable:!0,subscriber:!1,is60minfranchise:null,is60Extra:null,is6048Preview:null,UrlmpxRefId:null,loadingMethod:"PID",topicname:null,psite:"//www.cbsnews.com",uuid:null,noDVR:!1,flv:null,smode:"fit",releaseURL:"//www.cbsnews.com/common/video/cbsnews_video.swf"},playerElement:null,$player:null,cbsiPlayer:null,jsReady:!1,devURL:"//www.cbsnews.com/common/video/cbsnews_video.swf",playerRefId:"cbsNewsVideoPlayerSwf",elementRefId:"cbsNewsVideoPlayer",flashVars:{},_create:function(t){window.cbsiPlayer=e.proxy(this.cbsiPlayer,this),window.onCBSIPlayerReady=e.proxy(this.onCBSIPlayerReady,this),window.isJSReady=e.proxy(this.isJSReady,this),window.onCBSI_PlayerLoaded=e.proxy(this.onCBSI_PlayerLoaded,this),window.getVideoAdSessionValues=e.proxy(this.getVideoAdSessionValues,this),window.onAdResourcesInfo=e.proxy(this.onAdResourcesInfo,this),window.sixtyAALearnDesktop=e.proxy(this.sixtyAALearnDesktop,this),window.setAutoPlayValue=e.proxy(this.setAutoPlayValue,this),window.onCBSI_ContentStart=e.proxy(this.onCBSI_ContentStart,this),window.onCBSI_AdStart=e.proxy(this.onCBSI_AdStart,this),window.userPlay=e.proxy(this.userPlay,this),this.elementRefId=null==this.options.elementRef?this.elementRefId:this.options.elementRef,this._setupPlayer()},_setupPlayer:function(){this.setJSReady(),this.options.lengthSecs=this.options.duration,this.options.loggedInUser="authenticated"===utag_data.userState,this.options.pid.match(/999999/gi)&&(this.options.loadingMethod="URL",this.options.cid=this.options.pid),this.isLiveVideoCheck(this.options.pid)&&(this.options.live="true"),this.isLiveNoDVRCheck(this.options.pid)&&(this.options.noDVR="true"),"Article"==this.options.pageType&&(this.options.articleAuto=!0,null==e.cookie("cbsArticleAuto")&&e.cookie("cbsArticleAuto",!0,{expires:30,path:"/"}),"true"==e.cookie("cbsArticleAuto")||null==e.cookie("cbsArticleAuto")?(this.options.articleAuto=!0,this.options.articleAutoState=!0):(this.options.articleAuto=!0,this.options.articleAutoState=!1,this.options.autoplay=!1)),"true"==this.options.subscriptionPreView.active||1==this.options.subscriptionPreView.active?this.showHTMLPreview():this.playVideo()},setJSReady:function(){this.jsReady=!0},isJSReady:function(){return this.jsReady},sixtyAALearnDesktop:function(){om.trackCampaignDriver({intcid:"CNI11b6b0f",campaignType:"all-access",campaignChannel:"video player",campaignText:"learn more"})},getVideoAdSessionValues:function(t){var o="",a=JSON.parse(e.cookie(r.cookieName)),s=a&&a.session;if(s&&(o="session="+s),(1==this.options.suppress||1==this.options.subscriber&&1==this.options.is60minfranchise||"true"==this.options.subscriber&&"true"==this.options.is60minfranchise)&&(o+="&feat=killad"),r.useFirstPageTargeting){var l=null==e.cookie("first_page_today")||void 0!==window.firstpgvar&&1==window.firstpgvar?"1":"0";o+="&firstpg="+l}return null!=this.options.pageType&&(o+="&ptype="+this.options.pageType),e.each(i.getAllParams(),function(e,t){var i=e.match(/adTargeting_(.+)/);i&&i[1]&&(o+="&"+i[1]+"="+t)}),n.log("video-desktop:","setting video ad session values:",o),o},isLiveVideoCheck:function(t){var i=["EZCOmvznjVN_","puG_yGuOdrCu","TiGLGtxzSPKe","D6fmVetXK8_K","4jQtQV2BUWPw","3eplG8pAXhsH","F8VkKnk_tgC8","9nnsnOy8iPUa"];return e.inArray(t,i)!=-1},isLiveNoDVRCheck:function(t){var i=["3eplG8pAXhsH","9nnsnOy8iPUa"];return e.inArray(t,i)!=-1},playVideo:function(e){playerStarted=!0,this.displaySWFObject()},getSWFurl:function(){return this.options.releaseURL},displaySWFObject:function(){this.getFlashVars();var t={scale:"noscale",salign:"lt",wmode:"direct",allowFullScreen:"true",allowScriptAccess:"always",quality:"high",bgcolor:"#000000",swliveconnect:"true"},i={salign:"lt",scale:"noscale",wmode:"direct",allowFullScreen:"true",allowScriptAccess:"always",quality:"high",bgcolor:"#000000",swliveconnect:"true"};({id:this.playerRefId});navigator.userAgent.match(/Firefox/i)?swfobject.embedSWF(this.getSWFurl(),this.elementRefId,this.options.playerWidth,this.options.playerHeight,"9.0.0","",this.flashVars,i):swfobject.embedSWF(this.getSWFurl(),this.elementRefId,this.options.playerWidth,this.options.playerHeight,"9.0.0","",this.flashVars,t),this.cbsiPlayer=this.playerElement=document.getElementById(this.elementRefId),this.$player=e(this.playerElement)},getFlashVars:function(e){this.flashVars=this.options,"true"==this.options.is60minfranchise||1==this.options.is60minfranchise?"true"==this.options.viewable||1==this.options.viewable?this.flashVars.nonmember=!1:"true"==this.options.is6048Preview||1==this.options.is6048Preview?this.flashVars.nonmember=!1:"false"==this.options.subscriber||0==this.options.subscriber?this.flashVars.nonmember=!0:this.flashVars.nonmember=!1:this.flashVars.nonmember=!1},thisMovie:function(e){return e=e||this.playerRefId,(Browser.Engine.trident?window:document)[e]},showHTMLPreview:function(){e("<div/>",{class:"subscribe-preview",id:"subscribe-previewId"}).append(e("<img/>",{id:"subscribe-preview-imgId",class:"subscribe-preview-img",src:this.options.thumbnail})).append(e("<div/>",{id:"subscribe-preview-iconId",class:"subscribe-preview-icon"})).appendTo(e("#"+this.elementRefId));var t=this;e("#subscribe-previewId").on("click",function(e){t.playVideo()}),"60AALarge"==this.options.subscriptionPreView.view&&e("#subscribe-previewId").append(e("<div/>",{class:"subscribe-preview-text",id:"subscribe-preview-textId",text:"Take The Tour"}))},userPlay:function(){cbsnewsPlayerPlay()},playItem:function(e){},onCBSIPlayerReady:function(e){this.cbsiPlayer.addEventJSCallback("onPlayerLoaded_cbsi","onCBSI_PlayerLoaded"),this.cbsiPlayer.addEventJSCallback("onAdResourcesInfo","onAdResourcesInfo"),this.cbsiPlayer.addEventJSCallback("onAdStart_cbsi","onCBSI_AdStart"),this.cbsiPlayer.addEventJSCallback("onContentEnd_cbsi","onContentEnd_cbsi"),this.cbsiPlayer.addEventJSCallback("onStateChange_cbsi","onStateChange_cbsi"),this.cbsiPlayer.addEventJSCallback("onContentStart_cbsi","onCBSI_ContentStart"),this.cbsiPlayer.addEventJSCallback("onPlayListEnd_cbsi","onPlayListEnd_cbsi"),this.cbsiPlayer.addEventJSCallback("userPlay","userPlay")},onContentEnd_cbsi:function(){},setAutoPlayValue:function(t){e.cookie("cbsArticleAuto",t,{expires:30,path:"/"})},onAdResourcesInfo:function(){},getContainerId:function(e,t){return adObject.camelcaseToHyphen(e)+(t?"-"+t:"")},camelcaseToHyphen:function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},onCBSI_PlayerLoaded:function(e){console.info("onCBSI_PlayerLoaded"),this._trigger("onPlayerLoaded_cbsi")},onCBSI_ContentStart:function(){n.log("onContentStart_cbsi"),this._trigger("onContentStart_cbsi")},onCBSI_AdStart:function(e){n.log("onAdStart_cbsi"),this._trigger("onAdStart_cbsi")}})}),define("components/video/video-Hi5",["jquery","managers/tealium","version!fly/components/base","version!fly/managers/debug"],function(e,t){var i=e(window);e.widget("fly.videoHi5",e.fly.base,{options:{pid:null,hed:null,device:null,pageType:null,thumbnail:null,width:null,subscriber:null,is60minfranchise:null,is60Extra:null,is6048Preview:null,uuid:null,viewable:!0,height:null,element:null,uri:null},playerElement:null,$player:null,cbsiPlayer:null,preview_cntrls:null,controls:null,partner:"cbsnews_mobile",adPlaying:!1,contentPlaying:!1,adControls:null,isFullScreen:!1,jsReady:!1,captionShowing:!1,imaAdDivID:"uvp_ad_container",novemberAlpha:!1,videoRegistration:{foxtrot:null,product:null,status:null,parentTopicName:null,topicName:null,is60Extra:null,is6048Preview:null},uvp_sOpts_tmp:{partner:"cbsnews",nativeControls:!1,autoHide:!1,previewImg:null,videoTitle:"",showPreviewOnVideoEnd:!0,logo:"",logoClickUrl:"//www.cbsnews.com",uvpc:"",logWindow:!1,includeFullScreenButton:!0,useNativeFullScreen:!1,dwTags:"player:cbsNewsMobile",netwk:"can",mapp:"UVP_Hi5;2.4.1",cms:"platform",uvpHandlesAdClicks:!0,landscape16x9_normal:["620px","413px","0px","0px"],landscape4x3_normal:["320px","240px","0px","56px"],portrait16x9_normal:["620px","350px","0px","0px"],portrait4x3_normal:["240px","160px","0px","0px"],landscape16x9_customFS:["960px","540px","0px","0px"],landscape4x3_customFS:["848px","636px","0px","56px"],portrait16x9_customFS:["960px","540px","0px","0px"],portrait4x3_customFS:["640px","480px","0px","0px"],initialAspect:"16x9",watermark:!1},_create:function(t){this._setup(),this.uvp_sOpts_tmp.dwTags="player:"+this.options.device,"VideoEmbed"==this.options.pageType?(this.uvp_sOpts_tmp.landscape16x9_normal=[this.options.width+"%",this.options.height+"%","0px","0px"],this.uvp_sOpts_tmp.portrait16x9_normal=[this.options.width+"%",this.options.height+"%","0px","0px"],"fbia app"==utag_data.siteType&&(DW.pageParams.omnicookie=utag_data.siteType+"||| "+utag_data.deviceType)):(this.uvp_sOpts_tmp.landscape16x9_normal=[this.options.width+"px",this.options.height+"px","0px","0px"],this.uvp_sOpts_tmp.portrait16x9_normal=[this.options.width+"px",this.options.height+"px","0px","0px"]),"tablet"==this.options.device?this.uvp_sOpts_tmp.uvpc="/common/video/uvp_cbsnews_hl_tablet.xml":"mobile"==this.options.device?(this.uvp_sOpts_tmp.uvpc="/common/video/uvp_cbsnews_hl_mobile.xml","VideoEmbed"==this.options.pageType?(this.uvp_sOpts_tmp.landscape16x9_normal=[this.options.width+"%",this.options.height+"%","0px","0px"],this.uvp_sOpts_tmp.portrait16x9_normal=[this.options.width+"%",this.options.height+"%","0px","0px"],"fbia app"==utag_data.siteType&&(DW.pageParams.omnicookie=utag_data.siteType+"||| "+utag_data.deviceType)):(this.uvp_sOpts_tmp.landscape16x9_normal=[this.options.width+"px",this.options.height+"px","0px","0px"],this.uvp_sOpts_tmp.portrait16x9_normal=[this.options.width-140+"px",this.options.height-79+"px","0px","0px"])):this.uvp_sOpts_tmp.uvpc="//www.cbsnews.com/common/video/uvp_cbsnews_hl_mobile.xml",this.initialStart(),window.cbsiPlayer=e.proxy(this.cbsiPlayer,this),window.preview_cntrls=e.proxy(this.preview_cntrls,this),window.controls=e.proxy(this.controls,this),window.adControls=e.proxy(this.adControls,this),window.isFullScreen=e.proxy(this.isFullScreen,this),window.jsReady=e.proxy(this.jsReady,this),window.videoPlayback=e.proxy(this.videoPlayback,this),window.setVideoUUID=e.proxy(this.updateVideoUUID,this),window.onCBSIPlayerReady=e.proxy(this.onCBSIPlayerReady,this),window.isJSReady=e.proxy(this.isJSReady,this),window.onCBSI_PlayerLoaded=e.proxy(this.onCBSI_PlayerLoaded,this),window.onCBSI_ContentStart=e.proxy(this.onCBSI_ContentStart,this),window.onCBSI_ContentEnd=e.proxy(this.onCBSI_ContentEnd,this),window.onCBSI_AdStart=e.proxy(this.onCBSI_AdStart,this),window.onCBSI_AdEnd=e.proxy(this.onCBSI_AdEnd,this),window.onCBSI_AdResourcesInfo=e.proxy(this.onCBSI_AdResourcesInfo,this),window.onCBSI_AdSlotStart=e.proxy(this.onCBSI_AdSlotStart,this),window.onCBSI_PlayerDataLoaded=e.proxy(this.onCBSI_PlayerDataLoaded,this),window.onCBSI_PlayListEnd=e.proxy(this.onCBSI_PlayListEnd,this),window.loadFirstVideo=e.proxy(this.loadFirstVideo,this),window.setFullscreenState=e.proxy(this.setFullscreenState,this),window.onCBSI_CaptionsError=e.proxy(this.onCBSI_CaptionsError,this)},setJSReady:function(){this.jsReady=!0},isJSReady:function(){return this.jsReady},loadCbsiJSPlayer:function(){e("head").append('<script type="text/javascript" async="true" src="//vidtech.cbsinteractive.com/h5/2_4_1/CBSI_PLAYER.js"></script>'),e("head").append('<script type="text/javascript" async="true" src="//s0.2mdn.net/instream/html5/ima3.js"></script>'),e("head").append('<script type="text/javascript" async="true" src="//vidtech.cbsinteractive.com/skins/js_simple/2_1_2/preview.js"></script>'),e("head").append('<script type="text/javascript" async="true" src="//vidtech.cbsinteractive.com/skins/js_simple/2_1_2/adcontrols.js"></script>'),e("head").append('<script type="text/javascript" async="true" src="//vidtech.cbsinteractive.com/skins/js_simple/2_1_2/controls.js"></script>'),this.playerElement=document.getElementById(this.options.element),this.$player=e(this.playerElement);var t="tablet"==this.options.device?"video-player-hi5":"video-player-hi5-mobile";if(this.$player.empty().addClass(t).css({"z-index":"10",width:this.options.width+"px",height:this.options.height+"px"}),e("<div/>",{id:"mycbsiplayer"}).appendTo(this.$player),e("<div/>",{id:"uvp_ad_container"}).appendTo(this.$player),"mobile"==this.options.device){var n=460,r=259,o=i.width(),a=r/n*o;o>640?this.$player.css({width:640,height:360}):this.$player.css({"min-height":a,width:"100%",height:"auto"})}},setFullScreenStateFromControls:function(e){null!=e&&(this.isFullScreen=e)},getFullscreenState:function(){return null!=this.isFullScreen&&this.isFullScreen},onCBSIPlayerReady:function(e){if(null!=e){this.cbsiPlayer=e;var t="mycbsiplayer",i=this.imaAdDivID;document.getElementById("videoplayer");this.addUvpEventCallbacks(),this.preview_cntrls=new UVP_Preview(this.options.element,t,i),this.adControls=new UVP_AdControls(e,this.options.element,t,i),this.controls=new UVP_Controls(e,this.options.element,t,i),this.cbsiPlayer.initialize(t,this.options.element,this.imaAdDivID,"learnMoreAdClickThruID"),this.attachSecondaryControls(),this.listenPreviewClicks(),this.listenClosedCaptionClicks(),this.listenPause()}},attachSecondaryControls:function(){e("<div/>",{id:"closedcap",class:"cc"}).appendTo("#videoplayer .controls"),e("<div/>",{id:"caption_hotspot"}).appendTo("#videoplayer .controls")},listenClosedCaptionClicks:function(){e("#caption_hotspot").on("click touchstart",function(e){this.cbsiPlayer.setYOffset(30),this.captionShowing=!this.captionShowing,1==this.captionShowing?this.cbsiPlayer.showCaptions():this.cbsiPlayer.hideCaptions()})},onCBSI_PlayerDataLoaded:function(e){null!=this.controls&&this.controls.onPlayerDataLoaded(),null!=this.adControls&&this.adControls.onPlayerDataLoaded()},onCBSI_ContentStart:function(e){if(this.adPlaying=!1,this.contentPlaying=!0,null!=this.controls){this.controls.contentStart();this.cbsiPlayer.getContentData();this.cbsiPlayer.hideCaptions()}null!=this.adControls&&this.adControls.contentStart(),null!=this.preview_cntrls&&this.preview_cntrls.removePreviewUI(),this._trigger("onContentStart_cbsi")},onCBSI_ContentEnd:function(e){this.novemberAlpha=!1,this.contentPlaying=!1,null!=uvp_sOpts&&uvp_sOpts.showPreviewOnVideoEnd&&null!=this.preview_cntrls&&this.preview_cntrls.onPlaylistEndEvent(),null!=this.controls&&this.controls.onPlaylistEnd(),null!=this.adControls&&this.adControls.onPlaylistEnd()},onCBSI_AdStart:function(e){var t=new Object;t.id=this.cbsiPlayer.getVideoAdClipId(),t.clickThru=this.cbsiPlayer.getVideoAdClickThru(),this.adPlaying=!0,null!=this.controls&&this.controls.adStart(t.id),null!=this.adControls&&this.adControls.adStart(t),null!=this.preview_cntrls&&this.preview_cntrls.removePreviewUI(),this._trigger("onAdStart_cbsi")},onCBSI_AdEnd:function(e){this.adPlaying=!1,null!=this.controls&&this.controls.adEnd(),null!=this.adControls&&this.adControls.adEnd()},onCBSI_PlayListEnd:function(e){this.novemberAlpha=!1,null!=uvp_sOpts&&uvp_sOpts.showPreviewOnVideoEnd&&null!=this.preview_cntrls&&this.preview_cntrls.onPlaylistEndEvent(),null!=this.controls&&this.controls.onPlaylistEnd(),null!=this.adControls&&this.adControls.onPlaylistEnd()},onCBSI_NoAdContent:function(e){},restorePreview:function(){document.getElementsByTagName("video")[0];null!=this.preview_cntrls&&this.preview_cntrls.onPlaylistEndEvent()},onCBSI_AdResourcesInfo:function(e){},onCBSI_AdSlotStart:function(e){if(1!=arguments.length&&2==arguments.length){var t=arguments[0];null!=this.adControls&&this.adControls.onAdSlotStart(t)}},listenPause:function(){e("#play_pause_hotspot").on("click touchstart",function(e){this._trigger("playerPause_cbsi")})},remove60MinBlock:function(){e("#errorVideoId").length&&e("#errorVideoId").css("display","none")},show60MinBlock:function(t){if(e("#errorVideoId").length)e("#errorVideoId").css("display","block"),e("#previewcontrols").css("display","none");else{if("app"==t)var i="To view this video download the free 60 Minutes App",n="Download the App",r="";else var i="To view this video you must be subscribed to 60 Minutes All Access",n="Learn More",r=" subscribeMsg";e("<div/>",{class:"video-error",id:"errorVideoId"}).append(e("<div/>",{id:"video-error-IconId",class:"video-error-icon"})).append(e("<div/>",{id:"video-error-textId",class:"video-error-text"+r,text:i})).append(e("<div/>",{id:"video-error-buttonId",class:"video-error-button"+r,text:n})).appendTo(this.$player),this.preview_cntrls.addPreviewUI(),e("#previewcontrols").css("display","none")}this.appBtnClick(t),(this.adPlaying||this.contentPlaying)&&this.cbsiPlayer.pauseVideo()},updateVideoUUID:function(e){this.options.uuid=e},pullSubscribeReg:function(t,i){self=this,e.ajax({type:"GET",url:"/video-registration/"+this.options.uuid,dataType:"json",cache:!1,timeout:6e4,error:this.pullError,success:function(e){if(self.videoRegistration.foxtrot=e.registration.video.foxtrot,self.videoRegistration.product=e.registration.product,self.videoRegistration.status=e.registration.user.status,self.videoRegistration.parentTopicName=e.registration.video.parentTopic.name,self.videoRegistration.topicName=e.registration.video.topic.name,self.videoRegistration.is60Extra=e.registration.video.is60Extra,self.videoRegistration.is6048Preview=e.registration.video.is6048Preview,t)if(self.videoRegistration.parentTopicName.indexOf("60 Minutes")!=-1)if("true"==self.videoRegistration.foxtrot){if("true"!=self.videoRegistration.is6048Preview&&"true"!=self.videoRegistration.is60Extra&&1!=self.videoRegistration.is6048Preview&&1!=self.videoRegistration.is60Extra)return void self.show60MinBlock("subscribe");"true"!=self.videoRegistration.status&&1!=self.videoRegistration.status||(this.novemberAlpha=!0),self.initPlayback(t,i)}else if("true"==self.videoRegistration.is6048Preview||1==self.videoRegistration.is6048Preview)self.initPlayback(t,i);else{if("false"==self.videoRegistration.status||0==self.videoRegistration.status)return void self.show60MinBlock("subscribe");this.novemberAlpha=!0,self.initPlayback(t,i)}else self.initPlayback(t,i);else self.options.is60minfranchise=self.videoRegistration.parentTopicName.indexOf("60 Minutes")!=-1,self.options.viewable=self.videoRegistration.foxtrot,self.options.is6048Preview=self.videoRegistration.is6048Preview,self.options.is60Extra=self.videoRegistration.is60Extra,self.options.subscriber=self.videoRegistration.status}})},pullError:function(){},appBtnClick:function(t){e("#errorVideoId #video-error-buttonId").on("click",function(e){e.preventDefault(),"app"==t?navigator.userAgent.match(/iPhone|iPad|iPod/i)?document.location.href="https://itunes.apple.com/us/app/60-minutes-all-access/id997500692?mt=8":navigator.userAgent.match(/android/i)?document.location.href="https://play.google.com/store/apps/details?id=com.cbsnews.sixtyminutes&hl=en":document.location.href="/60-minutes/60-minutes-all-access/":document.location.href="/60-minutes/60-minutes-all-access/",om.trackCampaignDriver({intcid:"CNI39cd285",campaignType:"all-access",campaignChannel:"video player",campaignText:"learn more"})})},loadFirstVideo:function(){this.loadContentUrl()},loadContentUrl:function(){var e=new Object;e.isAd=!1,e.profile="prog",e.startTime=0,e.endTime=-1,e.videoTitle=this.options.hed,e.mediaId=this.options.pid,e.isLive=!1},listenPreviewClicks:function(){var t=this;e.support.touch?"touchstart":"click";e("#previewcontrols").on("touchstart",function(e){
t.videoPlayback()})},videoPlayback:function(e,t){var i=new Object;i.isAd=!1,i.profile="prog",i.startTime=0,i.endTime=-1,i.videoTitle=this.options.hed,i.mediaId=this.options.pid,i.isLive=!1;if(e)this.remove60MinBlock(),this.pullSubscribeReg(e,t);else if(1==this.options.is60minfranchise||"true"==this.options.is60minfranchise)if(1==this.options.viewable||"true"==this.options.viewable)1!=this.options.is6048Preview&&1!=this.options.is60Extra&&"true"!=this.options.is6048Preview&&"true"!=this.options.is60Extra||1!=this.options.subscriber&&"true"!=this.options.subscriber||(this.novemberAlpha=!0);else if(1==this.options.is6048Preview||"true"==this.options.is6048Preview);else{if(0==this.options.subscriber||"false"==this.options.subscriber)return void this.show60MinBlock("subscribe");this.novemberAlpha=!0}if(e);else if(this.cbsiPlayer){var n="cbsnews_mobile";1==this.novemberAlpha?this.cbsiPlayer.loadVideoByUrl(this.options.uri,i):this.options.pid.match(/999999/gi)?this.cbsiPlayer.loadVideoByUrl(this.options.uri,i):this.cbsiPlayer.loadVideoById(this.options.pid,n)}},initPlayback:function(e,t){if(this.options.pid=e,this.cbsiPlayer){var i="cbsnews_mobile";1==this.novemberAlpha?this.cbsiPlayer.loadVideoByUrl(this.options.uri,videoOptions):e.match(/999999/gi)?this.cbsiPlayer.loadVideoByUrl(t,videoOptions):this.cbsiPlayer.loadVideoById(e,i)}},onCBSI_PlayerLoaded:function(e){this.loadContentUrl(),this._trigger("onPlayerLoaded_cbsi")},onCBSI_CaptionsError:function(t){e("#caption").text("Sorry, closed captions are not available for this video.")},addUvpEventCallbacks:function(){this.cbsiPlayer.addEventJSCallback("onPlayerLoaded_cbsi","onCBSI_PlayerLoaded"),this.cbsiPlayer.addEventJSCallback("onContentStart_cbsi","onCBSI_ContentStart"),this.cbsiPlayer.addEventJSCallback("onContentEnd_cbsi","onCBSI_ContentEnd"),this.cbsiPlayer.addEventJSCallback("onAdStart_cbsi","onCBSI_AdStart"),this.cbsiPlayer.addEventJSCallback("onAdEnd_cbsi","onCBSI_AdEnd"),this.cbsiPlayer.addEventJSCallback("onAdResourcesInfo","onCBSI_AdResourcesInfo"),this.cbsiPlayer.addEventJSCallback("onAdSlotStart_cbsi","onCBSI_AdSlotStart"),this.cbsiPlayer.addEventJSCallback("onPlayerDataLoaded_cbsi","onCBSI_PlayerDataLoaded"),this.cbsiPlayer.addEventJSCallback("onPlayListEnd_cbsi","onCBSI_PlayListEnd"),this.cbsiPlayer.addEventJSCallback("onCaptionsError","onCBSI_CaptionsError")},isLiveMobile:function(t){var i=["EZCOmvznjVN_","puG_yGuOdrCu","TiGLGtxzSPKe","D6fmVetXK8_K","4jQtQV2BUWPw","3eplG8pAXhsH","F8VkKnk_tgC8","9nnsnOy8iPUa"];return e.inArray(t,i)!=-1},initialStart:function(){null!=this.options.is60minfranchise&&"null"!=this.options.is60minfranchise||this.pullSubscribeReg();var t=this.isLiveMobile(this.options.pid);t?e("<div/>",{class:"ipadLiveVidClass",id:"ipadLiveVid",text:"Sorry this video is unavailable on this device",css:{color:"#FFFFFF","font-size":"16px","font-weight":"bold",width:"620px",height:"350px"}}).append(this.$element):(this.uvp_sOpts_tmp.previewImg=this.options.thumbnail,this.uvp_sOpts_tmp.videoTitle=this.options.hed,uvp_sOpts=this.uvp_sOpts_tmp,this.loadCbsiJSPlayer())}})});var uvp_sOpts;define("components/video/video-player",["jquery","version!fly/managers/debug","components/video/video-desktop","components/video/video-Hi5","version!fly/libs/jquery.cookie","version!fly/components/base"],function(e,t){"use strict";var i=t.get("video"),n=e(window);e.widget("fly.videoPlayer",e.fly.base,{options:{autoplay:!0,mediaRtmpDesktop:null,mediaRtmpMobileHigh:null,mediaRtmpMobileLow:null,mediaHls:null,mediaHlsTablet:null,mediaHlsPhone:null,url:null,suppress:!1,playerWidth:"100%",playerHeight:"100%",pagePlaylist:!1,si:"162",hed:null,thumbnail:null,pageType:null,element:null,duration:null,ipadBlock:null,mediaHlsURI:null,mediaHlsURITablet:null,mediaHlsURIPhone:null,mediaRtmpDesktopURI:null,mediaRtmpMobileHighURI:null,mediaRtmpMobileLowURI:null,subscriptionPreView:!1,subscriber:!1,is60minfranchise:null,is60Extra:!1,is6048Preview:!1,viewable:!0,mpxRefId:null,uuid:null,topicname:null,device:null,psite:"//www.cbsnews.com",releaseURL:"//www.cbsnews.com/common/video/cbsnews_video.swf"},widget:void 0,scrollListenerRegistered:null,fullPlayerBottom:0,pageYOffset:-1,playerSize:"full",_create:function(t){if("desktop"==this.options.device&&navigator.userAgent.match(/Android|iPad|BlackBerry|RIM/i)&&(this.options.device="tablet"),"desktop"!=this.options.device&&e("body").append('<script type="text/javascript" src="//s0.2mdn.net/instream/html5/ima3.js"></script>'),e("#playerWrap")){var i=e("#playerWrap").width();e("#playerWrap").height(Math.round(9*i/16))}this.determineRoute()},determineRoute:function(){if("desktop"==this.options.device)this.options.mediaRtmpDesktop.match(/999999/gi)?this.widget=e.fly.videoDesktop({autoplay:this.options.autoplay,pid:this.options.mediaRtmpDesktop,url:this.options.url,si:this.options.si,pageType:this.options.pageType,pagePlaylist:this.options.pagePlaylist,playerWidth:this.options.playerWidth,playerHeight:this.options.playerHeight,elementRef:this.options.element,hed:this.options.hed,uuid:this.options.uuid,flv:this.options.mediaRtmpDesktopURI,topicname:this.options.topicname,subscriptionPreView:this.options.subscriptionPreView,thumbnail:this.options.thumbnail,subscriber:this.options.subscriber,viewable:this.options.viewable,is60minfranchise:this.options.is60minfranchise,is60Extra:this.options.is60Extra,is6048Preview:this.options.is6048Preview,UrlmpxRefId:this.options.mpxRefId,lengthSecs:this.options.duration,psite:this.options.psite,releaseURL:this.options.releaseURL,suppress:this.options.suppress}):this.widget=e.fly.videoDesktop({autoplay:this.options.autoplay,pid:this.options.mediaRtmpDesktop,suppress:this.options.suppress,pagePlaylist:this.options.pagePlaylist,url:this.options.url,hed:this.options.hed,uuid:this.options.uuid,si:this.options.si,pageType:this.options.pageType,playerWidth:this.options.playerWidth,playerHeight:this.options.playerHeight,flv:this.options.mediaRtmpDesktopURI,subscriptionPreView:this.options.subscriptionPreView,thumbnail:this.options.thumbnail,subscriber:this.options.subscriber,UrlmpxRefId:this.options.mpxRefId,viewable:this.options.viewable,is60minfranchise:this.options.is60minfranchise,is60Extra:this.options.is60Extra,is6048Preview:this.options.is6048Preview,psite:this.options.psite,elementRef:this.options.element,releaseURL:this.options.releaseURL});else if("tablet"==this.options.device){var t=null!=this.options.mediaHlsTablet?this.options.mediaHlsTablet:this.options.mediaHls,i=null!=this.options.mediaHlsURITablet?this.options.mediaHlsURITablet:this.options.mediaHlsURI,n=navigator.userAgent.match(/iPhone|iPad|iPod/i)?t:this.options.mediaRtmpMobileHigh,r=navigator.userAgent.match(/iPhone|iPad|iPod/i)?i:this.options.mediaRtmpMobileHighURI;this.widget=e.fly.videoHi5({hed:this.options.hed,pid:n,thumbnail:this.options.thumbnail,device:this.options.device,pageType:this.options.pageType,width:this.options.playerWidth,height:this.options.playerHeight,element:this.options.element,subscriber:this.options.subscriber,viewable:this.options.viewable,is60minfranchise:this.options.is60minfranchise,is60Extra:this.options.is60Extra,is6048Preview:this.options.is6048Preview,uuid:this.options.uuid,uri:r})}else if("mobile"==this.options.device){var t=null!=this.options.mediaHlsPhone?this.options.mediaHlsPhone:this.options.mediaHls,i=null!=this.options.mediaHlsURIPhone?this.options.mediaHlsURIPhone:this.options.mediaHlsURI,n=navigator.userAgent.match(/iPhone|iPad|iPod/i)?t:this.options.mediaRtmpMobileLow,r=navigator.userAgent.match(/iPhone|iPad|iPod/i)?i:this.options.mediaRtmpMobileLowURI;this.widget=e.fly.videoHi5({hed:this.options.hed,pid:n,thumbnail:this.options.thumbnail,subscriber:this.options.subscriber,viewable:this.options.viewable,pageType:this.options.pageType,is60minfranchise:this.options.is60minfranchise,is60Extra:this.options.is60Extra,is6048Preview:this.options.is6048Preview,device:this.options.device,width:this.options.playerWidth,height:this.options.playerHeight,element:this.options.element,uuid:this.options.uuid,uri:r})}this.widget.options.onPlayerLoaded_cbsi=e.proxy(this.onVideoPlayerLoaded,this),this.widget.options.onAdStart_cbsi=e.proxy(this.onAdStart,this),this.widget.options.onContentStart_cbsi=e.proxy(this.onContentStart,this)},loadCompanionAd:function(){window.googletag&&googletag.cmd.push(function(){googletag.defineSlot("/8264/vaw-can/cbsnews",[300,60],"marquee_video_top").addService(googletag.companionAds()).addService(googletag.pubads()),googletag.defineSlot("/8264/vaw-can/cbsnews",[728,90],"leader_video_top").addService(googletag.companionAds()).addService(googletag.pubads()),googletag.companionAds().setRefreshUnfilledSlots(!0),googletag.enableServices()})},onVideoPlayerLoaded:function(){i.log("VideoPlayerLoaded")},onAdStart:function(){i.log("adstart: registerScrollListener"),this.registerScrollListener()},onContentStart:function(){i.log("contentstart: registerScrollListener"),"desktop"==this.options.device&&videoContentStart(),this.registerScrollListener()},registerScrollListener:function(){this.scrollListenerRegistered||(i.log("registering scroll listener"),this.scrollListenerRegistered=!0,this.fullPlayerBottom=this.widget.$player.offset().top+this.widget.$player.height(),this.scrollListener())},scrollListener:function(){var e,t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},i=n.scrollTop();this.pageYOffset!=i&&(this.pageYOffset=i,e=this.fullPlayerBottom-i<100?"small":"full",this.playerSize!=e&&(this.playerSize=e,this.resizePlayer(e))),t(this.scrollListener.bind(this))},resizePlayer:function(e){var t;if(t="desktop"===this.options.device?this.widget.$player.parent():this.widget.$player.parents(".media-block"),"small"==e?t.addClass("floating"):t.removeClass("floating"),"desktop"===this.options.device){var i=this.widget.playerElement;i.setResize&&i.setResize(this.widget.$player.width(),this.widget.$player.height())}}})}),define("components/video/generic-playlist",["jquery","components/video/video-player","version!fly/libs/jquery.cookie","version!fly/components/base"],function(e){e.widget("fly.genericPlaylist",e.fly.base,{options:{selector:null,url:null,pageType:null,device:null,playerWidth:"100%",playerHeight:"100%",firstmediaRtmpDesktop:null,firstmediaRtmpMobileHigh:null,firstmediaRtmpMobileLow:null,firstmediaHls:null,firstmediaHlsTablet:null,firstmediaHlsPhone:null,firstmediaRtmpDesktopURI:null,firstmediaRtmpMobileHighURI:null,firstmediaRtmpMobileLowURI:null,firstmediaHlsURI:null,firstmediaHlsURITablet:null,firstmediaHlsURIPhone:null,firstmpxRefId:null,firsttopicname:null,firstDuration:null,firstTitle:null,firstImage:null,firstuuid:null,subscriber:!1,iristvFetchNumber:5,is60minfranchise:null,is60Extra:!1,is6048Preview:!1,viewable:!0,psite:"//www.cbsnews.com",targetElement:null,releaseUrl:null},playlist:null,isTablet:!1,videoPaused:!1,assetClicked:!1,prevEvent:null,playbackStarted:!1,fireWatch:!1,_create:function(t){window.onPlayListEnd_cbsi=e.proxy(this.onPlayListEnd_cbsi,this),window.onContentEnd_cbsi=e.proxy(this.playlistUrlVideoEnd,this),window.cbsnewsPlayerPause=e.proxy(this.playerPause,this),window.cbsnewsPlayerPlay=e.proxy(this.cbsnewsPlayerPlay,this),window.videoContentStart=e.proxy(this.videoContentStart,this);var i=this;navigator.userAgent.match(/Android|iPad|BlackBerry|RIM/i)&&(this.isTablet=!0),this.setupPlaylist(i)},setupPlaylist:function(t){if(this.playlist=new Array,this.options.iristvEnabled)this.iristvLoadFetch(this,"watch");else{if(e(this.options.selector).each(function(i,n){t.pushPlaylist(e(n).data("video-info")),e(n).click(function(i){i.preventDefault(),t.assetClicked=!0,t.onAssetClick(e(this).data("video-info"),e(this).data("pid"),e(this))})}),e(this.options.selector).length>1&&e(this.options.selector).each(function(i,n){e(n).data("pid")==t.playlist[0].item.mediaRtmpDesktop&&(e(n).addClass("selected"),t.updateSelected(e(n)))}),null!=this.options.firstmediaRtmpDesktop){var i={item:{mediaRtmpDesktop:this.options.firstmediaRtmpDesktop,mediaRtmpMobileHigh:this.options.firstmediaRtmpMobileHigh,mediaRtmpMobileLow:this.options.firstmediaRtmpMobileLow,mediaHls:this.options.firstmediaHls,mediaHlsTablet:this.options.firstmediaHlsTablet,mediaHlsPhone:this.options.firstmediaHlsPhone,articleTitle:this.options.firstTitle,thumbnail:this.options.firstImage,duration:this.options.firstDuration,uuid:this.options.firstuuid,mpxRefId:this.options.firstmpxRefId,mediaRtmpDesktopURI:this.options.firstmediaRtmpDesktopURI,mediaRtmpMobileHighURI:this.options.firstmediaRtmpMobileHighURI,mediaRtmpMobileLowURI:this.options.firstmediaRtmpMobileLowURI,topicname:this.options.firsttopicname,mediaHlsURI:this.options.firstmediaHlsURI,mediaHlsURITablet:this.options.firstmediaHlsTabletURI,mediaHlsURIPhone:this.options.firstmediaHlsURIPhone}};this.unshiftPlaylist(i)}this.injectPlayer(t.playlist[0])}},videoContentStart:function(){this.options.iristvEnabled&&this.eventListenerRem("contentPlay")},popPlaylist:function(){return this.playlist.pop()},pushPlaylist:function(e){return this.playlist.push(e)},shiftPlaylist:function(){return this.playlist.shift()},unshiftPlaylist:function(e){return this.playlist.unshift(e)},clearPlaylist:function(){return this.playlist=[]},getNextPlaylistItem:function(){return this.playlist[1]},getFirstPlaylistItem:function(){return this.playlist[0]},getPlaylistIndexItem:function(e){return this.playlist[e]},getPlaylist:function(){return this.playlist},getPlaylistDebug:function(){e.each(this.playlist,function(e){})},playerPause:function(){this.videoPaused=!0,this.eventListenerRem("pause")},cbsnewsPlayerPlay:function(){1==this.videoPaused&&(this.eventListenerRem("resume"),this.videoPaused=!1)},eventListenerRem:function(e){switch(e){case"done":irisEvent="next_auto,video_complete,percentage_watched";break;case"contentPlay":irisEvent="play",this.fireWatch&&(this.makeWatchNextRequest("watch",this.watchQueryParams),this.fireWatch=!1);break;case"play":irisEvent="playStart";break;default:irisEvent=e}return"playStart"==window.cbsPlaylistPrevEvent&&"play"==irisEvent||"load"==irisEvent||"resume"==irisEvent||"playStart"==irisEvent||"nextVideo"==irisEvent?void(window.cbsPlaylistPrevEvent=irisEvent):(window.cbsPlaylistPrevEvent=irisEvent,void this.irisTvUpdate(irisEvent))},getPlaylistlength:function(){return this.playlist.length},onPlayListEnd_cbsi:function(){this.eventListenerRem("done"),0==this.assetClicked&&(2==this.getPlaylistlength()&&this.iristvLoadFetch(this,"next"),this.shiftPlaylist(),this.getPlaylistlength()>=1&&(this.loadVideo(this.getFirstPlaylistItem()),this.loopSelector(this.playlist[0].item.mediaRtmpDesktop))),this.assetClicked=!1,this.eventListenerRem("nextVideo")},loopSelector:function(t){var i=this;e(this.options.selector).each(function(n,r){e(r).data("pid")==t&&i.updateSelected(e(r))})},updateSelected:function(t){e(this.options.selector).each(function(t,i){e(i).removeClass("selected")}),t.addClass("selected")},removeIndex:function(e){return this.playlist.slice(0,e).concat(this.playlist.slice(e+1))},shiftIndex:function(e){return this.playlist.slice(e,this.playlist.length).concat(this.playlist.slice(0,e))},onAssetClick:function(t,i,n){this.eventListenerRem("click"),0==this.getPlaylistlength()?(this.unshiftPlaylist(t),this.updateSelected(n),this.loadVideo(this.getFirstPlaylistItem())):1==this.getPlaylistlength()?(this.unshiftPlaylist(t),this.popPlaylist(),this.loadVideo(this.getFirstPlaylistItem())):(elementIndex=e.inArray(t,this.playlist),elementObj=this.getPlaylistIndexItem(elementIndex),this.playlist=this.shiftIndex(elementIndex),this.updateSelected(n),this.loadVideo(this.getFirstPlaylistItem()))},injectPlayer:function(t){this.eventListenerRem("load"),e.fly.videoPlayer({mediaRtmpDesktop:t.item.mediaRtmpDesktop,mediaRtmpMobileHigh:t.item.mediaRtmpMobileHigh,mediaRtmpMobileLow:t.item.mediaRtmpMobileLow,mediaHls:t.item.mediaHls,mediaHlsTablet:t.item.mediaHlsTablet,mediaHlsPhone:t.item.mediaHlsPhone,url:this.options.url,playerWidth:this.options.playerWidth,playerHeight:this.options.playerHeight,si:"162",hed:t.item.articleTitle,duration:t.item.duration,thumbnail:t.item.mediaImage,pageType:this.options.pageType,pagePlaylist:!0,uuid:t.item.uuid,mpxRefId:t.item.mpxRefId,element:this.options.targetElement,topicname:t.item.topicname,mediaHlsURI:t.item.mediaHlsURI,mediaHlsURITablet:t.item.mediaHlsURITablet,mediaHlsURIPhone:t.item.mediaHlsURIPhone,mediaRtmpDesktopURI:t.item.mediaRtmpDesktopURI,mediaRtmpMobileHighURI:t.item.mediaRtmpMobileHighURI,mediaRtmpMobileLowURI:t.item.mediaRtmpMobileLowURI,subscriber:this.options.subscriber,viewable:this.options.viewable,is60minfranchise:this.options.is60minfranchise,is6048Preview:this.options.is6048Preview,is60Extra:this.options.is60Extra,device:this.options.device,psite:this.options.psite,releaseURL:this.options.releaseUrl}),this.playbackStarted=!0,this.eventListenerRem("play")},getPlayer:function(e){return navigator.appName.indexOf("Microsoft")!=-1?window[e]:document[e]},playlistUrlVideoEnd:function(){this.playlist[0].item.mediaRtmpDesktop.match(/999999/gi)&&this.onPlayListEnd_cbsi(),"authenticated"===utag_data.userState&&"1"==utag_data.contentLocked&&this.onPlayListEnd_cbsi()},loadVideo:function(e){if("desktop"==this.options.device){var t;e.item.mediaRtmpDesktop.match(/999999/gi)?(t={hed:e.item.articleTitle,lengthSecs:e.item.duration,flv:e.item.mediaRtmpDesktopURI,url:this.options.url,uuid:e.item.uuid,cid:e.item.mediaRtmpDesktop,topicname:e.item.topicname,UrlmpxRefId:e.item.mpxRefId},0==this.isTablet?this.getPlayer(this.options.targetElement).externalPlayClipUrl(t):(setVideoUUID(e.item.uuid),navigator.userAgent.match(/iPhone|iPad|iPod/i)?null!=e.item.mediaHlsURITablet?videoPlayback(e.item.mediaHlsTablet,e.item.mediaHlsURITablet):videoPlayback(e.item.mediaHls,e.item.mediaHlsURI):videoPlayback(e.item.mediaRtmpMobileHigh,e.item.mediaRtmpMobileHighURI))):(t={pid:e.item.mediaRtmpDesktop,uuid:e.item.uuid,url:this.options.url},0==this.isTablet?this.getPlayer(this.options.targetElement).externalPlayClipPid(t):(setVideoUUID(e.item.uuid),navigator.userAgent.match(/iPhone|iPad|iPod/i)?null!=e.item.mediaHlsURITablet?videoPlayback(e.item.mediaHlsTablet,e.item.mediaHlsURITablet):videoPlayback(e.item.mediaHls,e.item.mediaHlsURI):videoPlayback(e.item.mediaRtmpMobileHigh,e.item.mediaRtmpMobileHighURI)))}else this.injectPlayer(e)},iristvLoadFetch:function(t,i){console.log("fetch");var n=this.options.mpxRefId;"next"==i&&this.playlist[0]&&(n=this.playlist[0].item.mpxRefId);var r={platform_id:n,number:this.options.iristvFetchNumber,user_id:CBSNEWS.user.ursClientToken};if("next"==i&&(console.log("doing next"),r.experience=this.irisWatch.experience,this.makeWatchNextRequest(i,r)),"watch"==i&&(this.watchQueryParams=r,this.fireWatch=!0),null==this.options.firstmediaRtmpDesktop||this.playbackStarted){if(!this.playbackStarted){var o=e(this.options.selector)[0];this.unshiftPlaylist(e(o).data("video-info"));var t=this;e(o).click(function(i){i.preventDefault(),t.assetClicked=!0,t.onAssetClick(e(this).data("video-info"),e(this).data("pid"),e(this))})}}else{var a={item:{mediaRtmpDesktop:this.options.firstmediaRtmpDesktop,mediaRtmpMobileHigh:this.options.firstmediaRtmpMobileHigh,mediaRtmpMobileLow:this.options.firstmediaRtmpMobileLow,mediaHls:this.options.firstmediaHls,mediaHlsTablet:this.options.firstmediaHlsTablet,mediaHlsPhone:this.options.firstmediaHlsPhone,articleTitle:this.options.firstTitle,thumbnail:this.options.firstImage,uuid:this.options.firstuuid,duration:this.options.firstDuration,mpxRefId:this.options.firstmpxRefId,mediaRtmpDesktopURI:this.options.firstmediaRtmpDesktopURI,mediaRtmpMobileHighURI:this.options.firstmediaRtmpMobileHighURI,mediaRtmpMobileLowURI:this.options.firstmediaRtmpMobileLowURI,topicname:this.options.firsttopicname,mediaHlsURI:this.options.firstmediaHlsURI,mediaHlsURITablet:this.options.firstmediaHlsTabletURI,mediaHlsURIPhone:this.options.firstmediaHlsURIPhone}};this.unshiftPlaylist(a)}this.getPlayer(this.options.targetElement)||this.injectPlayer(this.playlist[0])},makeWatchNextRequest:function(t,i){e.get("/video-iristv/"+t+"/",i).done(e.proxy(this.iristvWatchNext,this)).fail(function(e){console.log("playlist error"),console.log(e)})},iristvWatchNext:function(e){this.irisWatch=e;var t,i;for(var n in e.next){t=e.next[n];var r={};for(j=0;j<t["media:content"].length;j++)r[t["media:content"][j].medium]=t["media:content"][j];var i={item:{mediaRtmpDesktop:r.mediaRtmpDesktop.content_id,mediaRtmpMobileHigh:r.mediaRtmpMobileHigh.content_id,mediaRtmpMobileLow:r.mediaRtmpMobileLow.content_id,mediaHls:r.mediaHls.content_id,mediaHlsTablet:r.mediaHlsTablet.content_id,mediaHlsPhone:r.mediaHlsPhone.content_id,articleTitle:t.title,uuid:t.uuid,thumbnail:t.image_url,duration:t.duration,mpxRefId:t.platform_id,mediaRtmpDesktopURI:r.mediaRtmpDesktop.url,mediaRtmpMobileHighURI:r.mediaRtmpMobileHigh.url,mediaRtmpMobileLowURI:r.mediaRtmpMobileLow.url,topicname:t.topicname[0],mediaHlsURI:r.mediaHls.url,mediaHlsURITablet:r.mediaHlsTablet.url,mediaHlsURIPhone:r.mediaHlsPhone.url}};this.pushPlaylist(i)}},irisTvUpdate:function(t){if(!this.options.iristvEnabled)return!1;var i={platform_id:this.playlist[0].item.mpxRefId,experience:this.irisWatch.experience,user_id:CBSNEWS.user.ursClientToken,behavior:t};i=e.param(i),e.get("/video-iristv/update/",i).done(function(e){console.log(e)})}})}),define("managers/taboola-rem",["jquery","version!fly/managers/debug"],function(e,t){"use strict";var i,n=t.init("taboolaRem"),r={category_door:"category",deep_story:"-1",error_page:"-2",front_door:"home",image_gallery:"photo",image_gallery_list:"other",live_video:"-1",media_post:"other",news_item:"article",search:"-2",topic_list:"other",video:"video",video_door:"category"},o=r[utag_data.pageType]||"other",a=window._taboola=window._taboola||[],s=!1,l={init:function(t){var i={};i[o]="auto",i.referrer=document.referrer,i.url=window.location.href,t=e.extend(i,t),n.log("init",t),a.push(t),l.load()},load:function(){return s?void n.log("Taboola already loaded"):(n.log("Loading Taboola"),void require(["taboola"],function(){n.log("Taboola loaded"),s=!0}))},display:function(){return i=e("[data-taboola]"),i.length?(l.init(),i.each(function(){var t=e(this).data("taboola");t=e.extend({container:this,target_type:"mix"},t),n.log("display",t),a.push(t)}),void a.push({flush:!0})):void n.log("No Taboola REM containers found")},refresh:function(){n.log("refresh"),a.push({notify:"newPageLoad"}),l.display()},taboola:null};return e(function(){n.log("DOM is ready"),l.display()}),l}),require(["common"]),require(["jquery"],function(e){e(function(){navigator.userAgent.match(/Android|iPad|BlackBerry|RIM/i)&&e(document).addClass("tablet"),e("#article-entry a:not([data-open])").attr("target","_blank"),e(".module-homepage")&&(navigator.userAgent.toLowerCase().indexOf("opr")>-1||navigator.userAgent.match(/iPad/i)&&document.location.href.indexOf("&qwr=1335191960")==-1)&&e(".module-homepage").css("display","none"),e(".popup-link").on("click",function(t){function i(){loginWindow.closed?location.reload():window.setTimeout(i,1e3)}t.preventDefault();var n=e(this).attr("data-pop-path")||e(this).attr("href");w=960,h=551,left=screen.width/2-w/2,top=screen.height/2-h/2,loginWindow=window.open(n,"securePopup","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, copyhistory=no, width="+w+", height="+h+", top="+top+", left="+left);var r=navigator.userAgent.indexOf("Edge")!=-1||navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.indexOf("Trident")!=-1;if(r)window.setTimeout(i,1e3);else{var o=window.addEventListener?"addEventListener":"attachEvent",a=window[o],s="attachEvent"==o?"onmessage":"message";a(s,function(e){e.origin.indexOf("cbsnews")<-1||"loginWindow"!==e.data||location.reload()},!1)}return loginWindow});var t=window.addEventListener?"addEventListener":"attachEvent",i=window[t],n="attachEvent"==t?"onmessage":"message";i(n,function(e){e.origin.indexOf("cbsnews")<-1||"loginWindow"!==e.data||location.reload()},!1),e(".leaderboard-ads").length&&e(window).scroll(function(){e(".leaderboard-ads").toggleClass("sponsored-ad-fixed",e(window).scrollTop()>128)}),e('[data-component="imageGallery"], [data-component="mediaPost"]').on("imagegallerycreate imagegalleryshown imagegallerynext imagegalleryprevious mediapostcreate mediapostnext mediapostprevious",function(){var t=e(this).find(".selected");t.add(t.prev()).add(t.next()).find(".lazyload").addClass("lazypreload")});var r=e("#relatedVideoContainer");(navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/android/i))&&(r.removeAttr("data-open"),r.removeAttr("data-modal-options"),r.removeAttr("data-modal-async-url"),r.attr("target","_blank"))})}),require(["jquery","managers/components.desktop"],function(e,t){e(function(){t.process()})}),require(["version!fly/components/scrollbar"]),require(["components/video/generic-playlist"]),require(["components/video/video-player"]),require(["managers/taboola-rem"]),define("main.desktop",function(){});vTT9-       XX=gX)   {    :http://cbsnews4.cbsistatic.com/fly/bundles/cbsnewscore/js-build/main.desktop.js?v=08da97d7aa7c448991491738296c44268f54e7ca request-method GET response-head HTTP/1.1 200 OK
Content-Type: application/javascript
Content-Length: 447159
Last-Modified: Mon, 30 Jan 2017 20:23:11 GMT
Etag: "588fa0af-6d2b7"
Link: <http://cbsnews1.cbsistatic.com/fly/bundles/cbsnewscore/js-build/main.desktop.js?v=08da97d7aa7c448991491738296c44268f54e7ca>; rel="canonical"
Accept-Ranges: bytes
Date: Sun, 05 Feb 2017 08:41:17 GMT
 uncompressed-len 0  